;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="ff971da1-d4c5-ec9b-4b09-5dcf49f42ac9")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,7954409,(e,t,r)=>{"use strict";var a=Object.defineProperty,o=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,n=Object.prototype.hasOwnProperty,i={},l={SYMBOL_FOR_REQ_CONTEXT:()=>u,getContext:()=>d};for(var c in l)a(i,c,{get:l[c],enumerable:!0});t.exports=((e,t,r,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let l of s(t))n.call(e,l)||l===r||a(e,l,{get:()=>t[l],enumerable:!(i=o(t,l))||i.enumerable});return e})(a({},"__esModule",{value:!0}),i);let u=Symbol.for("@vercel/request-context");function d(){let e=globalThis;return e[u]?.get?.()??{}}},6439780,(e,t,r)=>{"use strict";var a=Object.defineProperty,o=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,n=Object.prototype.hasOwnProperty,i={},l={getContext:()=>u.getContext,getVercelOidcToken:()=>d,getVercelOidcTokenSync:()=>p};for(var c in l)a(i,c,{get:l[c],enumerable:!0});t.exports=((e,t,r,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let l of s(t))n.call(e,l)||l===r||a(e,l,{get:()=>t[l],enumerable:!(i=o(t,l))||i.enumerable});return e})(a({},"__esModule",{value:!0}),i);var u=e.r(7954409);async function d(){return""}function p(){return""}},3820729,6191041,e=>{"use strict";var t,r,a,o,s,n,i,l,c,u,d,p,h,m,g,y,f,v,b,w,I,E,_,T,S,A,x,k,M,R,j,O,C,P,N,F,D,z,L,U,$,Z,B,V,q,K,H,Y,J,G,W,X,Q,ee=e.i(1053524),et=e.i(3267987),er=e.i(9040675),ea="vercel.ai.error",eo=Symbol.for(ea),es=class e extends(r=Error,t=eo,r){constructor({name:e,message:r,cause:a}){super(r),this[t]=!0,this.name=e,this.cause=a}static isInstance(t){return e.hasMarker(t,ea)}static hasMarker(e,t){let r=Symbol.for(t);return null!=e&&"object"==typeof e&&r in e&&"boolean"==typeof e[r]&&!0===e[r]}},en="AI_APICallError",ei=`vercel.ai.error.${en}`,el=Symbol.for(ei),ec=class extends(o=es,a=el,o){constructor({message:e,url:t,requestBodyValues:r,statusCode:o,responseHeaders:s,responseBody:n,cause:i,isRetryable:l=null!=o&&(408===o||409===o||429===o||o>=500),data:c}){super({name:en,message:e,cause:i}),this[a]=!0,this.url=t,this.requestBodyValues=r,this.statusCode=o,this.responseHeaders=s,this.responseBody=n,this.isRetryable=l,this.data=c}static isInstance(e){return es.hasMarker(e,ei)}},eu="AI_EmptyResponseBodyError",ed=`vercel.ai.error.${eu}`,ep=Symbol.for(ed),eh=class extends(n=es,s=ep,n){constructor({message:e="Empty response body"}={}){super({name:eu,message:e}),this[s]=!0}static isInstance(e){return es.hasMarker(e,ed)}};function em(e){return null==e?"unknown error":"string"==typeof e?e:e instanceof Error?e.message:JSON.stringify(e)}var eg="AI_InvalidArgumentError",ey=`vercel.ai.error.${eg}`,ef=Symbol.for(ey),ev=class extends(l=es,i=ef,l){constructor({message:e,cause:t,argument:r}){super({name:eg,message:e,cause:t}),this[i]=!0,this.argument=r}static isInstance(e){return es.hasMarker(e,ey)}},eb=Symbol.for("vercel.ai.error.AI_InvalidPromptError");Symbol.for("vercel.ai.error.AI_InvalidResponseDataError");var ew="AI_JSONParseError",eI=`vercel.ai.error.${ew}`,eE=Symbol.for(eI),e_=class extends(u=es,c=eE,u){constructor({text:e,cause:t}){super({name:ew,message:`JSON parsing failed: Text: ${e}.
Error message: ${em(t)}`,cause:t}),this[c]=!0,this.text=e}static isInstance(e){return es.hasMarker(e,eI)}},eT=Symbol.for("vercel.ai.error.AI_LoadAPIKeyError");Symbol.for("vercel.ai.error.AI_LoadSettingError");Symbol.for("vercel.ai.error.AI_NoContentGeneratedError");Symbol.for("vercel.ai.error.AI_NoSuchModelError");Symbol.for("vercel.ai.error.AI_TooManyEmbeddingValuesForCallError");var eS="AI_TypeValidationError",eA=`vercel.ai.error.${eS}`,ex=Symbol.for(eA),ek=class e extends(p=es,d=ex,p){constructor({value:e,cause:t}){super({name:eS,message:`Type validation failed: Value: ${JSON.stringify(e)}.
Error message: ${em(t)}`,cause:t}),this[d]=!0,this.value=e}static isInstance(e){return es.hasMarker(e,eA)}static wrap(t){let{value:r,cause:a}=t;return e.isInstance(a)&&a.value===r?a:new e({value:r,cause:a})}},eM=Symbol.for("vercel.ai.error.AI_UnsupportedFunctionalityError");e.i(9439603);var eR=e.i(7636829),ej=e.i(5207889);e.i(3512434);var eO=e.i(1961272),eC=e.i(4710717);function eP(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.reduce((e,t)=>({...e,...null!=t?t:{}}),{})}function eN(e){return Object.fromEntries([...e.headers])}var{btoa:eF,atob:eD}=globalThis,ez=Symbol.for("vercel.ai.error.AI_DownloadError"),eL=function(){let{prefix:e,size:t=16,alphabet:r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:a="-"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=()=>{let e=r.length,a=Array(t);for(let o=0;o<t;o++)a[o]=r[Math.random()*e|0];return a.join("")};if(null==e)return o;if(r.includes(a))throw new ev({argument:"separator",message:`The separator "${a}" must not be part of the alphabet "${r}".`});return()=>`${e}${a}${o()}`},eU=eL();function e$(e){return(e instanceof Error||e instanceof DOMException)&&("AbortError"===e.name||"ResponseAborted"===e.name||"TimeoutError"===e.name)}var eZ=["fetch failed","failed to fetch"];function eB(e){let{error:t,url:r,requestBodyValues:a}=e;if(e$(t))return t;if(t instanceof TypeError&&eZ.includes(t.message.toLowerCase())){let e=t.cause;if(null!=e)return new ec({message:`Cannot connect to API: ${e.message}`,cause:e,url:r,requestBodyValues:a,isRetryable:!0})}return t}function eV(){var e,t,r;let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:globalThis;return a.window?"runtime/browser":(null==(e=a.navigator)?void 0:e.userAgent)?`runtime/${a.navigator.userAgent.toLowerCase()}`:(null==(r=null==(t=a.process)?void 0:t.versions)?void 0:r.node)?`runtime/node.js/${a.process.version.substring(0)}`:a.EdgeRuntime?"runtime/vercel-edge":"runtime/unknown"}function eq(e){if(null==e)return{};let t={};if(e instanceof Headers)e.forEach((e,r)=>{t[r.toLowerCase()]=e});else for(let[r,a]of(Array.isArray(e)||(e=Object.entries(e)),e))null!=a&&(t[r.toLowerCase()]=a);return t}function eK(e){for(var t=arguments.length,r=Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];let o=new Headers(eq(e)),s=o.get("user-agent")||"";return o.set("user-agent",[s,...r].filter(Boolean).join(" ")),Object.fromEntries(o.entries())}var eH="4.0.8",eY=async e=>{let{url:t,headers:r={},successfulResponseHandler:a,failedResponseHandler:o,abortSignal:s,fetch:n=globalThis.fetch}=e;try{let e=await n(t,{method:"GET",headers:eK(r,`ai-sdk/provider-utils/${eH}`,eV()),signal:s}),i=eN(e);if(!e.ok){let r;try{r=await o({response:e,url:t,requestBodyValues:{}})}catch(r){if(e$(r)||ec.isInstance(r))throw r;throw new ec({message:"Failed to process error response",cause:r,statusCode:e.status,url:t,responseHeaders:i,requestBodyValues:{}})}throw r.value}try{return await a({response:e,url:t,requestBodyValues:{}})}catch(r){if(r instanceof Error&&(e$(r)||ec.isInstance(r)))throw r;throw new ec({message:"Failed to process successful response",cause:r,statusCode:e.status,url:t,responseHeaders:i,requestBodyValues:{}})}}catch(e){throw eB({error:e,url:t,requestBodyValues:{}})}};function eJ(e){let{settingValue:t,environmentVariableName:r}=e;return"string"==typeof t?t:null!=t||void 0===et.default?void 0:null!=(t=et.default.env[r])&&"string"==typeof t?t:void 0}var eG=/"__proto__"\s*:/,eW=/"constructor"\s*:/;function eX(e){let t=JSON.parse(e);return null===t||"object"!=typeof t||!1===eG.test(e)&&!1===eW.test(e)?t:function(e){let t=[e];for(;t.length;){let e=t;for(let r of(t=[],e)){if(Object.prototype.hasOwnProperty.call(r,"__proto__")||Object.prototype.hasOwnProperty.call(r,"constructor")&&Object.prototype.hasOwnProperty.call(r.constructor,"prototype"))throw SyntaxError("Object contains forbidden prototype property");for(let e in r){let a=r[e];a&&"object"==typeof a&&t.push(a)}}}return e}(t)}function eQ(e){let{stackTraceLimit:t}=Error;try{Error.stackTraceLimit=0}catch(t){return eX(e)}try{return eX(e)}finally{Error.stackTraceLimit=t}}function e0(e){if("object"===e.type||Array.isArray(e.type)&&e.type.includes("object")){e.additionalProperties=!1;let{properties:t}=e;if(null!=t)for(let e of Object.keys(t))t[e]=e1(t[e])}null!=e.items&&(e.items=Array.isArray(e.items)?e.items.map(e1):e1(e.items)),null!=e.anyOf&&(e.anyOf=e.anyOf.map(e1)),null!=e.allOf&&(e.allOf=e.allOf.map(e1)),null!=e.oneOf&&(e.oneOf=e.oneOf.map(e1));let{definitions:t}=e;if(null!=t)for(let e of Object.keys(t))t[e]=e1(t[e]);return e}function e1(e){return"boolean"==typeof e?e:e0(e)}var e2=Symbol("Let zodToJsonSchema decide on which parser to use"),e4={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",strictUnions:!1,definitions:{},errorMessages:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"};function e9(e,t){return tg(e.type._def,t)}var e5=void 0,e3=/^[cC][^\s-]{8,}$/,e6=/^[0-9a-z]+$/,e8=/^[0-9A-HJKMNP-TV-Z]{26}$/,e7=/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,te=()=>(void 0===e5&&(e5=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),e5),tt=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,tr=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,ta=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,to=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,ts=/^[a-zA-Z0-9_-]{21}$/,tn=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/;function ti(e,t){let r={type:"string"};if(e.checks)for(let a of e.checks)switch(a.kind){case"min":r.minLength="number"==typeof r.minLength?Math.max(r.minLength,a.value):a.value;break;case"max":r.maxLength="number"==typeof r.maxLength?Math.min(r.maxLength,a.value):a.value;break;case"email":switch(t.emailStrategy){case"format:email":tu(r,"email",a.message,t);break;case"format:idn-email":tu(r,"idn-email",a.message,t);break;case"pattern:zod":td(r,e7,a.message,t)}break;case"url":tu(r,"uri",a.message,t);break;case"uuid":tu(r,"uuid",a.message,t);break;case"regex":td(r,a.regex,a.message,t);break;case"cuid":td(r,e3,a.message,t);break;case"cuid2":td(r,e6,a.message,t);break;case"startsWith":td(r,RegExp(`^${tl(a.value,t)}`),a.message,t);break;case"endsWith":td(r,RegExp(`${tl(a.value,t)}$`),a.message,t);break;case"datetime":tu(r,"date-time",a.message,t);break;case"date":tu(r,"date",a.message,t);break;case"time":tu(r,"time",a.message,t);break;case"duration":tu(r,"duration",a.message,t);break;case"length":r.minLength="number"==typeof r.minLength?Math.max(r.minLength,a.value):a.value,r.maxLength="number"==typeof r.maxLength?Math.min(r.maxLength,a.value):a.value;break;case"includes":td(r,RegExp(tl(a.value,t)),a.message,t);break;case"ip":"v6"!==a.version&&tu(r,"ipv4",a.message,t),"v4"!==a.version&&tu(r,"ipv6",a.message,t);break;case"base64url":td(r,to,a.message,t);break;case"jwt":td(r,tn,a.message,t);break;case"cidr":"v6"!==a.version&&td(r,tt,a.message,t),"v4"!==a.version&&td(r,tr,a.message,t);break;case"emoji":td(r,te(),a.message,t);break;case"ulid":td(r,e8,a.message,t);break;case"base64":switch(t.base64Strategy){case"format:binary":tu(r,"binary",a.message,t);break;case"contentEncoding:base64":r.contentEncoding="base64";break;case"pattern:zod":td(r,ta,a.message,t)}break;case"nanoid":td(r,ts,a.message,t)}return r}function tl(e,t){return"escape"===t.patternStrategy?function(e){let t="";for(let r=0;r<e.length;r++)tc.has(e[r])||(t+="\\"),t+=e[r];return t}(e):e}var tc=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function tu(e,t,r,a){var o;e.format||(null==(o=e.anyOf)?void 0:o.some(e=>e.format))?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format}),delete e.format),e.anyOf.push({format:t,...r&&a.errorMessages&&{errorMessage:{format:r}}})):e.format=t}function td(e,t,r,a){var o;e.pattern||(null==(o=e.allOf)?void 0:o.some(e=>e.pattern))?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern}),delete e.pattern),e.allOf.push({pattern:tp(t,a),...r&&a.errorMessages&&{errorMessage:{pattern:r}}})):e.pattern=tp(t,a)}function tp(e,t){var r;if(!t.applyRegexFlags||!e.flags)return e.source;let a={i:e.flags.includes("i"),m:e.flags.includes("m"),s:e.flags.includes("s")},o=a.i?e.source.toLowerCase():e.source,s="",n=!1,i=!1,l=!1;for(let e=0;e<o.length;e++){if(n){s+=o[e],n=!1;continue}if(a.i){if(i){if(o[e].match(/[a-z]/)){l?(s+=o[e],s+=`${o[e-2]}-${o[e]}`.toUpperCase(),l=!1):"-"===o[e+1]&&(null==(r=o[e+2])?void 0:r.match(/[a-z]/))?(s+=o[e],l=!0):s+=`${o[e]}${o[e].toUpperCase()}`;continue}}else if(o[e].match(/[a-z]/)){s+=`[${o[e]}${o[e].toUpperCase()}]`;continue}}if(a.m){if("^"===o[e]){s+=`(^|(?<=[\r
]))`;continue}else if("$"===o[e]){s+=`($|(?=[\r
]))`;continue}}if(a.s&&"."===o[e]){s+=i?`${o[e]}\r
`:`[${o[e]}\r
]`;continue}s+=o[e],"\\"===o[e]?n=!0:i&&"]"===o[e]?i=!1:i||"["!==o[e]||(i=!0)}try{new RegExp(s)}catch(r){return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),e.source}return s}function th(e,t){var r,a,o,s,n,i;let l={type:"object",additionalProperties:null!=(r=tg(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]}))?r:t.allowedAdditionalProperties};if((null==(a=e.keyType)?void 0:a._def.typeName)===eO.ZodFirstPartyTypeKind.ZodString&&(null==(o=e.keyType._def.checks)?void 0:o.length)){let{type:r,...a}=ti(e.keyType._def,t);return{...l,propertyNames:a}}if((null==(s=e.keyType)?void 0:s._def.typeName)===eO.ZodFirstPartyTypeKind.ZodEnum)return{...l,propertyNames:{enum:e.keyType._def.values}};if((null==(n=e.keyType)?void 0:n._def.typeName)===eO.ZodFirstPartyTypeKind.ZodBranded&&e.keyType._def.type._def.typeName===eO.ZodFirstPartyTypeKind.ZodString&&(null==(i=e.keyType._def.type._def.checks)?void 0:i.length)){let{type:r,...a}=e9(e.keyType._def,t);return{...l,propertyNames:a}}return l}var tm={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function tg(e,t){var r;let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=t.seen.get(e);if(t.override){let s=null==(r=t.override)?void 0:r.call(t,e,t,o,a);if(s!==e2)return s}if(o&&!a){let e=ty(o,t);if(void 0!==e)return e}let s={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,s);let n=((e,t,r)=>{var a,o,s,n,i,l;switch(t){case eO.ZodFirstPartyTypeKind.ZodString:return ti(e,r);case eO.ZodFirstPartyTypeKind.ZodNumber:let c={type:"number"};if(!e.checks)return c;for(let t of e.checks)switch(t.kind){case"int":c.type="integer";break;case"min":t.inclusive?c.minimum=t.value:c.exclusiveMinimum=t.value;break;case"max":t.inclusive?c.maximum=t.value:c.exclusiveMaximum=t.value;break;case"multipleOf":c.multipleOf=t.value}return c;case eO.ZodFirstPartyTypeKind.ZodObject:return function(e,t){let r={type:"object",properties:{}},a=[],o=e.shape();for(let e in o){let s=o[e];if(void 0===s||void 0===s._def)continue;let n=function(e){try{return e.isOptional()}catch(e){return!0}}(s),i=tg(s._def,{...t,currentPath:[...t.currentPath,"properties",e],propertyPath:[...t.currentPath,"properties",e]});void 0!==i&&(r.properties[e]=i,n||a.push(e))}a.length&&(r.required=a);let s=function(e,t){if("ZodNever"!==e.catchall._def.typeName)return tg(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]});switch(e.unknownKeys){case"passthrough":return t.allowedAdditionalProperties;case"strict":return t.rejectedAdditionalProperties;case"strip":return"strict"===t.removeAdditionalStrategy?t.allowedAdditionalProperties:t.rejectedAdditionalProperties}}(e,t);return void 0!==s&&(r.additionalProperties=s),r}(e,r);case eO.ZodFirstPartyTypeKind.ZodBigInt:let u={type:"integer",format:"int64"};if(!e.checks)return u;for(let t of e.checks)switch(t.kind){case"min":t.inclusive?u.minimum=t.value:u.exclusiveMinimum=t.value;break;case"max":t.inclusive?u.maximum=t.value:u.exclusiveMaximum=t.value;break;case"multipleOf":u.multipleOf=t.value}return u;case eO.ZodFirstPartyTypeKind.ZodBoolean:return{type:"boolean"};case eO.ZodFirstPartyTypeKind.ZodDate:return function e(t,r,a){let o=null!=a?a:r.dateStrategy;if(Array.isArray(o))return{anyOf:o.map((a,o)=>e(t,r,a))};switch(o){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":var s=t;let n={type:"integer",format:"unix-time"};for(let e of s.checks)switch(e.kind){case"min":n.minimum=e.value;break;case"max":n.maximum=e.value}return n}}(e,r);case eO.ZodFirstPartyTypeKind.ZodUndefined:return{not:{}};case eO.ZodFirstPartyTypeKind.ZodNull:return{type:"null"};case eO.ZodFirstPartyTypeKind.ZodArray:let d;return d={type:"array"},(null==(s=e.type)?void 0:s._def)&&(null==(i=null==(n=e.type)?void 0:n._def)?void 0:i.typeName)!==eO.ZodFirstPartyTypeKind.ZodAny&&(d.items=tg(e.type._def,{...r,currentPath:[...r.currentPath,"items"]})),e.minLength&&(d.minItems=e.minLength.value),e.maxLength&&(d.maxItems=e.maxLength.value),e.exactLength&&(d.minItems=e.exactLength.value,d.maxItems=e.exactLength.value),d;case eO.ZodFirstPartyTypeKind.ZodUnion:case eO.ZodFirstPartyTypeKind.ZodDiscriminatedUnion:let p,h=e.options instanceof Map?Array.from(e.options.values()):e.options;if(h.every(e=>e._def.typeName in tm&&(!e._def.checks||!e._def.checks.length))){let e=h.reduce((e,t)=>{let r=tm[t._def.typeName];return r&&!e.includes(r)?[...e,r]:e},[]);return{type:e.length>1?e:e[0]}}if(h.every(e=>"ZodLiteral"===e._def.typeName&&!e.description)){let e=h.reduce((e,t)=>{let r=typeof t._def.value;switch(r){case"string":case"number":case"boolean":return[...e,r];case"bigint":return[...e,"integer"];case"object":if(null===t._def.value)return[...e,"null"];default:return e}},[]);if(e.length===h.length){let t=e.filter((e,t,r)=>r.indexOf(e)===t);return{type:t.length>1?t:t[0],enum:h.reduce((e,t)=>e.includes(t._def.value)?e:[...e,t._def.value],[])}}}else if(h.every(e=>"ZodEnum"===e._def.typeName))return{type:"string",enum:h.reduce((e,t)=>[...e,...t._def.values.filter(t=>!e.includes(t))],[])};return a=e,o=r,(p=(a.options instanceof Map?Array.from(a.options.values()):a.options).map((e,t)=>tg(e._def,{...o,currentPath:[...o.currentPath,"anyOf",`${t}`]})).filter(e=>!!e&&(!o.strictUnions||"object"==typeof e&&Object.keys(e).length>0))).length?{anyOf:p}:void 0;case eO.ZodFirstPartyTypeKind.ZodIntersection:let m,g;return m=[tg(e.left._def,{...r,currentPath:[...r.currentPath,"allOf","0"]}),tg(e.right._def,{...r,currentPath:[...r.currentPath,"allOf","1"]})].filter(e=>!!e),g=[],m.forEach(e=>{if((!("type"in e)||"string"!==e.type)&&"allOf"in e)g.push(...e.allOf);else{let t=e;if("additionalProperties"in e&&!1===e.additionalProperties){let{additionalProperties:r,...a}=e;t=a}g.push(t)}}),g.length?{allOf:g}:void 0;case eO.ZodFirstPartyTypeKind.ZodTuple:return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((e,t)=>tg(e._def,{...r,currentPath:[...r.currentPath,"items",`${t}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[]),additionalItems:tg(e.rest._def,{...r,currentPath:[...r.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((e,t)=>tg(e._def,{...r,currentPath:[...r.currentPath,"items",`${t}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[])};case eO.ZodFirstPartyTypeKind.ZodRecord:return th(e,r);case eO.ZodFirstPartyTypeKind.ZodLiteral:let y;return"bigint"!=(y=typeof e.value)&&"number"!==y&&"boolean"!==y&&"string"!==y?{type:Array.isArray(e.value)?"array":"object"}:{type:"bigint"===y?"integer":y,const:e.value};case eO.ZodFirstPartyTypeKind.ZodEnum:return{type:"string",enum:Array.from(e.values)};case eO.ZodFirstPartyTypeKind.ZodNativeEnum:let f,v,b;return f=e.values,{type:1===(b=Array.from(new Set((v=Object.keys(e.values).filter(e=>"number"!=typeof f[f[e]]).map(e=>f[e])).map(e=>typeof e)))).length?"string"===b[0]?"string":"number":["string","number"],enum:v};case eO.ZodFirstPartyTypeKind.ZodNullable:if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return{type:[tm[e.innerType._def.typeName],"null"]};let w=tg(e.innerType._def,{...r,currentPath:[...r.currentPath,"anyOf","0"]});return w&&{anyOf:[w,{type:"null"}]};case eO.ZodFirstPartyTypeKind.ZodOptional:if(r.currentPath.toString()===(null==(l=r.propertyPath)?void 0:l.toString()))return tg(e.innerType._def,r);let I=tg(e.innerType._def,{...r,currentPath:[...r.currentPath,"anyOf","1"]});return I?{anyOf:[{not:{}},I]}:{};case eO.ZodFirstPartyTypeKind.ZodMap:if("record"===r.mapStrategy)return th(e,r);return{type:"array",maxItems:125,items:{type:"array",items:[tg(e.keyType._def,{...r,currentPath:[...r.currentPath,"items","items","0"]})||{},tg(e.valueType._def,{...r,currentPath:[...r.currentPath,"items","items","1"]})||{}],minItems:2,maxItems:2}};case eO.ZodFirstPartyTypeKind.ZodSet:let E;return E={type:"array",uniqueItems:!0,items:tg(e.valueType._def,{...r,currentPath:[...r.currentPath,"items"]})},e.minSize&&(E.minItems=e.minSize.value),e.maxSize&&(E.maxItems=e.maxSize.value),E;case eO.ZodFirstPartyTypeKind.ZodLazy:return()=>e.getter()._def;case eO.ZodFirstPartyTypeKind.ZodPromise:return tg(e.type._def,r);case eO.ZodFirstPartyTypeKind.ZodNaN:case eO.ZodFirstPartyTypeKind.ZodNever:return{not:{}};case eO.ZodFirstPartyTypeKind.ZodEffects:return"input"===r.effectStrategy?tg(e.schema._def,r):{};case eO.ZodFirstPartyTypeKind.ZodAny:case eO.ZodFirstPartyTypeKind.ZodUnknown:return{};case eO.ZodFirstPartyTypeKind.ZodDefault:return{...tg(e.innerType._def,r),default:e.defaultValue()};case eO.ZodFirstPartyTypeKind.ZodBranded:return e9(e,r);case eO.ZodFirstPartyTypeKind.ZodReadonly:case eO.ZodFirstPartyTypeKind.ZodCatch:return tg(e.innerType._def,r);case eO.ZodFirstPartyTypeKind.ZodPipeline:if("input"===r.pipeStrategy)return tg(e.in._def,r);if("output"===r.pipeStrategy)return tg(e.out._def,r);let _=tg(e.in._def,{...r,currentPath:[...r.currentPath,"allOf","0"]}),T=tg(e.out._def,{...r,currentPath:[...r.currentPath,"allOf",_?"1":"0"]});return{allOf:[_,T].filter(e=>void 0!==e)};case eO.ZodFirstPartyTypeKind.ZodFunction:case eO.ZodFirstPartyTypeKind.ZodVoid:case eO.ZodFirstPartyTypeKind.ZodSymbol:default:return}})(e,e.typeName,t),i="function"==typeof n?tg(n(),t):n;if(i&&tf(e,t,i),t.postProcess){let r=t.postProcess(i,e,t);return s.jsonSchema=i,r}return s.jsonSchema=i,i}var ty=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:((e,t)=>{let r=0;for(;r<e.length&&r<t.length&&e[r]===t[r];r++);return[(e.length-r).toString(),...t.slice(r)].join("/")})(t.currentPath,e.path)};case"none":case"seen":if(e.path.length<t.currentPath.length&&e.path.every((e,r)=>t.currentPath[r]===e))return console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{};return"seen"===t.$refStrategy?{}:void 0}},tf=(e,t,r)=>(e.description&&(r.description=e.description),r),tv=Symbol.for("vercel.ai.schema");function tb(e){let t;return()=>(null==t&&(t=e()),t)}function tw(e){let{validate:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{[tv]:!0,_type:void 0,get jsonSchema(){return"function"==typeof e&&(e=e()),e},validate:t}}function tI(e){var t;return null==e?tw({properties:{},additionalProperties:!1}):"object"==typeof e&&null!==e&&tv in e&&!0===e[tv]&&"jsonSchema"in e&&"validate"in e?e:"~standard"in e?"zod"===e["~standard"].vendor?tE(e):(t=e,tw(()=>e0(t["~standard"].jsonSchema.input({target:"draft-07"})),{validate:async e=>{let r=await t["~standard"].validate(e);return"value"in r?{success:!0,value:r.value}:{success:!1,error:new ek({value:e,cause:r.issues})}}})):e()}function tE(e,t){var r,a;let o;if("_zod"in e){let a;return a=null!=(r=null==t?void 0:t.useReferences)&&r,tw(()=>e0(ej.toJSONSchema(e,{target:"draft-7",io:"input",reused:a?"ref":"inline"})),{validate:async t=>{let r=await eR.safeParseAsync(e,t);return r.success?{success:!0,value:r.data}:{success:!1,error:r.error}}})}return o=null!=(a=null==t?void 0:t.useReferences)&&a,tw(()=>((e,t)=>{var r;let a,o,s=(o=void 0!==(a="string"==typeof t?{...e4,name:t}:{...e4,...t}).name?[...a.basePath,a.definitionPath,a.name]:a.basePath,{...a,currentPath:o,propertyPath:void 0,seen:new Map(Object.entries(a.definitions).map(e=>{let[t,r]=e;return[r._def,{def:r._def,path:[...a.basePath,a.definitionPath,t],jsonSchema:void 0}]}))}),n="object"==typeof t&&t.definitions?Object.entries(t.definitions).reduce((e,t)=>{var r;let[a,o]=t;return{...e,[a]:null!=(r=tg(o._def,{...s,currentPath:[...s.basePath,s.definitionPath,a]},!0))?r:{}}},{}):void 0,i="string"==typeof t?t:(null==t?void 0:t.nameStrategy)==="title"||null==t?void 0:t.name,l=null!=(r=tg(e._def,void 0===i?s:{...s,currentPath:[...s.basePath,s.definitionPath,i]},!1))?r:{},c="object"==typeof t&&void 0!==t.name&&"title"===t.nameStrategy?t.name:void 0;void 0!==c&&(l.title=c);let u=void 0===i?n?{...l,[s.definitionPath]:n}:l:{$ref:[..."relative"===s.$refStrategy?[]:s.basePath,s.definitionPath,i].join("/"),[s.definitionPath]:{...n,[i]:l}};return u.$schema="http://json-schema.org/draft-07/schema#",u})(e,{$refStrategy:o?"root":"none"}),{validate:async t=>{let r=await e.safeParseAsync(t);return r.success?{success:!0,value:r.data}:{success:!1,error:r.error}}})}async function t_(e){let{value:t,schema:r}=e,a=await tT({value:t,schema:r});if(!a.success)throw ek.wrap({value:t,cause:a.error});return a.value}async function tT(e){let{value:t,schema:r}=e,a=tI(r);try{if(null==a.validate)return{success:!0,value:t,rawValue:t};let e=await a.validate(t);if(e.success)return{success:!0,value:e.value,rawValue:t};return{success:!1,error:ek.wrap({value:t,cause:e.error}),rawValue:t}}catch(e){return{success:!1,error:ek.wrap({value:t,cause:e}),rawValue:t}}}async function tS(e){let{text:t,schema:r}=e;try{let e=eQ(t);if(null==r)return e;return t_({value:e,schema:r})}catch(e){if(e_.isInstance(e)||ek.isInstance(e))throw e;throw new e_({text:t,cause:e})}}async function tA(e){let{text:t,schema:r}=e;try{let e=eQ(t);if(null==r)return{success:!0,value:e,rawValue:e};return await tT({value:e,schema:r})}catch(e){return{success:!1,error:e_.isInstance(e)?e:new e_({text:t,cause:e}),rawValue:void 0}}}function tx(e){let{stream:t,schema:r}=e;return t.pipeThrough(new TextDecoderStream).pipeThrough(new eC.EventSourceParserStream).pipeThrough(new TransformStream({async transform(e,t){let{data:a}=e;"[DONE]"!==a&&t.enqueue(await tA({text:a,schema:r}))}}))}var tk=async e=>{let{url:t,headers:r,body:a,failedResponseHandler:o,successfulResponseHandler:s,abortSignal:n,fetch:i}=e;return tM({url:t,headers:{"Content-Type":"application/json",...r},body:{content:JSON.stringify(a),values:a},failedResponseHandler:o,successfulResponseHandler:s,abortSignal:n,fetch:i})},tM=async e=>{let{url:t,headers:r={},body:a,successfulResponseHandler:o,failedResponseHandler:s,abortSignal:n,fetch:i=globalThis.fetch}=e;try{let e=await i(t,{method:"POST",headers:eK(r,`ai-sdk/provider-utils/${eH}`,eV()),body:a.content,signal:n}),l=eN(e);if(!e.ok){let r;try{r=await s({response:e,url:t,requestBodyValues:a.values})}catch(r){if(e$(r)||ec.isInstance(r))throw r;throw new ec({message:"Failed to process error response",cause:r,statusCode:e.status,url:t,responseHeaders:l,requestBodyValues:a.values})}throw r.value}try{return await o({response:e,url:t,requestBodyValues:a.values})}catch(r){if(r instanceof Error&&(e$(r)||ec.isInstance(r)))throw r;throw new ec({message:"Failed to process successful response",cause:r,statusCode:e.status,url:t,responseHeaders:l,requestBodyValues:a.values})}}catch(e){throw eB({error:e,url:t,requestBodyValues:a.values})}};async function tR(e){return"function"==typeof e&&(e=e()),Promise.resolve(e)}var tj=e=>{let{errorSchema:t,errorToMessage:r,isRetryable:a}=e;return async e=>{let{response:o,url:s,requestBodyValues:n}=e,i=await o.text(),l=eN(o);if(""===i.trim())return{responseHeaders:l,value:new ec({message:o.statusText,url:s,requestBodyValues:n,statusCode:o.status,responseHeaders:l,responseBody:i,isRetryable:null==a?void 0:a(o)})};try{let e=await tS({text:i,schema:t});return{responseHeaders:l,value:new ec({message:r(e),url:s,requestBodyValues:n,statusCode:o.status,responseHeaders:l,responseBody:i,data:e,isRetryable:null==a?void 0:a(o,e)})}}catch(e){return{responseHeaders:l,value:new ec({message:o.statusText,url:s,requestBodyValues:n,statusCode:o.status,responseHeaders:l,responseBody:i,isRetryable:null==a?void 0:a(o)})}}}},tO=e=>async t=>{let{response:r,url:a,requestBodyValues:o}=t,s=await r.text(),n=await tA({text:s,schema:e}),i=eN(r);if(!n.success)throw new ec({message:"Invalid JSON response",cause:n.error,statusCode:r.status,responseHeaders:i,responseBody:s,url:a,requestBodyValues:o});return{responseHeaders:i,value:n.value,rawValue:n.rawValue}};e.i(408667);var tC=ej,tP=e.i(9835407),tN=e.i(6439780),tF=Symbol.for("vercel.ai.gateway.error"),tD=class e extends(m=Error,h=tF,m){constructor({message:e,statusCode:t=500,cause:r}){super(e),this[h]=!0,this.statusCode=t,this.cause=r}static isInstance(t){return e.hasMarker(t)}static hasMarker(e){return"object"==typeof e&&null!==e&&tF in e&&!0===e[tF]}},tz="GatewayAuthenticationError",tL=Symbol.for(`vercel.ai.gateway.error.${tz}`),tU=class e extends(y=tD,g=tL,y){constructor({message:e="Authentication failed",statusCode:t=401,cause:r}={}){super({message:e,statusCode:t,cause:r}),this[g]=!0,this.name=tz,this.type="authentication_error"}static isInstance(e){return tD.hasMarker(e)&&tL in e}static createContextualError(t){let{apiKeyProvided:r,oidcTokenProvided:a,message:o="Authentication failed",statusCode:s=401,cause:n}=t;return new e({message:r?`AI Gateway authentication failed: Invalid API key.

Create a new API key: https://vercel.com/d?to=%2F%5Bteam%5D%2F%7E%2Fai%2Fapi-keys

Provide via 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.`:a?`AI Gateway authentication failed: Invalid OIDC token.

Run 'npx vercel link' to link your project, then 'vc env pull' to fetch the token.

Alternatively, use an API key: https://vercel.com/d?to=%2F%5Bteam%5D%2F%7E%2Fai%2Fapi-keys`:`AI Gateway authentication failed: No authentication provided.

Option 1 - API key:
Create an API key: https://vercel.com/d?to=%2F%5Bteam%5D%2F%7E%2Fai%2Fapi-keys
Provide via 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.

Option 2 - OIDC token:
Run 'npx vercel link' to link your project, then 'vc env pull' to fetch the token.`,statusCode:s,cause:n})}},t$="GatewayInvalidRequestError",tZ=Symbol.for(`vercel.ai.gateway.error.${t$}`),tB=class extends(v=tD,f=tZ,v){constructor({message:e="Invalid request",statusCode:t=400,cause:r}={}){super({message:e,statusCode:t,cause:r}),this[f]=!0,this.name=t$,this.type="invalid_request_error"}static isInstance(e){return tD.hasMarker(e)&&tZ in e}},tV="GatewayRateLimitError",tq=Symbol.for(`vercel.ai.gateway.error.${tV}`),tK=class extends(w=tD,b=tq,w){constructor({message:e="Rate limit exceeded",statusCode:t=429,cause:r}={}){super({message:e,statusCode:t,cause:r}),this[b]=!0,this.name=tV,this.type="rate_limit_exceeded"}static isInstance(e){return tD.hasMarker(e)&&tq in e}},tH="GatewayModelNotFoundError",tY=Symbol.for(`vercel.ai.gateway.error.${tH}`),tJ=tb(()=>tE(tC.object({modelId:tC.string()}))),tG=class extends(E=tD,I=tY,E){constructor({message:e="Model not found",statusCode:t=404,modelId:r,cause:a}={}){super({message:e,statusCode:t,cause:a}),this[I]=!0,this.name=tH,this.type="model_not_found",this.modelId=r}static isInstance(e){return tD.hasMarker(e)&&tY in e}},tW="GatewayInternalServerError",tX=Symbol.for(`vercel.ai.gateway.error.${tW}`),tQ=class extends(T=tD,_=tX,T){constructor({message:e="Internal server error",statusCode:t=500,cause:r}={}){super({message:e,statusCode:t,cause:r}),this[_]=!0,this.name=tW,this.type="internal_server_error"}static isInstance(e){return tD.hasMarker(e)&&tX in e}},t0="GatewayResponseError",t1=Symbol.for(`vercel.ai.gateway.error.${t0}`),t2=class extends(A=tD,S=t1,A){constructor({message:e="Invalid response from Gateway",statusCode:t=502,response:r,validationError:a,cause:o}={}){super({message:e,statusCode:t,cause:o}),this[S]=!0,this.name=t0,this.type="response_error",this.response=r,this.validationError=a}static isInstance(e){return tD.hasMarker(e)&&t1 in e}};async function t4(e){let{response:t,statusCode:r,defaultMessage:a="Gateway request failed",cause:o,authMethod:s}=e,n=await tT({value:t,schema:t9});if(!n.success)return new t2({message:`Invalid error response format: ${a}`,statusCode:r,response:t,validationError:n.error,cause:o});let i=n.value,l=i.error.type,c=i.error.message;switch(l){case"authentication_error":return tU.createContextualError({apiKeyProvided:"api-key"===s,oidcTokenProvided:"oidc"===s,statusCode:r,cause:o});case"invalid_request_error":return new tB({message:c,statusCode:r,cause:o});case"rate_limit_exceeded":return new tK({message:c,statusCode:r,cause:o});case"model_not_found":{let e=await tT({value:i.error.param,schema:tJ});return new tG({message:c,statusCode:r,modelId:e.success?e.value.modelId:void 0,cause:o})}default:return new tQ({message:c,statusCode:r,cause:o})}}var t9=tb(()=>tE(tC.object({error:tC.object({message:tC.string(),type:tC.string().nullish(),param:tC.unknown().nullish(),code:tC.union([tC.string(),tC.number()]).nullish()})})));function t5(e,t){var r;return tD.isInstance(e)?e:ec.isInstance(e)?t4({response:function(e){if(void 0!==e.data)return e.data;if(null!=e.responseBody)try{return JSON.parse(e.responseBody)}catch(t){return e.responseBody}return{}}(e),statusCode:null!=(r=e.statusCode)?r:500,defaultMessage:"Gateway request failed",cause:e,authMethod:t}):t4({response:{},statusCode:500,defaultMessage:e instanceof Error?`Gateway request failed: ${e.message}`:"Unknown Gateway error",cause:e,authMethod:t})}var t3="ai-gateway-auth-method";async function t6(e){let t=await tT({value:e[t3],schema:t8});return t.success?t.value:void 0}var t8=tb(()=>tE(tC.union([tC.literal("api-key"),tC.literal("oidc")]))),t7=class{constructor(e){this.config=e}async getAvailableModels(){try{let{value:e}=await eY({url:`${this.config.baseURL}/config`,headers:await tR(this.config.headers()),successfulResponseHandler:tO(re),failedResponseHandler:tj({errorSchema:tC.any(),errorToMessage:e=>e}),fetch:this.config.fetch});return e}catch(e){throw await t5(e)}}async getCredits(){try{let e=new URL(this.config.baseURL),{value:t}=await eY({url:`${e.origin}/v1/credits`,headers:await tR(this.config.headers()),successfulResponseHandler:tO(rt),failedResponseHandler:tj({errorSchema:tC.any(),errorToMessage:e=>e}),fetch:this.config.fetch});return t}catch(e){throw await t5(e)}}},re=tb(()=>tE(tC.object({models:tC.array(tC.object({id:tC.string(),name:tC.string(),description:tC.string().nullish(),pricing:tC.object({input:tC.string(),output:tC.string(),input_cache_read:tC.string().nullish(),input_cache_write:tC.string().nullish()}).transform(e=>{let{input:t,output:r,input_cache_read:a,input_cache_write:o}=e;return{input:t,output:r,...a?{cachedInputTokens:a}:{},...o?{cacheCreationInputTokens:o}:{}}}).nullish(),specification:tC.object({specificationVersion:tC.literal("v3"),provider:tC.string(),modelId:tC.string()}),modelType:tC.enum(["language","embedding","image"]).nullish()}))}))),rt=tb(()=>tE(tC.object({balance:tC.string(),total_used:tC.string()}).transform(e=>{let{balance:t,total_used:r}=e;return{balance:t,totalUsed:r}}))),rr=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v3",this.supportedUrls={"*/*":[/.*/]}}get provider(){return this.config.provider}async getArgs(e){let{abortSignal:t,...r}=e;return{args:this.maybeEncodeFileParts(r),warnings:[]}}async doGenerate(e){let{args:t,warnings:r}=await this.getArgs(e),{abortSignal:a}=e,o=await tR(this.config.headers());try{let{responseHeaders:s,value:n,rawValue:i}=await tk({url:this.getUrl(),headers:eP(o,e.headers,this.getModelConfigHeaders(this.modelId,!1),await tR(this.config.o11yHeaders)),body:t,successfulResponseHandler:tO(tC.any()),failedResponseHandler:tj({errorSchema:tC.any(),errorToMessage:e=>e}),...a&&{abortSignal:a},fetch:this.config.fetch});return{...n,request:{body:t},response:{headers:s,body:i},warnings:r}}catch(e){throw await t5(e,await t6(o))}}async doStream(e){let{args:t,warnings:r}=await this.getArgs(e),{abortSignal:a}=e,o=await tR(this.config.headers());try{let s,{value:n,responseHeaders:i}=await tk({url:this.getUrl(),headers:eP(o,e.headers,this.getModelConfigHeaders(this.modelId,!0),await tR(this.config.o11yHeaders)),body:t,successfulResponseHandler:(s=tC.any(),async e=>{let{response:t}=e,r=eN(t);if(null==t.body)throw new eh({});return{responseHeaders:r,value:tx({stream:t.body,schema:s})}}),failedResponseHandler:tj({errorSchema:tC.any(),errorToMessage:e=>e}),...a&&{abortSignal:a},fetch:this.config.fetch});return{stream:n.pipeThrough(new TransformStream({start(e){r.length>0&&e.enqueue({type:"stream-start",warnings:r})},transform(t,r){if(t.success){let a=t.value;("raw"!==a.type||e.includeRawChunks)&&("response-metadata"===a.type&&a.timestamp&&"string"==typeof a.timestamp&&(a.timestamp=new Date(a.timestamp)),r.enqueue(a))}else r.error(t.error)}})),request:{body:t},response:{headers:i}}}catch(e){throw await t5(e,await t6(o))}}isFilePart(e){return e&&"object"==typeof e&&"type"in e&&"file"===e.type}maybeEncodeFileParts(e){for(let t of e.prompt)for(let e of t.content)if(this.isFilePart(e)&&e.data instanceof Uint8Array){let t=Uint8Array.from(e.data),r=er.Buffer.from(t).toString("base64");e.data=new URL(`data:${e.mediaType||"application/octet-stream"};base64,${r}`)}return e}getUrl(){return`${this.config.baseURL}/language-model`}getModelConfigHeaders(e,t){return{"ai-language-model-specification-version":"3","ai-language-model-id":e,"ai-language-model-streaming":String(t)}}},ra=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v3",this.maxEmbeddingsPerCall=2048,this.supportsParallelCalls=!0}get provider(){return this.config.provider}async doEmbed(e){var t;let{values:r,headers:a,abortSignal:o,providerOptions:s}=e,n=await tR(this.config.headers());try{let{responseHeaders:e,value:i,rawValue:l}=await tk({url:this.getUrl(),headers:eP(n,null!=a?a:{},this.getModelConfigHeaders(),await tR(this.config.o11yHeaders)),body:{values:r,...s?{providerOptions:s}:{}},successfulResponseHandler:tO(ro),failedResponseHandler:tj({errorSchema:tC.any(),errorToMessage:e=>e}),...o&&{abortSignal:o},fetch:this.config.fetch});return{embeddings:i.embeddings,usage:null!=(t=i.usage)?t:void 0,providerMetadata:i.providerMetadata,response:{headers:e,body:l},warnings:[]}}catch(e){throw await t5(e,await t6(n))}}getUrl(){return`${this.config.baseURL}/embedding-model`}getModelConfigHeaders(){return{"ai-embedding-model-specification-version":"3","ai-model-id":this.modelId}}},ro=tb(()=>tE(tC.object({embeddings:tC.array(tC.array(tC.number())),usage:tC.object({tokens:tC.number()}).nullish(),providerMetadata:tC.record(tC.string(),tC.record(tC.string(),tC.unknown())).optional()}))),rs=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v3",this.maxImagesPerCall=Number.MAX_SAFE_INTEGER}get provider(){return this.config.provider}async doGenerate(e){var t;let{prompt:r,n:a,size:o,aspectRatio:s,seed:n,files:i,mask:l,providerOptions:c,headers:u,abortSignal:d}=e,p=await tR(this.config.headers());try{let{responseHeaders:e,value:h,rawValue:m}=await tk({url:this.getUrl(),headers:eP(p,null!=u?u:{},this.getModelConfigHeaders(),await tR(this.config.o11yHeaders)),body:{prompt:r,n:a,...o&&{size:o},...s&&{aspectRatio:s},...n&&{seed:n},...c&&{providerOptions:c},...i&&{files:i.map(e=>rn(e))},...l&&{mask:rn(l)}},successfulResponseHandler:tO(rl),failedResponseHandler:tj({errorSchema:tC.any(),errorToMessage:e=>e}),...d&&{abortSignal:d},fetch:this.config.fetch});return{images:h.images,warnings:null!=(t=h.warnings)?t:[],providerMetadata:h.providerMetadata,response:{timestamp:new Date,modelId:this.modelId,headers:e}}}catch(e){throw t5(e,await t6(p))}}getUrl(){return`${this.config.baseURL}/image-model`}getModelConfigHeaders(){return{"ai-image-model-specification-version":"3","ai-model-id":this.modelId}}};function rn(e){return"file"===e.type&&e.data instanceof Uint8Array?{...e,data:function(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCodePoint(e[r]);return eF(t)}(e.data)}:e}var ri=tC.object({images:tC.array(tC.unknown()).optional()}).catchall(tC.unknown()),rl=tC.object({images:tC.array(tC.string()),warnings:tC.array(tC.object({type:tC.literal("other"),message:tC.string()})).optional(),providerMetadata:tC.record(tC.string(),ri).optional()}),rc=function(e){let{id:t,inputSchema:r,outputSchema:a,supportsDeferredResults:o}=e;return e=>{let{execute:s,needsApproval:n,toModelOutput:i,onInputStart:l,onInputDelta:c,onInputAvailable:u,...d}=e;return{type:"provider",id:t,args:d,inputSchema:r,outputSchema:a,execute:s,needsApproval:n,toModelOutput:i,onInputStart:l,onInputDelta:c,onInputAvailable:u,supportsDeferredResults:o}}}({id:"gateway.perplexity_search",inputSchema:tb(()=>tE(tP.z.object({query:tP.z.union([tP.z.string(),tP.z.array(tP.z.string())]).describe("Search query (string) or multiple queries (array of up to 5 strings). Multi-query searches return combined results from all queries."),max_results:tP.z.number().optional().describe("Maximum number of search results to return (1-20, default: 10)"),max_tokens_per_page:tP.z.number().optional().describe("Maximum number of tokens to extract per search result page (256-2048, default: 2048)"),max_tokens:tP.z.number().optional().describe("Maximum total tokens across all search results (default: 25000, max: 1000000)"),country:tP.z.string().optional().describe("Two-letter ISO 3166-1 alpha-2 country code for regional search results (e.g., 'US', 'GB', 'FR')"),search_domain_filter:tP.z.array(tP.z.string()).optional().describe("List of domains to include or exclude from search results (max 20). To include: ['nature.com', 'science.org']. To exclude: ['-example.com', '-spam.net']"),search_language_filter:tP.z.array(tP.z.string()).optional().describe("List of ISO 639-1 language codes to filter results (max 10, lowercase). Examples: ['en', 'fr', 'de']"),search_after_date:tP.z.string().optional().describe("Include only results published after this date. Format: 'MM/DD/YYYY' (e.g., '3/1/2025'). Cannot be used with search_recency_filter."),search_before_date:tP.z.string().optional().describe("Include only results published before this date. Format: 'MM/DD/YYYY' (e.g., '3/15/2025'). Cannot be used with search_recency_filter."),last_updated_after_filter:tP.z.string().optional().describe("Include only results last updated after this date. Format: 'MM/DD/YYYY' (e.g., '3/1/2025'). Cannot be used with search_recency_filter."),last_updated_before_filter:tP.z.string().optional().describe("Include only results last updated before this date. Format: 'MM/DD/YYYY' (e.g., '3/15/2025'). Cannot be used with search_recency_filter."),search_recency_filter:tP.z.enum(["day","week","month","year"]).optional().describe("Filter results by relative time period. Cannot be used with search_after_date or search_before_date.")}))),outputSchema:tb(()=>tE(tP.z.union([tP.z.object({results:tP.z.array(tP.z.object({title:tP.z.string(),url:tP.z.string(),snippet:tP.z.string(),date:tP.z.string().optional(),lastUpdated:tP.z.string().optional()})),id:tP.z.string()}),tP.z.object({error:tP.z.enum(["api_error","rate_limit","timeout","invalid_input","unknown"]),statusCode:tP.z.number().optional(),message:tP.z.string()})])))}),ru={perplexitySearch:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return rc(e)}};async function rd(){var e;return null==(e=(0,tN.getContext)().headers)?void 0:e["x-vercel-id"]}async function rp(e){let t=eJ({settingValue:e.apiKey,environmentVariableName:"AI_GATEWAY_API_KEY"});return t?{token:t,authMethod:"api-key"}:{token:await (0,tN.getVercelOidcToken)(),authMethod:"oidc"}}!function(){var e,t,r;let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=null,s=null,n=null!=(e=a.metadataCacheRefreshMillis)?e:3e5,i=0,l=null!=(t=null==(r=a.baseURL)?void 0:r.replace(/\/$/,""))?t:"https://ai-gateway.vercel.sh/v3/ai",c=async()=>{try{let e=await rp(a);return eK({Authorization:`Bearer ${e.token}`,"ai-gateway-protocol-version":"0.0.1",[t3]:e.authMethod,...a.headers},"ai-sdk/gateway/3.0.17")}catch(e){throw tU.createContextualError({apiKeyProvided:!1,oidcTokenProvided:!1,statusCode:401,cause:e})}},u=()=>{let e=eJ({settingValue:void 0,environmentVariableName:"VERCEL_DEPLOYMENT_ID"}),t=eJ({settingValue:void 0,environmentVariableName:"VERCEL_ENV"}),r=eJ({settingValue:void 0,environmentVariableName:"VERCEL_REGION"});return async()=>{let a=await rd();return{...e&&{"ai-o11y-deployment-id":e},...t&&{"ai-o11y-environment":t},...r&&{"ai-o11y-region":r},...a&&{"ai-o11y-request-id":a}}}},d=e=>new rr(e,{provider:"gateway",baseURL:l,headers:c,fetch:a.fetch,o11yHeaders:u()}),p=async()=>{var e,t,r;let u=null!=(r=null==(t=null==(e=a._internal)?void 0:e.currentDate)?void 0:t.call(e).getTime())?r:Date.now();return(!o||u-i>n)&&(i=u,o=new t7({baseURL:l,headers:c,fetch:a.fetch}).getAvailableModels().then(e=>(s=e,e)).catch(async e=>{throw await t5(e,await t6(await c()))})),s?Promise.resolve(s):o},h=async()=>new t7({baseURL:l,headers:c,fetch:a.fetch}).getCredits().catch(async e=>{throw await t5(e,await t6(await c()))}),m=function(e){if(new.target)throw Error("The Gateway Provider model function cannot be called with the new keyword.");return d(e)};m.specificationVersion="v3",m.getAvailableModels=p,m.getCredits=h,m.imageModel=e=>new rs(e,{provider:"gateway",baseURL:l,headers:c,fetch:a.fetch,o11yHeaders:u()}),m.languageModel=d;let g=e=>new ra(e,{provider:"gateway",baseURL:l,headers:c,fetch:a.fetch,o11yHeaders:u()});m.embeddingModel=g,m.textEmbeddingModel=g,m.tools=ru}();var tC=ej;e.i(4048866),e.i(6370374),e.i(6423085);var rh=Object.defineProperty,rm=(Symbol.for("vercel.ai.error.AI_InvalidArgumentError"),Symbol.for("vercel.ai.error.AI_InvalidStreamPartError"),Symbol.for("vercel.ai.error.AI_InvalidToolApprovalError"),Symbol.for("vercel.ai.error.AI_InvalidToolInputError"),Symbol.for("vercel.ai.error.AI_ToolCallNotFoundForApprovalError"),Symbol.for("vercel.ai.error.AI_NoImageGeneratedError"),"AI_NoObjectGeneratedError"),rg=`vercel.ai.error.${rm}`,ry=Symbol.for(rg),rf=class extends es{constructor({message:e="No object generated.",cause:t,text:r,response:a,usage:o,finishReason:s}){super({name:rm,message:e,cause:t}),this[x]=!0,this.text=r,this.response=a,this.usage=o,this.finishReason=s}static isInstance(e){return es.hasMarker(e,rg)}};x=ry,Symbol.for("vercel.ai.error.AI_NoOutputGeneratedError"),Symbol.for("vercel.ai.error.AI_NoSuchToolError"),Symbol.for("vercel.ai.error.AI_ToolCallRepairError");var rv="AI_UIMessageStreamError",rb=`vercel.ai.error.${rv}`,rw=Symbol.for(rb),rI=class extends es{constructor({chunkType:e,chunkId:t,message:r}){super({name:rv,message:r}),this[k]=!0,this.chunkType=e,this.chunkId=t}static isInstance(e){return es.hasMarker(e,rb)}};k=rw,Symbol.for("vercel.ai.error.AI_InvalidDataContentError"),Symbol.for("vercel.ai.error.AI_InvalidMessageRoleError"),Symbol.for("vercel.ai.error.AI_MessageConversionError"),Symbol.for("vercel.ai.error.AI_RetryError");var rE="6.0.42",r_=tC.union([tC.string(),tC.instanceof(Uint8Array),tC.instanceof(ArrayBuffer),tC.custom(e=>{var t,r;return null!=(r=null==(t=globalThis.Buffer)?void 0:t.isBuffer(e))&&r},{message:"Must be a Buffer"})]),rT=tC.lazy(()=>tC.union([tC.null(),tC.string(),tC.number(),tC.boolean(),tC.record(tC.string(),rT.optional()),tC.array(rT)])),rS=tC.record(tC.string(),tC.record(tC.string(),rT.optional())),rA=tC.object({type:tC.literal("text"),text:tC.string(),providerOptions:rS.optional()}),rx=tC.object({type:tC.literal("image"),image:tC.union([r_,tC.instanceof(URL)]),mediaType:tC.string().optional(),providerOptions:rS.optional()}),rk=tC.object({type:tC.literal("file"),data:tC.union([r_,tC.instanceof(URL)]),filename:tC.string().optional(),mediaType:tC.string(),providerOptions:rS.optional()}),rM=tC.object({type:tC.literal("reasoning"),text:tC.string(),providerOptions:rS.optional()}),rR=tC.object({type:tC.literal("tool-call"),toolCallId:tC.string(),toolName:tC.string(),input:tC.unknown(),providerOptions:rS.optional(),providerExecuted:tC.boolean().optional()}),rj=tC.discriminatedUnion("type",[tC.object({type:tC.literal("text"),value:tC.string(),providerOptions:rS.optional()}),tC.object({type:tC.literal("json"),value:rT,providerOptions:rS.optional()}),tC.object({type:tC.literal("execution-denied"),reason:tC.string().optional(),providerOptions:rS.optional()}),tC.object({type:tC.literal("error-text"),value:tC.string(),providerOptions:rS.optional()}),tC.object({type:tC.literal("error-json"),value:rT,providerOptions:rS.optional()}),tC.object({type:tC.literal("content"),value:tC.array(tC.union([tC.object({type:tC.literal("text"),text:tC.string(),providerOptions:rS.optional()}),tC.object({type:tC.literal("media"),data:tC.string(),mediaType:tC.string()}),tC.object({type:tC.literal("file-data"),data:tC.string(),mediaType:tC.string(),filename:tC.string().optional(),providerOptions:rS.optional()}),tC.object({type:tC.literal("file-url"),url:tC.string(),providerOptions:rS.optional()}),tC.object({type:tC.literal("file-id"),fileId:tC.union([tC.string(),tC.record(tC.string(),tC.string())]),providerOptions:rS.optional()}),tC.object({type:tC.literal("image-data"),data:tC.string(),mediaType:tC.string(),providerOptions:rS.optional()}),tC.object({type:tC.literal("image-url"),url:tC.string(),providerOptions:rS.optional()}),tC.object({type:tC.literal("image-file-id"),fileId:tC.union([tC.string(),tC.record(tC.string(),tC.string())]),providerOptions:rS.optional()}),tC.object({type:tC.literal("custom"),providerOptions:rS.optional()})]))})]),rO=tC.object({type:tC.literal("tool-result"),toolCallId:tC.string(),toolName:tC.string(),output:rj,providerOptions:rS.optional()}),rC=tC.object({type:tC.literal("tool-approval-request"),approvalId:tC.string(),toolCallId:tC.string()}),rP=tC.object({type:tC.literal("tool-approval-response"),approvalId:tC.string(),approved:tC.boolean(),reason:tC.string().optional()}),rN=tC.object({role:tC.literal("system"),content:tC.string(),providerOptions:rS.optional()}),rF=tC.object({role:tC.literal("user"),content:tC.union([tC.string(),tC.array(tC.union([rA,rx,rk]))]),providerOptions:rS.optional()}),rD=tC.object({role:tC.literal("assistant"),content:tC.union([tC.string(),tC.array(tC.union([rA,rk,rM,rR,rO,rC]))]),providerOptions:rS.optional()}),rz=tC.object({role:tC.literal("tool"),content:tC.array(tC.union([rO,rP])),providerOptions:rS.optional()});tC.union([rN,rF,rD,rz]);var rL={},rU={array:()=>rq,choice:()=>rK,json:()=>rH,object:()=>rV,text:()=>rB};for(var r$ in rU)rh(rL,r$,{get:rU[r$],enumerable:!0});async function rZ(e){if(void 0===e)return{value:void 0,state:"undefined-input"};let t=await tA({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=await tA({text:function(e){let t=["ROOT"],r=-1,a=null;function o(e,o,s){switch(e){case'"':r=o,t.pop(),t.push(s),t.push("INSIDE_STRING");break;case"f":case"t":case"n":r=o,a=o,t.pop(),t.push(s),t.push("INSIDE_LITERAL");break;case"-":t.pop(),t.push(s),t.push("INSIDE_NUMBER");break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":r=o,t.pop(),t.push(s),t.push("INSIDE_NUMBER");break;case"{":r=o,t.pop(),t.push(s),t.push("INSIDE_OBJECT_START");break;case"[":r=o,t.pop(),t.push(s),t.push("INSIDE_ARRAY_START")}}function s(e,a){switch(e){case",":t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break;case"}":r=a,t.pop()}}function n(e,a){switch(e){case",":t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":r=a,t.pop()}}for(let i=0;i<e.length;i++){let l=e[i];switch(t[t.length-1]){case"ROOT":o(l,i,"FINISH");break;case"INSIDE_OBJECT_START":switch(l){case'"':t.pop(),t.push("INSIDE_OBJECT_KEY");break;case"}":r=i,t.pop()}break;case"INSIDE_OBJECT_AFTER_COMMA":'"'===l&&(t.pop(),t.push("INSIDE_OBJECT_KEY"));break;case"INSIDE_OBJECT_KEY":'"'===l&&(t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY"));break;case"INSIDE_OBJECT_AFTER_KEY":":"===l&&(t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE"));break;case"INSIDE_OBJECT_BEFORE_VALUE":o(l,i,"INSIDE_OBJECT_AFTER_VALUE");break;case"INSIDE_OBJECT_AFTER_VALUE":s(l,i);break;case"INSIDE_STRING":switch(l){case'"':t.pop(),r=i;break;case"\\":t.push("INSIDE_STRING_ESCAPE");break;default:r=i}break;case"INSIDE_ARRAY_START":"]"===l?(r=i,t.pop()):(r=i,o(l,i,"INSIDE_ARRAY_AFTER_VALUE"));break;case"INSIDE_ARRAY_AFTER_VALUE":switch(l){case",":t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":r=i,t.pop();break;default:r=i}break;case"INSIDE_ARRAY_AFTER_COMMA":o(l,i,"INSIDE_ARRAY_AFTER_VALUE");break;case"INSIDE_STRING_ESCAPE":t.pop(),r=i;break;case"INSIDE_NUMBER":switch(l){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":r=i;break;case"e":case"E":case"-":case".":break;case",":t.pop(),"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&n(l,i),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]&&s(l,i);break;case"}":t.pop(),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]&&s(l,i);break;case"]":t.pop(),"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&n(l,i);break;default:t.pop()}break;case"INSIDE_LITERAL":{let o=e.substring(a,i+1);"false".startsWith(o)||"true".startsWith(o)||"null".startsWith(o)?r=i:(t.pop(),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]?s(l,i):"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&n(l,i))}}}let i=e.slice(0,r+1);for(let r=t.length-1;r>=0;r--)switch(t[r]){case"INSIDE_STRING":i+='"';break;case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":i+="}";break;case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":i+="]";break;case"INSIDE_LITERAL":{let t=e.substring(a,e.length);"true".startsWith(t)?i+="true".slice(t.length):"false".startsWith(t)?i+="false".slice(t.length):"null".startsWith(t)&&(i+="null".slice(t.length))}}return i}(e)})).success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"}}var rB=()=>({name:"text",responseFormat:Promise.resolve({type:"text"}),async parseCompleteOutput(e){let{text:t}=e;return t},async parsePartialOutput(e){let{text:t}=e;return{partial:t}},createElementStreamTransform(){}}),rV=e=>{let{schema:t,name:r,description:a}=e,o=tI(t);return{name:"object",responseFormat:tR(o.jsonSchema).then(e=>({type:"json",schema:e,...null!=r&&{name:r},...null!=a&&{description:a}})),async parseCompleteOutput(e,t){let{text:r}=e,a=await tA({text:r});if(!a.success)throw new rf({message:"No object generated: could not parse the response.",cause:a.error,text:r,response:t.response,usage:t.usage,finishReason:t.finishReason});let s=await tT({value:a.value,schema:o});if(!s.success)throw new rf({message:"No object generated: response did not match schema.",cause:s.error,text:r,response:t.response,usage:t.usage,finishReason:t.finishReason});return s.value},async parsePartialOutput(e){let{text:t}=e,r=await rZ(t);switch(r.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return{partial:r.value}}},createElementStreamTransform(){}}},rq=e=>{let{element:t,name:r,description:a}=e,o=tI(t);return{name:"array",responseFormat:tR(o.jsonSchema).then(e=>{let{$schema:t,...o}=e;return{type:"json",schema:{$schema:"http://json-schema.org/draft-07/schema#",type:"object",properties:{elements:{type:"array",items:o}},required:["elements"],additionalProperties:!1},...null!=r&&{name:r},...null!=a&&{description:a}}}),async parseCompleteOutput(e,t){let{text:r}=e,a=await tA({text:r});if(!a.success)throw new rf({message:"No object generated: could not parse the response.",cause:a.error,text:r,response:t.response,usage:t.usage,finishReason:t.finishReason});let s=a.value;if(null==s||"object"!=typeof s||!("elements"in s)||!Array.isArray(s.elements))throw new rf({message:"No object generated: response did not match schema.",cause:new ek({value:s,cause:"response must be an object with an elements array"}),text:r,response:t.response,usage:t.usage,finishReason:t.finishReason});for(let e of s.elements){let a=await tT({value:e,schema:o});if(!a.success)throw new rf({message:"No object generated: response did not match schema.",cause:a.error,text:r,response:t.response,usage:t.usage,finishReason:t.finishReason})}return s.elements},async parsePartialOutput(e){let{text:t}=e,r=await rZ(t);switch(r.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":{let e=r.value;if(null==e||"object"!=typeof e||!("elements"in e)||!Array.isArray(e.elements))return;let t="repaired-parse"===r.state&&e.elements.length>0?e.elements.slice(0,-1):e.elements,a=[];for(let e of t){let t=await tT({value:e,schema:o});t.success&&a.push(t.value)}return{partial:a}}}},createElementStreamTransform(){let e=0;return new TransformStream({transform(t,r){let{partialOutput:a}=t;if(null!=a)for(;e<a.length;e++)r.enqueue(a[e])}})}}},rK=e=>{let{options:t,name:r,description:a}=e;return{name:"choice",responseFormat:Promise.resolve({type:"json",schema:{$schema:"http://json-schema.org/draft-07/schema#",type:"object",properties:{result:{type:"string",enum:t}},required:["result"],additionalProperties:!1},...null!=r&&{name:r},...null!=a&&{description:a}}),async parseCompleteOutput(e,r){let{text:a}=e,o=await tA({text:a});if(!o.success)throw new rf({message:"No object generated: could not parse the response.",cause:o.error,text:a,response:r.response,usage:r.usage,finishReason:r.finishReason});let s=o.value;if(null==s||"object"!=typeof s||!("result"in s)||"string"!=typeof s.result||!t.includes(s.result))throw new rf({message:"No object generated: response did not match schema.",cause:new ek({value:s,cause:"response must be an object that contains a choice value."}),text:a,response:r.response,usage:r.usage,finishReason:r.finishReason});return s.result},async parsePartialOutput(e){let{text:r}=e,a=await rZ(r);switch(a.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":{let e=a.value;if(null==e||"object"!=typeof e||!("result"in e)||"string"!=typeof e.result)return;let r=t.filter(t=>t.startsWith(e.result));if("successful-parse"===a.state)return r.includes(e.result)?{partial:e.result}:void 0;return 1===r.length?{partial:r[0]}:void 0}}},createElementStreamTransform(){}}},rH=function(){let{name:e,description:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{name:"json",responseFormat:Promise.resolve({type:"json",...null!=e&&{name:e},...null!=t&&{description:t}}),async parseCompleteOutput(e,t){let{text:r}=e,a=await tA({text:r});if(!a.success)throw new rf({message:"No object generated: could not parse the response.",cause:a.error,text:r,response:t.response,usage:t.usage,finishReason:t.finishReason});return a.value},async parsePartialOutput(e){let{text:t}=e,r=await rZ(t);switch(r.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return void 0===r.value?void 0:{partial:r.value}}},createElementStreamTransform(){}}};eL({prefix:"aitxt",size:24}),TransformStream;var rY=tb(()=>tE(tC.union([tC.strictObject({type:tC.literal("text-start"),id:tC.string(),providerMetadata:rS.optional()}),tC.strictObject({type:tC.literal("text-delta"),id:tC.string(),delta:tC.string(),providerMetadata:rS.optional()}),tC.strictObject({type:tC.literal("text-end"),id:tC.string(),providerMetadata:rS.optional()}),tC.strictObject({type:tC.literal("error"),errorText:tC.string()}),tC.strictObject({type:tC.literal("tool-input-start"),toolCallId:tC.string(),toolName:tC.string(),providerExecuted:tC.boolean().optional(),providerMetadata:rS.optional(),dynamic:tC.boolean().optional(),title:tC.string().optional()}),tC.strictObject({type:tC.literal("tool-input-delta"),toolCallId:tC.string(),inputTextDelta:tC.string()}),tC.strictObject({type:tC.literal("tool-input-available"),toolCallId:tC.string(),toolName:tC.string(),input:tC.unknown(),providerExecuted:tC.boolean().optional(),providerMetadata:rS.optional(),dynamic:tC.boolean().optional(),title:tC.string().optional()}),tC.strictObject({type:tC.literal("tool-input-error"),toolCallId:tC.string(),toolName:tC.string(),input:tC.unknown(),providerExecuted:tC.boolean().optional(),providerMetadata:rS.optional(),dynamic:tC.boolean().optional(),errorText:tC.string(),title:tC.string().optional()}),tC.strictObject({type:tC.literal("tool-approval-request"),approvalId:tC.string(),toolCallId:tC.string()}),tC.strictObject({type:tC.literal("tool-output-available"),toolCallId:tC.string(),output:tC.unknown(),providerExecuted:tC.boolean().optional(),dynamic:tC.boolean().optional(),preliminary:tC.boolean().optional()}),tC.strictObject({type:tC.literal("tool-output-error"),toolCallId:tC.string(),errorText:tC.string(),providerExecuted:tC.boolean().optional(),dynamic:tC.boolean().optional()}),tC.strictObject({type:tC.literal("tool-output-denied"),toolCallId:tC.string()}),tC.strictObject({type:tC.literal("reasoning-start"),id:tC.string(),providerMetadata:rS.optional()}),tC.strictObject({type:tC.literal("reasoning-delta"),id:tC.string(),delta:tC.string(),providerMetadata:rS.optional()}),tC.strictObject({type:tC.literal("reasoning-end"),id:tC.string(),providerMetadata:rS.optional()}),tC.strictObject({type:tC.literal("source-url"),sourceId:tC.string(),url:tC.string(),title:tC.string().optional(),providerMetadata:rS.optional()}),tC.strictObject({type:tC.literal("source-document"),sourceId:tC.string(),mediaType:tC.string(),title:tC.string(),filename:tC.string().optional(),providerMetadata:rS.optional()}),tC.strictObject({type:tC.literal("file"),url:tC.string(),mediaType:tC.string(),providerMetadata:rS.optional()}),tC.strictObject({type:tC.custom(e=>"string"==typeof e&&e.startsWith("data-"),{message:'Type must start with "data-"'}),id:tC.string().optional(),data:tC.unknown(),transient:tC.boolean().optional()}),tC.strictObject({type:tC.literal("start-step")}),tC.strictObject({type:tC.literal("finish-step")}),tC.strictObject({type:tC.literal("start"),messageId:tC.string().optional(),messageMetadata:tC.unknown().optional()}),tC.strictObject({type:tC.literal("finish"),finishReason:tC.enum(["stop","length","content-filter","tool-calls","error","other"]).optional(),messageMetadata:tC.unknown().optional()}),tC.strictObject({type:tC.literal("abort"),reason:tC.string().optional()}),tC.strictObject({type:tC.literal("message-metadata"),messageMetadata:tC.unknown()})])));function rJ(e){return e.type.startsWith("tool-")}function rG(e){return rJ(e)||"dynamic-tool"===e.type}function rW(e){return e.type.split("-").slice(1).join("-")}async function rX(e){let{stream:t,onError:r}=e,a=t.getReader();try{for(;;){let{done:e}=await a.read();if(e)break}}catch(e){null==r||r(e)}finally{a.releaseLock()}}eL({prefix:"aitxt",size:24}),tb(()=>tE(tC.array(tC.object({id:tC.string(),role:tC.enum(["system","user","assistant"]),metadata:tC.unknown().optional(),parts:tC.array(tC.union([tC.object({type:tC.literal("text"),text:tC.string(),state:tC.enum(["streaming","done"]).optional(),providerMetadata:rS.optional()}),tC.object({type:tC.literal("reasoning"),text:tC.string(),state:tC.enum(["streaming","done"]).optional(),providerMetadata:rS.optional()}),tC.object({type:tC.literal("source-url"),sourceId:tC.string(),url:tC.string(),title:tC.string().optional(),providerMetadata:rS.optional()}),tC.object({type:tC.literal("source-document"),sourceId:tC.string(),mediaType:tC.string(),title:tC.string(),filename:tC.string().optional(),providerMetadata:rS.optional()}),tC.object({type:tC.literal("file"),mediaType:tC.string(),filename:tC.string().optional(),url:tC.string(),providerMetadata:rS.optional()}),tC.object({type:tC.literal("step-start")}),tC.object({type:tC.string().startsWith("data-"),id:tC.string().optional(),data:tC.unknown()}),tC.object({type:tC.literal("dynamic-tool"),toolName:tC.string(),toolCallId:tC.string(),state:tC.literal("input-streaming"),input:tC.unknown().optional(),providerExecuted:tC.boolean().optional(),callProviderMetadata:rS.optional(),output:tC.never().optional(),errorText:tC.never().optional(),approval:tC.never().optional()}),tC.object({type:tC.literal("dynamic-tool"),toolName:tC.string(),toolCallId:tC.string(),state:tC.literal("input-available"),input:tC.unknown(),providerExecuted:tC.boolean().optional(),output:tC.never().optional(),errorText:tC.never().optional(),callProviderMetadata:rS.optional(),approval:tC.never().optional()}),tC.object({type:tC.literal("dynamic-tool"),toolName:tC.string(),toolCallId:tC.string(),state:tC.literal("approval-requested"),input:tC.unknown(),providerExecuted:tC.boolean().optional(),output:tC.never().optional(),errorText:tC.never().optional(),callProviderMetadata:rS.optional(),approval:tC.object({id:tC.string(),approved:tC.never().optional(),reason:tC.never().optional()})}),tC.object({type:tC.literal("dynamic-tool"),toolName:tC.string(),toolCallId:tC.string(),state:tC.literal("approval-responded"),input:tC.unknown(),providerExecuted:tC.boolean().optional(),output:tC.never().optional(),errorText:tC.never().optional(),callProviderMetadata:rS.optional(),approval:tC.object({id:tC.string(),approved:tC.boolean(),reason:tC.string().optional()})}),tC.object({type:tC.literal("dynamic-tool"),toolName:tC.string(),toolCallId:tC.string(),state:tC.literal("output-available"),input:tC.unknown(),providerExecuted:tC.boolean().optional(),output:tC.unknown(),errorText:tC.never().optional(),callProviderMetadata:rS.optional(),preliminary:tC.boolean().optional(),approval:tC.object({id:tC.string(),approved:tC.literal(!0),reason:tC.string().optional()}).optional()}),tC.object({type:tC.literal("dynamic-tool"),toolName:tC.string(),toolCallId:tC.string(),state:tC.literal("output-error"),input:tC.unknown(),rawInput:tC.unknown().optional(),providerExecuted:tC.boolean().optional(),output:tC.never().optional(),errorText:tC.string(),callProviderMetadata:rS.optional(),approval:tC.object({id:tC.string(),approved:tC.literal(!0),reason:tC.string().optional()}).optional()}),tC.object({type:tC.literal("dynamic-tool"),toolName:tC.string(),toolCallId:tC.string(),state:tC.literal("output-denied"),input:tC.unknown(),providerExecuted:tC.boolean().optional(),output:tC.never().optional(),errorText:tC.never().optional(),callProviderMetadata:rS.optional(),approval:tC.object({id:tC.string(),approved:tC.literal(!1),reason:tC.string().optional()})}),tC.object({type:tC.string().startsWith("tool-"),toolCallId:tC.string(),state:tC.literal("input-streaming"),providerExecuted:tC.boolean().optional(),callProviderMetadata:rS.optional(),input:tC.unknown().optional(),output:tC.never().optional(),errorText:tC.never().optional(),approval:tC.never().optional()}),tC.object({type:tC.string().startsWith("tool-"),toolCallId:tC.string(),state:tC.literal("input-available"),providerExecuted:tC.boolean().optional(),input:tC.unknown(),output:tC.never().optional(),errorText:tC.never().optional(),callProviderMetadata:rS.optional(),approval:tC.never().optional()}),tC.object({type:tC.string().startsWith("tool-"),toolCallId:tC.string(),state:tC.literal("approval-requested"),input:tC.unknown(),providerExecuted:tC.boolean().optional(),output:tC.never().optional(),errorText:tC.never().optional(),callProviderMetadata:rS.optional(),approval:tC.object({id:tC.string(),approved:tC.never().optional(),reason:tC.never().optional()})}),tC.object({type:tC.string().startsWith("tool-"),toolCallId:tC.string(),state:tC.literal("approval-responded"),input:tC.unknown(),providerExecuted:tC.boolean().optional(),output:tC.never().optional(),errorText:tC.never().optional(),callProviderMetadata:rS.optional(),approval:tC.object({id:tC.string(),approved:tC.boolean(),reason:tC.string().optional()})}),tC.object({type:tC.string().startsWith("tool-"),toolCallId:tC.string(),state:tC.literal("output-available"),providerExecuted:tC.boolean().optional(),input:tC.unknown(),output:tC.unknown(),errorText:tC.never().optional(),callProviderMetadata:rS.optional(),preliminary:tC.boolean().optional(),approval:tC.object({id:tC.string(),approved:tC.literal(!0),reason:tC.string().optional()}).optional()}),tC.object({type:tC.string().startsWith("tool-"),toolCallId:tC.string(),state:tC.literal("output-error"),providerExecuted:tC.boolean().optional(),input:tC.unknown(),rawInput:tC.unknown().optional(),output:tC.never().optional(),errorText:tC.string(),callProviderMetadata:rS.optional(),approval:tC.object({id:tC.string(),approved:tC.literal(!0),reason:tC.string().optional()}).optional()}),tC.object({type:tC.string().startsWith("tool-"),toolCallId:tC.string(),state:tC.literal("output-denied"),providerExecuted:tC.boolean().optional(),input:tC.unknown(),output:tC.never().optional(),errorText:tC.never().optional(),callProviderMetadata:rS.optional(),approval:tC.object({id:tC.string(),approved:tC.literal(!1),reason:tC.string().optional()})})])).nonempty("Message must contain at least one part")})).nonempty("Messages array must not be empty"))),eL({prefix:"aiobj",size:24});var rQ=class{constructor(){this.queue=[],this.isProcessing=!1}async processQueue(){if(!this.isProcessing){for(this.isProcessing=!0;this.queue.length>0;)await this.queue[0](),this.queue.shift();this.isProcessing=!1}}async run(e){return new Promise((t,r)=>{this.queue.push(async()=>{try{await e(),t()}catch(e){r(e)}}),this.processQueue()})}};async function r0(e){if(null==e)return[];if(!globalThis.FileList||!(e instanceof globalThis.FileList))throw Error("FileList is not supported in the current environment");return Promise.all(Array.from(e).map(async e=>{let{name:t,type:r}=e;return{type:"file",mediaType:r,filename:t,url:await new Promise((t,r)=>{let a=new FileReader;a.onload=e=>{var r;t(null==(r=e.target)?void 0:r.result)},a.onerror=e=>r(e),a.readAsDataURL(e)})}}))}eL({prefix:"aiobj",size:24}),Symbol.for("vercel.ai.error.AI_NoSuchProviderError");var r1=class{constructor({api:e="/api/chat",credentials:t,headers:r,body:a,fetch:o,prepareSendMessagesRequest:s,prepareReconnectToStreamRequest:n}){this.api=e,this.credentials=t,this.headers=r,this.body=a,this.fetch=o,this.prepareSendMessagesRequest=s,this.prepareReconnectToStreamRequest=n}async sendMessages(e){var t,r,a,o,s;let{abortSignal:n,...i}=e,l=await tR(this.body),c=await tR(this.headers),u=await tR(this.credentials),d={...eq(c),...eq(i.headers)},p=await (null==(t=this.prepareSendMessagesRequest)?void 0:t.call(this,{api:this.api,id:i.chatId,messages:i.messages,body:{...l,...i.body},headers:d,credentials:u,requestMetadata:i.metadata,trigger:i.trigger,messageId:i.messageId})),h=null!=(r=null==p?void 0:p.api)?r:this.api,m=(null==p?void 0:p.headers)!==void 0?eq(p.headers):d,g=(null==p?void 0:p.body)!==void 0?p.body:{...l,...i.body,id:i.chatId,messages:i.messages,trigger:i.trigger,messageId:i.messageId},y=null!=(a=null==p?void 0:p.credentials)?a:u,f=null!=(o=this.fetch)?o:globalThis.fetch,v=await f(h,{method:"POST",headers:eK({"Content-Type":"application/json",...m},`ai-sdk/${rE}`,eV()),body:JSON.stringify(g),credentials:y,signal:n});if(!v.ok)throw Error(null!=(s=await v.text())?s:"Failed to fetch the chat response.");if(!v.body)throw Error("The response body is empty.");return this.processResponseStream(v.body)}async reconnectToStream(e){var t,r,a,o,s;let n=await tR(this.body),i=await tR(this.headers),l=await tR(this.credentials),c={...eq(i),...eq(e.headers)},u=await (null==(t=this.prepareReconnectToStreamRequest)?void 0:t.call(this,{api:this.api,id:e.chatId,body:{...n,...e.body},headers:c,credentials:l,requestMetadata:e.metadata})),d=null!=(r=null==u?void 0:u.api)?r:`${this.api}/${e.chatId}/stream`,p=(null==u?void 0:u.headers)!==void 0?eq(u.headers):c,h=null!=(a=null==u?void 0:u.credentials)?a:l,m=null!=(o=this.fetch)?o:globalThis.fetch,g=await m(d,{method:"GET",headers:eK(p,`ai-sdk/${rE}`,eV()),credentials:h});if(204===g.status)return null;if(!g.ok)throw Error(null!=(s=await g.text())?s:"Failed to fetch the chat response.");if(!g.body)throw Error("The response body is empty.");return this.processResponseStream(g.body)}},r2=class extends r1{constructor(e={}){super(e)}processResponseStream(e){return tx({stream:e,schema:rY}).pipeThrough(new TransformStream({async transform(e,t){if(!e.success)throw e.error;t.enqueue(e.value)}}))}},r4=class{constructor({generateId:e=eU,id:t=e(),transport:r=new r2,messageMetadataSchema:a,dataPartSchemas:o,state:s,onError:n,onToolCall:i,onFinish:l,onData:c,sendAutomaticallyWhen:u}){var d=this;this.activeResponse=void 0,this.jobExecutor=new rQ,this.sendMessage=async(e,t)=>{var r,a,o,s;let n;if(null==e)return void await this.makeRequest({trigger:"submit-message",messageId:null==(r=this.lastMessage)?void 0:r.id,...t});if(n="text"in e||"files"in e?{parts:[...Array.isArray(e.files)?e.files:await r0(e.files),..."text"in e&&null!=e.text?[{type:"text",text:e.text}]:[]]}:e,null!=e.messageId){let t=this.state.messages.findIndex(t=>t.id===e.messageId);if(-1===t)throw Error(`message with id ${e.messageId} not found`);if("user"!==this.state.messages[t].role)throw Error(`message with id ${e.messageId} is not a user message`);this.state.messages=this.state.messages.slice(0,t+1),this.state.replaceMessage(t,{...n,id:e.messageId,role:null!=(a=n.role)?a:"user",metadata:e.metadata})}else this.state.pushMessage({...n,id:null!=(o=n.id)?o:this.generateId(),role:null!=(s=n.role)?s:"user",metadata:e.metadata});await this.makeRequest({trigger:"submit-message",messageId:e.messageId,...t})},this.regenerate=async function(){let{messageId:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=null==e?d.state.messages.length-1:d.state.messages.findIndex(t=>t.id===e);if(-1===r)throw Error(`message ${e} not found`);d.state.messages=d.state.messages.slice(0,"assistant"===d.messages[r].role?r:r+1),await d.makeRequest({trigger:"regenerate-message",messageId:e,...t})},this.resumeStream=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};await d.makeRequest({trigger:"resume-stream",...e})},this.clearError=()=>{"error"===this.status&&(this.state.error=void 0,this.setStatus({status:"ready"}))},this.addToolApprovalResponse=async e=>{let{id:t,approved:r,reason:a}=e;return this.jobExecutor.run(async()=>{var e,o;let s=this.state.messages,n=s[s.length-1],i=e=>rG(e)&&"approval-requested"===e.state&&e.approval.id===t?{...e,state:"approval-responded",approval:{id:t,approved:r,reason:a}}:e;this.state.replaceMessage(s.length-1,{...n,parts:n.parts.map(i)}),this.activeResponse&&(this.activeResponse.state.message.parts=this.activeResponse.state.message.parts.map(i)),"streaming"!==this.status&&"submitted"!==this.status&&(null==(e=this.sendAutomaticallyWhen)?void 0:e.call(this,{messages:this.state.messages}))&&this.makeRequest({trigger:"submit-message",messageId:null==(o=this.lastMessage)?void 0:o.id})})},this.addToolOutput=async e=>{let{state:t="output-available",tool:r,toolCallId:a,output:o,errorText:s}=e;return this.jobExecutor.run(async()=>{var e,r;let n=this.state.messages,i=n[n.length-1],l=e=>rG(e)&&e.toolCallId===a?{...e,state:t,output:o,errorText:s}:e;this.state.replaceMessage(n.length-1,{...i,parts:i.parts.map(l)}),this.activeResponse&&(this.activeResponse.state.message.parts=this.activeResponse.state.message.parts.map(l)),"streaming"!==this.status&&"submitted"!==this.status&&(null==(e=this.sendAutomaticallyWhen)?void 0:e.call(this,{messages:this.state.messages}))&&this.makeRequest({trigger:"submit-message",messageId:null==(r=this.lastMessage)?void 0:r.id})})},this.addToolResult=this.addToolOutput,this.stop=async()=>{var e;("streaming"===this.status||"submitted"===this.status)&&(null==(e=this.activeResponse)?void 0:e.abortController)&&this.activeResponse.abortController.abort()},this.id=t,this.transport=r,this.generateId=e,this.messageMetadataSchema=a,this.dataPartSchemas=o,this.state=s,this.onError=n,this.onToolCall=i,this.onFinish=l,this.onData=c,this.sendAutomaticallyWhen=u}get status(){return this.state.status}setStatus(e){let{status:t,error:r}=e;this.status!==t&&(this.state.status=t,this.state.error=r)}get error(){return this.state.error}get messages(){return this.state.messages}get lastMessage(){return this.state.messages[this.state.messages.length-1]}set messages(e){this.state.messages=e}async makeRequest(e){var t,r,a,o;let{trigger:s,metadata:n,headers:i,body:l,messageId:c}=e;this.setStatus({status:"submitted",error:void 0});let u=this.lastMessage,d=!1,p=!1,h=!1;try{let e,t={state:function(e){let{lastMessage:t,messageId:r}=e;return{message:(null==t?void 0:t.role)==="assistant"?t:{id:r,metadata:void 0,role:"assistant",parts:[]},activeTextParts:{},activeReasoningParts:{},partialToolCalls:{}}}({lastMessage:this.state.snapshot(u),messageId:this.generateId()}),abortController:new AbortController};if(t.abortController.signal.addEventListener("abort",()=>{d=!0}),this.activeResponse=t,"resume-stream"===s){let t=await this.transport.reconnectToStream({chatId:this.id,metadata:n,headers:i,body:l});if(null==t)return void this.setStatus({status:"ready"});e=t}else e=await this.transport.sendMessages({chatId:this.id,messages:this.state.messages,abortSignal:t.abortController.signal,metadata:n,headers:i,body:l,trigger:s,messageId:c});let r=e=>this.jobExecutor.run(()=>e({state:t.state,write:()=>{var e;this.setStatus({status:"streaming"}),t.state.message.id===(null==(e=this.lastMessage)?void 0:e.id)?this.state.replaceMessage(this.state.messages.length-1,t.state.message):this.state.pushMessage(t.state.message)}}));await rX({stream:function(e){let{stream:t,messageMetadataSchema:r,dataPartSchemas:a,runUpdateMessageJob:o,onError:s,onToolCall:n,onData:i}=e;return t.pipeThrough(new TransformStream({async transform(e,t){await o(async o=>{var l,c,u,d;let{state:p,write:h}=o;function m(e){let t=p.message.parts.filter(rG).find(t=>t.toolCallId===e);if(null==t)throw new rI({chunkType:"tool-invocation",chunkId:e,message:`No tool invocation found for tool call ID "${e}".`});return t}function g(e){var t;let r=p.message.parts.find(t=>rJ(t)&&t.toolCallId===e.toolCallId);null!=r?(r.state=e.state,r.input=e.input,r.output=e.output,r.errorText=e.errorText,r.rawInput=e.rawInput,r.preliminary=e.preliminary,void 0!==e.title&&(r.title=e.title),r.providerExecuted=null!=(t=e.providerExecuted)?t:r.providerExecuted,null!=e.providerMetadata&&(r.callProviderMetadata=e.providerMetadata)):p.message.parts.push({type:`tool-${e.toolName}`,toolCallId:e.toolCallId,state:e.state,title:e.title,input:e.input,output:e.output,rawInput:e.rawInput,errorText:e.errorText,providerExecuted:e.providerExecuted,preliminary:e.preliminary,...null!=e.providerMetadata?{callProviderMetadata:e.providerMetadata}:{}})}function y(e){var t,r;let a=p.message.parts.find(t=>"dynamic-tool"===t.type&&t.toolCallId===e.toolCallId);null!=a?(a.state=e.state,a.toolName=e.toolName,a.input=e.input,a.output=e.output,a.errorText=e.errorText,a.rawInput=null!=(t=e.rawInput)?t:a.rawInput,a.preliminary=e.preliminary,void 0!==e.title&&(a.title=e.title),a.providerExecuted=null!=(r=e.providerExecuted)?r:a.providerExecuted,null!=e.providerMetadata&&(a.callProviderMetadata=e.providerMetadata)):p.message.parts.push({type:"dynamic-tool",toolName:e.toolName,toolCallId:e.toolCallId,state:e.state,input:e.input,output:e.output,errorText:e.errorText,preliminary:e.preliminary,providerExecuted:e.providerExecuted,title:e.title,...null!=e.providerMetadata?{callProviderMetadata:e.providerMetadata}:{}})}async function f(e){if(null!=e){let t=null!=p.message.metadata?function e(t,r){if(void 0===t&&void 0===r)return;if(void 0===t)return r;if(void 0===r)return t;let a={...t};for(let o in r)if(Object.prototype.hasOwnProperty.call(r,o)){let s=r[o];if(void 0===s)continue;let n=o in t?t[o]:void 0,i=null!==s&&"object"==typeof s&&!Array.isArray(s)&&!(s instanceof Date)&&!(s instanceof RegExp),l=null!=n&&"object"==typeof n&&!Array.isArray(n)&&!(n instanceof Date)&&!(n instanceof RegExp);i&&l?a[o]=e(n,s):a[o]=s}return a}(p.message.metadata,e):e;null!=r&&await t_({value:t,schema:r}),p.message.metadata=t}}switch(e.type){case"text-start":{let t={type:"text",text:"",providerMetadata:e.providerMetadata,state:"streaming"};p.activeTextParts[e.id]=t,p.message.parts.push(t),h();break}case"text-delta":{let t=p.activeTextParts[e.id];if(null==t)throw new rI({chunkType:"text-delta",chunkId:e.id,message:`Received text-delta for missing text part with ID "${e.id}". Ensure a "text-start" chunk is sent before any "text-delta" chunks.`});t.text+=e.delta,t.providerMetadata=null!=(l=e.providerMetadata)?l:t.providerMetadata,h();break}case"text-end":{let t=p.activeTextParts[e.id];if(null==t)throw new rI({chunkType:"text-end",chunkId:e.id,message:`Received text-end for missing text part with ID "${e.id}". Ensure a "text-start" chunk is sent before any "text-end" chunks.`});t.state="done",t.providerMetadata=null!=(c=e.providerMetadata)?c:t.providerMetadata,delete p.activeTextParts[e.id],h();break}case"reasoning-start":{let t={type:"reasoning",text:"",providerMetadata:e.providerMetadata,state:"streaming"};p.activeReasoningParts[e.id]=t,p.message.parts.push(t),h();break}case"reasoning-delta":{let t=p.activeReasoningParts[e.id];if(null==t)throw new rI({chunkType:"reasoning-delta",chunkId:e.id,message:`Received reasoning-delta for missing reasoning part with ID "${e.id}". Ensure a "reasoning-start" chunk is sent before any "reasoning-delta" chunks.`});t.text+=e.delta,t.providerMetadata=null!=(u=e.providerMetadata)?u:t.providerMetadata,h();break}case"reasoning-end":{let t=p.activeReasoningParts[e.id];if(null==t)throw new rI({chunkType:"reasoning-end",chunkId:e.id,message:`Received reasoning-end for missing reasoning part with ID "${e.id}". Ensure a "reasoning-start" chunk is sent before any "reasoning-end" chunks.`});t.providerMetadata=null!=(d=e.providerMetadata)?d:t.providerMetadata,t.state="done",delete p.activeReasoningParts[e.id],h();break}case"file":p.message.parts.push({type:"file",mediaType:e.mediaType,url:e.url}),h();break;case"source-url":p.message.parts.push({type:"source-url",sourceId:e.sourceId,url:e.url,title:e.title,providerMetadata:e.providerMetadata}),h();break;case"source-document":p.message.parts.push({type:"source-document",sourceId:e.sourceId,mediaType:e.mediaType,title:e.title,filename:e.filename,providerMetadata:e.providerMetadata}),h();break;case"tool-input-start":{let t=p.message.parts.filter(rJ);p.partialToolCalls[e.toolCallId]={text:"",toolName:e.toolName,index:t.length,dynamic:e.dynamic,title:e.title},e.dynamic?y({toolCallId:e.toolCallId,toolName:e.toolName,state:"input-streaming",input:void 0,providerExecuted:e.providerExecuted,title:e.title,providerMetadata:e.providerMetadata}):g({toolCallId:e.toolCallId,toolName:e.toolName,state:"input-streaming",input:void 0,providerExecuted:e.providerExecuted,title:e.title,providerMetadata:e.providerMetadata}),h();break}case"tool-input-delta":{let t=p.partialToolCalls[e.toolCallId];if(null==t)throw new rI({chunkType:"tool-input-delta",chunkId:e.toolCallId,message:`Received tool-input-delta for missing tool call with ID "${e.toolCallId}". Ensure a "tool-input-start" chunk is sent before any "tool-input-delta" chunks.`});t.text+=e.inputTextDelta;let{value:r}=await rZ(t.text);t.dynamic?y({toolCallId:e.toolCallId,toolName:t.toolName,state:"input-streaming",input:r,title:t.title}):g({toolCallId:e.toolCallId,toolName:t.toolName,state:"input-streaming",input:r,title:t.title}),h();break}case"tool-input-available":e.dynamic?y({toolCallId:e.toolCallId,toolName:e.toolName,state:"input-available",input:e.input,providerExecuted:e.providerExecuted,providerMetadata:e.providerMetadata,title:e.title}):g({toolCallId:e.toolCallId,toolName:e.toolName,state:"input-available",input:e.input,providerExecuted:e.providerExecuted,providerMetadata:e.providerMetadata,title:e.title}),h(),n&&!e.providerExecuted&&await n({toolCall:e});break;case"tool-input-error":e.dynamic?y({toolCallId:e.toolCallId,toolName:e.toolName,state:"output-error",input:e.input,errorText:e.errorText,providerExecuted:e.providerExecuted,providerMetadata:e.providerMetadata}):g({toolCallId:e.toolCallId,toolName:e.toolName,state:"output-error",input:void 0,rawInput:e.input,errorText:e.errorText,providerExecuted:e.providerExecuted,providerMetadata:e.providerMetadata}),h();break;case"tool-approval-request":{let t=m(e.toolCallId);t.state="approval-requested",t.approval={id:e.approvalId},h();break}case"tool-output-denied":m(e.toolCallId).state="output-denied",h();break;case"tool-output-available":{let t=m(e.toolCallId);"dynamic-tool"===t.type?y({toolCallId:e.toolCallId,toolName:t.toolName,state:"output-available",input:t.input,output:e.output,preliminary:e.preliminary,providerExecuted:e.providerExecuted,title:t.title}):g({toolCallId:e.toolCallId,toolName:rW(t),state:"output-available",input:t.input,output:e.output,providerExecuted:e.providerExecuted,preliminary:e.preliminary,title:t.title}),h();break}case"tool-output-error":{let t=m(e.toolCallId);"dynamic-tool"===t.type?y({toolCallId:e.toolCallId,toolName:t.toolName,state:"output-error",input:t.input,errorText:e.errorText,providerExecuted:e.providerExecuted,title:t.title}):g({toolCallId:e.toolCallId,toolName:rW(t),state:"output-error",input:t.input,rawInput:t.rawInput,errorText:e.errorText,providerExecuted:e.providerExecuted,title:t.title}),h();break}case"start-step":p.message.parts.push({type:"step-start"});break;case"finish-step":p.activeTextParts={},p.activeReasoningParts={};break;case"start":null!=e.messageId&&(p.message.id=e.messageId),await f(e.messageMetadata),(null!=e.messageId||null!=e.messageMetadata)&&h();break;case"finish":null!=e.finishReason&&(p.finishReason=e.finishReason),await f(e.messageMetadata),null!=e.messageMetadata&&h();break;case"message-metadata":await f(e.messageMetadata),null!=e.messageMetadata&&h();break;case"error":null==s||s(Error(e.errorText));break;default:if(e.type.startsWith("data-")){if((null==a?void 0:a[e.type])!=null&&await t_({value:e.data,schema:a[e.type]}),e.transient){null==i||i(e);break}let t=null!=e.id?p.message.parts.find(t=>e.type===t.type&&e.id===t.id):void 0;null!=t?t.data=e.data:p.message.parts.push(e),null==i||i(e),h()}}t.enqueue(e)})}}))}({stream:e,onToolCall:this.onToolCall,onData:this.onData,messageMetadataSchema:this.messageMetadataSchema,dataPartSchemas:this.dataPartSchemas,runUpdateMessageJob:r,onError:e=>{throw e}}),onError:e=>{throw e}}),this.setStatus({status:"ready"})}catch(e){if(d||"AbortError"===e.name)return d=!0,this.setStatus({status:"ready"}),null;h=!0,e instanceof TypeError&&(e.message.toLowerCase().includes("fetch")||e.message.toLowerCase().includes("network"))&&(p=!0),this.onError&&e instanceof Error&&this.onError(e),this.setStatus({status:"error",error:e})}finally{try{null==(r=this.onFinish)||r.call(this,{message:this.activeResponse.state.message,messages:this.state.messages,isAbort:d,isDisconnect:p,isError:h,finishReason:null==(t=this.activeResponse)?void 0:t.state.finishReason})}catch(e){console.error(e)}this.activeResponse=void 0}(null==(a=this.sendAutomaticallyWhen)?void 0:a.call(this,{messages:this.state.messages}))&&!h&&await this.makeRequest({trigger:"submit-message",messageId:null==(o=this.lastMessage)?void 0:o.id,metadata:n,headers:i,body:l})}},r9=e.i(7561030);e.i(850302);var r5=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},r3=(e,t,r)=>(r5(e,t,"read from private field"),r?r.call(e):t.get(e)),r6=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},r8=(e,t,r,a)=>(r5(e,t,"write to private field"),a?a.call(e,r):t.set(e,r),r),r7=class{constructor(e=[]){r6(this,M,void 0),r6(this,R,"ready"),r6(this,j,void 0),r6(this,O,new Set),r6(this,C,new Set),r6(this,P,new Set),this.pushMessage=e=>{r8(this,M,r3(this,M).concat(e)),r3(this,N).call(this)},this.popMessage=()=>{r8(this,M,r3(this,M).slice(0,-1)),r3(this,N).call(this)},this.replaceMessage=(e,t)=>{r8(this,M,[...r3(this,M).slice(0,e),this.snapshot(t),...r3(this,M).slice(e+1)]),r3(this,N).call(this)},this.snapshot=e=>structuredClone(e),this["~registerMessagesCallback"]=(e,t)=>{let r=t?null!=t?(0,r9.default)(e,t):e:e;return r3(this,O).add(r),()=>{r3(this,O).delete(r)}},this["~registerStatusCallback"]=e=>(r3(this,C).add(e),()=>{r3(this,C).delete(e)}),this["~registerErrorCallback"]=e=>(r3(this,P).add(e),()=>{r3(this,P).delete(e)}),r6(this,N,()=>{r3(this,O).forEach(e=>e())}),r6(this,F,()=>{r3(this,C).forEach(e=>e())}),r6(this,D,()=>{r3(this,P).forEach(e=>e())}),r8(this,M,e)}get status(){return r3(this,R)}set status(e){r8(this,R,e),r3(this,F).call(this)}get error(){return r3(this,j)}set error(e){r8(this,j,e),r3(this,D).call(this)}get messages(){return r3(this,M)}set messages(e){r8(this,M,[...e]),r3(this,N).call(this)}};M=new WeakMap,R=new WeakMap,j=new WeakMap,O=new WeakMap,C=new WeakMap,P=new WeakMap,N=new WeakMap,F=new WeakMap,D=new WeakMap;var ae=class extends r4{constructor({messages:e,...t}){const r=new r7(e);super({...t,state:r}),r6(this,z,void 0),this["~registerMessagesCallback"]=(e,t)=>r3(this,z)["~registerMessagesCallback"](e,t),this["~registerStatusCallback"]=e=>r3(this,z)["~registerStatusCallback"](e),this["~registerErrorCallback"]=e=>r3(this,z)["~registerErrorCallback"](e),r8(this,z,r)}};z=new WeakMap,e.s(["useChat",0,function(){let{experimental_throttle:e,resume:t=!1,...r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,ee.useRef)("chat"in r?{}:{onToolCall:r.onToolCall,onData:r.onData,onFinish:r.onFinish,onError:r.onError,sendAutomaticallyWhen:r.sendAutomaticallyWhen});"chat"in r||(a.current={onToolCall:r.onToolCall,onData:r.onData,onFinish:r.onFinish,onError:r.onError,sendAutomaticallyWhen:r.sendAutomaticallyWhen});let o={...r,onToolCall:e=>{var t,r;return null==(r=(t=a.current).onToolCall)?void 0:r.call(t,e)},onData:e=>{var t,r;return null==(r=(t=a.current).onData)?void 0:r.call(t,e)},onFinish:e=>{var t,r;return null==(r=(t=a.current).onFinish)?void 0:r.call(t,e)},onError:e=>{var t,r;return null==(r=(t=a.current).onError)?void 0:r.call(t,e)},sendAutomaticallyWhen:e=>{var t,r,o;return null!=(o=null==(r=(t=a.current).sendAutomaticallyWhen)?void 0:r.call(t,e))&&o}},s=(0,ee.useRef)("chat"in r?r.chat:new ae(o));("chat"in r&&r.chat!==s.current||"id"in r&&s.current.id!==r.id)&&(s.current="chat"in r?r.chat:new ae(o));let n=(0,ee.useCallback)(t=>s.current["~registerMessagesCallback"](t,e),[e,s.current.id]),i=(0,ee.useSyncExternalStore)(n,()=>s.current.messages,()=>s.current.messages),l=(0,ee.useSyncExternalStore)(s.current["~registerStatusCallback"],()=>s.current.status,()=>s.current.status),c=(0,ee.useSyncExternalStore)(s.current["~registerErrorCallback"],()=>s.current.error,()=>s.current.error),u=(0,ee.useCallback)(e=>{"function"==typeof e&&(e=e(s.current.messages)),s.current.messages=e},[s]);return(0,ee.useEffect)(()=>{t&&s.current.resumeStream()},[t,s]),{id:s.current.id,messages:i,setMessages:u,sendMessage:s.current.sendMessage,regenerate:s.current.regenerate,clearError:s.current.clearError,stop:s.current.stop,error:c,resumeStream:s.current.resumeStream,status:l,addToolResult:s.current.addToolOutput,addToolOutput:s.current.addToolOutput,addToolApprovalResponse:s.current.addToolApprovalResponse}}],3820729);var at=e.i(5815093),ar=e.i(9618638),tC=ej,aa=Symbol.for("vercel.ai.gateway.error"),ao=class e extends(U=Error,L=aa,U){constructor({message:e,statusCode:t=500,cause:r,generationId:a}){super(a?`${e} [${a}]`:e),this[L]=!0,this.statusCode=t,this.cause=r,this.generationId=a}static isInstance(t){return e.hasMarker(t)}static hasMarker(e){return"object"==typeof e&&null!==e&&aa in e&&!0===e[aa]}},as="GatewayAuthenticationError",an=Symbol.for(`vercel.ai.gateway.error.${as}`),ai=class e extends(Z=ao,$=an,Z){constructor({message:e="Authentication failed",statusCode:t=401,cause:r,generationId:a}={}){super({message:e,statusCode:t,cause:r,generationId:a}),this[$]=!0,this.name=as,this.type="authentication_error"}static isInstance(e){return ao.hasMarker(e)&&an in e}static createContextualError(t){let{apiKeyProvided:r,oidcTokenProvided:a,message:o="Authentication failed",statusCode:s=401,cause:n,generationId:i}=t;return new e({message:r?`AI Gateway authentication failed: Invalid API key.

Create a new API key: https://vercel.com/d?to=%2F%5Bteam%5D%2F%7E%2Fai%2Fapi-keys

Provide via 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.`:a?`AI Gateway authentication failed: Invalid OIDC token.

Run 'npx vercel link' to link your project, then 'vc env pull' to fetch the token.

Alternatively, use an API key: https://vercel.com/d?to=%2F%5Bteam%5D%2F%7E%2Fai%2Fapi-keys`:`AI Gateway authentication failed: No authentication provided.

Option 1 - API key:
Create an API key: https://vercel.com/d?to=%2F%5Bteam%5D%2F%7E%2Fai%2Fapi-keys
Provide via 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.

Option 2 - OIDC token:
Run 'npx vercel link' to link your project, then 'vc env pull' to fetch the token.`,statusCode:s,cause:n,generationId:i})}},al="GatewayInvalidRequestError",ac=Symbol.for(`vercel.ai.gateway.error.${al}`),au=class extends(V=ao,B=ac,V){constructor({message:e="Invalid request",statusCode:t=400,cause:r,generationId:a}={}){super({message:e,statusCode:t,cause:r,generationId:a}),this[B]=!0,this.name=al,this.type="invalid_request_error"}static isInstance(e){return ao.hasMarker(e)&&ac in e}},ad="GatewayRateLimitError",ap=Symbol.for(`vercel.ai.gateway.error.${ad}`),ah=class extends(K=ao,q=ap,K){constructor({message:e="Rate limit exceeded",statusCode:t=429,cause:r,generationId:a}={}){super({message:e,statusCode:t,cause:r,generationId:a}),this[q]=!0,this.name=ad,this.type="rate_limit_exceeded"}static isInstance(e){return ao.hasMarker(e)&&ap in e}},am="GatewayModelNotFoundError",ag=Symbol.for(`vercel.ai.gateway.error.${am}`),ay=(0,at.lazySchema)(()=>(0,at.zodSchema)(tC.object({modelId:tC.string()}))),af=class extends(Y=ao,H=ag,Y){constructor({message:e="Model not found",statusCode:t=404,modelId:r,cause:a,generationId:o}={}){super({message:e,statusCode:t,cause:a,generationId:o}),this[H]=!0,this.name=am,this.type="model_not_found",this.modelId=r}static isInstance(e){return ao.hasMarker(e)&&ag in e}},av="GatewayInternalServerError",ab=Symbol.for(`vercel.ai.gateway.error.${av}`),aw=class extends(G=ao,J=ab,G){constructor({message:e="Internal server error",statusCode:t=500,cause:r,generationId:a}={}){super({message:e,statusCode:t,cause:r,generationId:a}),this[J]=!0,this.name=av,this.type="internal_server_error"}static isInstance(e){return ao.hasMarker(e)&&ab in e}},aI="GatewayResponseError",aE=Symbol.for(`vercel.ai.gateway.error.${aI}`),a_=class extends(X=ao,W=aE,X){constructor({message:e="Invalid response from Gateway",statusCode:t=502,response:r,validationError:a,cause:o,generationId:s}={}){super({message:e,statusCode:t,cause:o,generationId:s}),this[W]=!0,this.name=aI,this.type="response_error",this.response=r,this.validationError=a}static isInstance(e){return ao.hasMarker(e)&&aE in e}};async function aT(e){var t;let{response:r,statusCode:a,defaultMessage:o="Gateway request failed",cause:s,authMethod:n}=e,i=await (0,at.safeValidateTypes)({value:r,schema:aS});if(!i.success){let e="object"==typeof r&&null!==r&&"generationId"in r?r.generationId:void 0;return new a_({message:`Invalid error response format: ${o}`,statusCode:a,response:r,validationError:i.error,cause:s,generationId:e})}let l=i.value,c=l.error.type,u=l.error.message,d=null!=(t=l.generationId)?t:void 0;switch(c){case"authentication_error":return ai.createContextualError({apiKeyProvided:"api-key"===n,oidcTokenProvided:"oidc"===n,statusCode:a,cause:s,generationId:d});case"invalid_request_error":return new au({message:u,statusCode:a,cause:s,generationId:d});case"rate_limit_exceeded":return new ah({message:u,statusCode:a,cause:s,generationId:d});case"model_not_found":{let e=await (0,at.safeValidateTypes)({value:l.error.param,schema:ay});return new af({message:u,statusCode:a,modelId:e.success?e.value.modelId:void 0,cause:s,generationId:d})}default:return new aw({message:u,statusCode:a,cause:s,generationId:d})}}var aS=(0,at.lazySchema)(()=>(0,at.zodSchema)(tC.object({error:tC.object({message:tC.string(),type:tC.string().nullish(),param:tC.unknown().nullish(),code:tC.union([tC.string(),tC.number()]).nullish()}),generationId:tC.string().nullish()})));function aA(e,t){var r;return ao.isInstance(e)?e:ar.APICallError.isInstance(e)?aT({response:function(e){if(void 0!==e.data)return e.data;if(null!=e.responseBody)try{return JSON.parse(e.responseBody)}catch(t){return e.responseBody}return{}}(e),statusCode:null!=(r=e.statusCode)?r:500,defaultMessage:"Gateway request failed",cause:e,authMethod:t}):aT({response:{},statusCode:500,defaultMessage:e instanceof Error?`Gateway request failed: ${e.message}`:"Unknown Gateway error",cause:e,authMethod:t})}var ax="ai-gateway-auth-method";async function ak(e){let t=await (0,at.safeValidateTypes)({value:e[ax],schema:aM});return t.success?t.value:void 0}var aM=(0,at.lazySchema)(()=>(0,at.zodSchema)(tC.union([tC.literal("api-key"),tC.literal("oidc")]))),aR=class{constructor(e){this.config=e}async getAvailableModels(){try{let{value:e}=await (0,at.getFromApi)({url:`${this.config.baseURL}/config`,headers:await (0,at.resolve)(this.config.headers()),successfulResponseHandler:(0,at.createJsonResponseHandler)(aj),failedResponseHandler:(0,at.createJsonErrorResponseHandler)({errorSchema:tC.any(),errorToMessage:e=>e}),fetch:this.config.fetch});return e}catch(e){throw await aA(e)}}async getCredits(){try{let e=new URL(this.config.baseURL),{value:t}=await (0,at.getFromApi)({url:`${e.origin}/v1/credits`,headers:await (0,at.resolve)(this.config.headers()),successfulResponseHandler:(0,at.createJsonResponseHandler)(aO),failedResponseHandler:(0,at.createJsonErrorResponseHandler)({errorSchema:tC.any(),errorToMessage:e=>e}),fetch:this.config.fetch});return t}catch(e){throw await aA(e)}}},aj=(0,at.lazySchema)(()=>(0,at.zodSchema)(tC.object({models:tC.array(tC.object({id:tC.string(),name:tC.string(),description:tC.string().nullish(),pricing:tC.object({input:tC.string(),output:tC.string(),input_cache_read:tC.string().nullish(),input_cache_write:tC.string().nullish()}).transform(e=>{let{input:t,output:r,input_cache_read:a,input_cache_write:o}=e;return{input:t,output:r,...a?{cachedInputTokens:a}:{},...o?{cacheCreationInputTokens:o}:{}}}).nullish(),specification:tC.object({specificationVersion:tC.literal("v3"),provider:tC.string(),modelId:tC.string()}),modelType:tC.enum(["embedding","image","language","video"]).nullish()}))}))),aO=(0,at.lazySchema)(()=>(0,at.zodSchema)(tC.object({balance:tC.string(),total_used:tC.string()}).transform(e=>{let{balance:t,total_used:r}=e;return{balance:t,totalUsed:r}}))),aC=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v3",this.supportedUrls={"*/*":[/.*/]}}get provider(){return this.config.provider}async getArgs(e){let{abortSignal:t,...r}=e;return{args:this.maybeEncodeFileParts(r),warnings:[]}}async doGenerate(e){let{args:t,warnings:r}=await this.getArgs(e),{abortSignal:a}=e,o=await (0,at.resolve)(this.config.headers());try{let{responseHeaders:s,value:n,rawValue:i}=await (0,at.postJsonToApi)({url:this.getUrl(),headers:(0,at.combineHeaders)(o,e.headers,this.getModelConfigHeaders(this.modelId,!1),await (0,at.resolve)(this.config.o11yHeaders)),body:t,successfulResponseHandler:(0,at.createJsonResponseHandler)(tC.any()),failedResponseHandler:(0,at.createJsonErrorResponseHandler)({errorSchema:tC.any(),errorToMessage:e=>e}),...a&&{abortSignal:a},fetch:this.config.fetch});return{...n,request:{body:t},response:{headers:s,body:i},warnings:r}}catch(e){throw await aA(e,await ak(o))}}async doStream(e){let{args:t,warnings:r}=await this.getArgs(e),{abortSignal:a}=e,o=await (0,at.resolve)(this.config.headers());try{let{value:s,responseHeaders:n}=await (0,at.postJsonToApi)({url:this.getUrl(),headers:(0,at.combineHeaders)(o,e.headers,this.getModelConfigHeaders(this.modelId,!0),await (0,at.resolve)(this.config.o11yHeaders)),body:t,successfulResponseHandler:(0,at.createEventSourceResponseHandler)(tC.any()),failedResponseHandler:(0,at.createJsonErrorResponseHandler)({errorSchema:tC.any(),errorToMessage:e=>e}),...a&&{abortSignal:a},fetch:this.config.fetch});return{stream:s.pipeThrough(new TransformStream({start(e){r.length>0&&e.enqueue({type:"stream-start",warnings:r})},transform(t,r){if(t.success){let a=t.value;("raw"!==a.type||e.includeRawChunks)&&("response-metadata"===a.type&&a.timestamp&&"string"==typeof a.timestamp&&(a.timestamp=new Date(a.timestamp)),r.enqueue(a))}else r.error(t.error)}})),request:{body:t},response:{headers:n}}}catch(e){throw await aA(e,await ak(o))}}isFilePart(e){return e&&"object"==typeof e&&"type"in e&&"file"===e.type}maybeEncodeFileParts(e){for(let t of e.prompt)for(let e of t.content)if(this.isFilePart(e)&&e.data instanceof Uint8Array){let t=Uint8Array.from(e.data),r=er.Buffer.from(t).toString("base64");e.data=new URL(`data:${e.mediaType||"application/octet-stream"};base64,${r}`)}return e}getUrl(){return`${this.config.baseURL}/language-model`}getModelConfigHeaders(e,t){return{"ai-language-model-specification-version":"3","ai-language-model-id":e,"ai-language-model-streaming":String(t)}}},aP=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v3",this.maxEmbeddingsPerCall=2048,this.supportsParallelCalls=!0}get provider(){return this.config.provider}async doEmbed(e){var t;let{values:r,headers:a,abortSignal:o,providerOptions:s}=e,n=await (0,at.resolve)(this.config.headers());try{let{responseHeaders:e,value:i,rawValue:l}=await (0,at.postJsonToApi)({url:this.getUrl(),headers:(0,at.combineHeaders)(n,null!=a?a:{},this.getModelConfigHeaders(),await (0,at.resolve)(this.config.o11yHeaders)),body:{values:r,...s?{providerOptions:s}:{}},successfulResponseHandler:(0,at.createJsonResponseHandler)(aN),failedResponseHandler:(0,at.createJsonErrorResponseHandler)({errorSchema:tC.any(),errorToMessage:e=>e}),...o&&{abortSignal:o},fetch:this.config.fetch});return{embeddings:i.embeddings,usage:null!=(t=i.usage)?t:void 0,providerMetadata:i.providerMetadata,response:{headers:e,body:l},warnings:[]}}catch(e){throw await aA(e,await ak(n))}}getUrl(){return`${this.config.baseURL}/embedding-model`}getModelConfigHeaders(){return{"ai-embedding-model-specification-version":"3","ai-model-id":this.modelId}}},aN=(0,at.lazySchema)(()=>(0,at.zodSchema)(tC.object({embeddings:tC.array(tC.array(tC.number())),usage:tC.object({tokens:tC.number()}).nullish(),providerMetadata:tC.record(tC.string(),tC.record(tC.string(),tC.unknown())).optional()}))),aF=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v3",this.maxImagesPerCall=Number.MAX_SAFE_INTEGER}get provider(){return this.config.provider}async doGenerate(e){var t;let{prompt:r,n:a,size:o,aspectRatio:s,seed:n,files:i,mask:l,providerOptions:c,headers:u,abortSignal:d}=e,p=await (0,at.resolve)(this.config.headers());try{let{responseHeaders:e,value:h,rawValue:m}=await (0,at.postJsonToApi)({url:this.getUrl(),headers:(0,at.combineHeaders)(p,null!=u?u:{},this.getModelConfigHeaders(),await (0,at.resolve)(this.config.o11yHeaders)),body:{prompt:r,n:a,...o&&{size:o},...s&&{aspectRatio:s},...n&&{seed:n},...c&&{providerOptions:c},...i&&{files:i.map(e=>aD(e))},...l&&{mask:aD(l)}},successfulResponseHandler:(0,at.createJsonResponseHandler)(aL),failedResponseHandler:(0,at.createJsonErrorResponseHandler)({errorSchema:tC.any(),errorToMessage:e=>e}),...d&&{abortSignal:d},fetch:this.config.fetch});return{images:h.images,warnings:null!=(t=h.warnings)?t:[],providerMetadata:h.providerMetadata,response:{timestamp:new Date,modelId:this.modelId,headers:e}}}catch(e){throw aA(e,await ak(p))}}getUrl(){return`${this.config.baseURL}/image-model`}getModelConfigHeaders(){return{"ai-image-model-specification-version":"3","ai-model-id":this.modelId}}};function aD(e){return"file"===e.type&&e.data instanceof Uint8Array?{...e,data:(0,at.convertUint8ArrayToBase64)(e.data)}:e}var az=tC.object({images:tC.array(tC.unknown()).optional()}).catchall(tC.unknown()),aL=tC.object({images:tC.array(tC.string()),warnings:tC.array(tC.object({type:tC.literal("other"),message:tC.string()})).optional(),providerMetadata:tC.record(tC.string(),az).optional()}),aU=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v3",this.maxVideosPerCall=Number.MAX_SAFE_INTEGER}get provider(){return this.config.provider}async doGenerate(e){var t,r;let{prompt:a,n:o,aspectRatio:s,resolution:n,duration:i,fps:l,seed:c,image:u,providerOptions:d,headers:p,abortSignal:h}=e,m=await (0,at.resolve)(this.config.headers());try{let{responseHeaders:e,value:g,rawValue:y}=await (0,at.postJsonToApi)({url:this.getUrl(),headers:(0,at.combineHeaders)(m,null!=p?p:{},this.getModelConfigHeaders(),await (0,at.resolve)(this.config.o11yHeaders)),body:{prompt:a,n:o,...s&&{aspectRatio:s},...n&&{resolution:n},...i&&{duration:i},...l&&{fps:l},...c&&{seed:c},...d&&{providerOptions:d},...u&&{image:(r=u,"file"===r.type&&r.data instanceof Uint8Array?{...r,data:(0,at.convertUint8ArrayToBase64)(r.data)}:r)}},successfulResponseHandler:(0,at.createJsonResponseHandler)(aB),failedResponseHandler:(0,at.createJsonErrorResponseHandler)({errorSchema:tC.any(),errorToMessage:e=>e}),...h&&{abortSignal:h},fetch:this.config.fetch});return{videos:g.videos,warnings:null!=(t=g.warnings)?t:[],providerMetadata:g.providerMetadata,response:{timestamp:new Date,modelId:this.modelId,headers:e}}}catch(e){throw aA(e,await ak(m))}}getUrl(){return`${this.config.baseURL}/video-model`}getModelConfigHeaders(){return{"ai-video-model-specification-version":"3","ai-model-id":this.modelId}}},a$=tC.object({videos:tC.array(tC.unknown()).optional()}).catchall(tC.unknown()),aZ=tC.union([tC.object({type:tC.literal("url"),url:tC.string(),mediaType:tC.string()}),tC.object({type:tC.literal("base64"),data:tC.string(),mediaType:tC.string()})]),aB=tC.object({videos:tC.array(aZ),warnings:tC.array(tC.object({type:tC.literal("other"),message:tC.string()})).optional(),providerMetadata:tC.record(tC.string(),a$).optional()}),aV=(0,at.lazySchema)(()=>(0,at.zodSchema)(tP.z.object({objective:tP.z.string().describe("Natural-language description of the web research goal, including source or freshness guidance and broader context from the task. Maximum 5000 characters."),search_queries:tP.z.array(tP.z.string()).optional().describe("Optional search queries to supplement the objective. Maximum 200 characters per query."),mode:tP.z.enum(["one-shot","agentic"]).optional().describe('Mode preset: "one-shot" for comprehensive results with longer excerpts (default), "agentic" for concise, token-efficient results for multi-step workflows.'),max_results:tP.z.number().optional().describe("Maximum number of results to return (1-20). Defaults to 10 if not specified."),source_policy:tP.z.object({include_domains:tP.z.array(tP.z.string()).optional().describe("List of domains to include in search results."),exclude_domains:tP.z.array(tP.z.string()).optional().describe("List of domains to exclude from search results."),after_date:tP.z.string().optional().describe("Only include results published after this date (ISO 8601 format).")}).optional().describe("Source policy for controlling which domains to include/exclude and freshness."),excerpts:tP.z.object({max_chars_per_result:tP.z.number().optional().describe("Maximum characters per result."),max_chars_total:tP.z.number().optional().describe("Maximum total characters across all results.")}).optional().describe("Excerpt configuration for controlling result length."),fetch_policy:tP.z.object({max_age_seconds:tP.z.number().optional().describe("Maximum age in seconds for cached content. Set to 0 to always fetch fresh content.")}).optional().describe("Fetch policy for controlling content freshness.")}))),aq=(0,at.lazySchema)(()=>(0,at.zodSchema)(tP.z.union([tP.z.object({searchId:tP.z.string(),results:tP.z.array(tP.z.object({url:tP.z.string(),title:tP.z.string(),excerpt:tP.z.string(),publishDate:tP.z.string().nullable().optional(),relevanceScore:tP.z.number().optional()}))}),tP.z.object({error:tP.z.enum(["api_error","rate_limit","timeout","invalid_input","configuration_error","unknown"]),statusCode:tP.z.number().optional(),message:tP.z.string()})]))),aK=(0,at.createProviderToolFactoryWithOutputSchema)({id:"gateway.parallel_search",inputSchema:aV,outputSchema:aq}),aH=(0,at.lazySchema)(()=>(0,at.zodSchema)(tP.z.object({query:tP.z.union([tP.z.string(),tP.z.array(tP.z.string())]).describe("Search query (string) or multiple queries (array of up to 5 strings). Multi-query searches return combined results from all queries."),max_results:tP.z.number().optional().describe("Maximum number of search results to return (1-20, default: 10)"),max_tokens_per_page:tP.z.number().optional().describe("Maximum number of tokens to extract per search result page (256-2048, default: 2048)"),max_tokens:tP.z.number().optional().describe("Maximum total tokens across all search results (default: 25000, max: 1000000)"),country:tP.z.string().optional().describe("Two-letter ISO 3166-1 alpha-2 country code for regional search results (e.g., 'US', 'GB', 'FR')"),search_domain_filter:tP.z.array(tP.z.string()).optional().describe("List of domains to include or exclude from search results (max 20). To include: ['nature.com', 'science.org']. To exclude: ['-example.com', '-spam.net']"),search_language_filter:tP.z.array(tP.z.string()).optional().describe("List of ISO 639-1 language codes to filter results (max 10, lowercase). Examples: ['en', 'fr', 'de']"),search_after_date:tP.z.string().optional().describe("Include only results published after this date. Format: 'MM/DD/YYYY' (e.g., '3/1/2025'). Cannot be used with search_recency_filter."),search_before_date:tP.z.string().optional().describe("Include only results published before this date. Format: 'MM/DD/YYYY' (e.g., '3/15/2025'). Cannot be used with search_recency_filter."),last_updated_after_filter:tP.z.string().optional().describe("Include only results last updated after this date. Format: 'MM/DD/YYYY' (e.g., '3/1/2025'). Cannot be used with search_recency_filter."),last_updated_before_filter:tP.z.string().optional().describe("Include only results last updated before this date. Format: 'MM/DD/YYYY' (e.g., '3/15/2025'). Cannot be used with search_recency_filter."),search_recency_filter:tP.z.enum(["day","week","month","year"]).optional().describe("Filter results by relative time period. Cannot be used with search_after_date or search_before_date.")}))),aY=(0,at.lazySchema)(()=>(0,at.zodSchema)(tP.z.union([tP.z.object({results:tP.z.array(tP.z.object({title:tP.z.string(),url:tP.z.string(),snippet:tP.z.string(),date:tP.z.string().optional(),lastUpdated:tP.z.string().optional()})),id:tP.z.string()}),tP.z.object({error:tP.z.enum(["api_error","rate_limit","timeout","invalid_input","unknown"]),statusCode:tP.z.number().optional(),message:tP.z.string()})]))),aJ=(0,at.createProviderToolFactoryWithOutputSchema)({id:"gateway.perplexity_search",inputSchema:aH,outputSchema:aY}),aG={parallelSearch:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return aK(e)},perplexitySearch:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return aJ(e)}};async function aW(){var e;return null==(e=(0,tN.getContext)().headers)?void 0:e["x-vercel-id"]}async function aX(e){let t=(0,at.loadOptionalSetting)({settingValue:e.apiKey,environmentVariableName:"AI_GATEWAY_API_KEY"});return t?{token:t,authMethod:"api-key"}:{token:await (0,tN.getVercelOidcToken)(),authMethod:"oidc"}}!function(){var e,t;let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=null,o=null,s=null!=(e=r.metadataCacheRefreshMillis)?e:3e5,n=0,i=null!=(t=(0,at.withoutTrailingSlash)(r.baseURL))?t:"https://ai-gateway.vercel.sh/v3/ai",l=async()=>{try{let e=await aX(r);return(0,at.withUserAgentSuffix)({Authorization:`Bearer ${e.token}`,"ai-gateway-protocol-version":"0.0.1",[ax]:e.authMethod,...r.headers},"ai-sdk/gateway/3.0.36")}catch(e){throw ai.createContextualError({apiKeyProvided:!1,oidcTokenProvided:!1,statusCode:401,cause:e})}},c=()=>{let e=(0,at.loadOptionalSetting)({settingValue:void 0,environmentVariableName:"VERCEL_DEPLOYMENT_ID"}),t=(0,at.loadOptionalSetting)({settingValue:void 0,environmentVariableName:"VERCEL_ENV"}),r=(0,at.loadOptionalSetting)({settingValue:void 0,environmentVariableName:"VERCEL_REGION"});return async()=>{let a=await aW();return{...e&&{"ai-o11y-deployment-id":e},...t&&{"ai-o11y-environment":t},...r&&{"ai-o11y-region":r},...a&&{"ai-o11y-request-id":a}}}},u=e=>new aC(e,{provider:"gateway",baseURL:i,headers:l,fetch:r.fetch,o11yHeaders:c()}),d=async()=>{var e,t,c;let u=null!=(c=null==(t=null==(e=r._internal)?void 0:e.currentDate)?void 0:t.call(e).getTime())?c:Date.now();return(!a||u-n>s)&&(n=u,a=new aR({baseURL:i,headers:l,fetch:r.fetch}).getAvailableModels().then(e=>(o=e,e)).catch(async e=>{throw await aA(e,await ak(await l()))})),o?Promise.resolve(o):a},p=async()=>new aR({baseURL:i,headers:l,fetch:r.fetch}).getCredits().catch(async e=>{throw await aA(e,await ak(await l()))}),h=function(e){if(new.target)throw Error("The Gateway Provider model function cannot be called with the new keyword.");return u(e)};h.specificationVersion="v3",h.getAvailableModels=d,h.getCredits=p,h.imageModel=e=>new aF(e,{provider:"gateway",baseURL:i,headers:l,fetch:r.fetch,o11yHeaders:c()}),h.languageModel=u;let m=e=>new aP(e,{provider:"gateway",baseURL:i,headers:l,fetch:r.fetch,o11yHeaders:c()});h.embeddingModel=m,h.textEmbeddingModel=m,h.videoModel=e=>new aU(e,{provider:"gateway",baseURL:i,headers:l,fetch:r.fetch,o11yHeaders:c()}),h.chat=h.languageModel,h.embedding=h.embeddingModel,h.image=h.imageModel,h.video=h.videoModel,h.tools=aG}();var aQ=ar,tC=ej,a0=Object.defineProperty,a1=Symbol.for("vercel.ai.error.AI_InvalidArgumentError");aQ.AISDKError;Symbol.for("vercel.ai.error.AI_InvalidStreamPartError");aQ.AISDKError;Symbol.for("vercel.ai.error.AI_InvalidToolApprovalError");aQ.AISDKError;Symbol.for("vercel.ai.error.AI_InvalidToolInputError");aQ.AISDKError;Symbol.for("vercel.ai.error.AI_ToolCallNotFoundForApprovalError");aQ.AISDKError;Symbol.for("vercel.ai.error.AI_MissingToolResultsError");aQ.AISDKError;Symbol.for("vercel.ai.error.AI_NoImageGeneratedError");aQ.AISDKError;var a2="AI_NoObjectGeneratedError",a4=`vercel.ai.error.${a2}`,a9=Symbol.for(a4),a5=class extends aQ.AISDKError{constructor({message:e="No object generated.",cause:t,text:r,response:a,usage:o,finishReason:s}){super({name:a2,message:e,cause:t}),this[Q]=!0,this.text=r,this.response=a,this.usage=o,this.finishReason=s}static isInstance(e){return aQ.AISDKError.hasMarker(e,a4)}};Q=a9;Symbol.for("vercel.ai.error.AI_NoOutputGeneratedError");aQ.AISDKError;Symbol.for("vercel.ai.error.AI_NoSpeechGeneratedError");aQ.AISDKError;Symbol.for("vercel.ai.error.AI_NoTranscriptGeneratedError");aQ.AISDKError;Symbol.for("vercel.ai.error.AI_NoVideoGeneratedError");aQ.AISDKError;Symbol.for("vercel.ai.error.AI_NoSuchToolError");aQ.AISDKError;Symbol.for("vercel.ai.error.AI_ToolCallRepairError");aQ.AISDKError,aQ.AISDKError;Symbol.for("vercel.ai.error.AI_UIMessageStreamError");aQ.AISDKError;Symbol.for("vercel.ai.error.AI_InvalidDataContentError");aQ.AISDKError;Symbol.for("vercel.ai.error.AI_InvalidMessageRoleError");aQ.AISDKError;Symbol.for("vercel.ai.error.AI_MessageConversionError");aQ.AISDKError;Symbol.for("vercel.ai.error.AI_RetryError");aQ.AISDKError;var a3="6.0.73",a6=tC.union([tC.string(),tC.instanceof(Uint8Array),tC.instanceof(ArrayBuffer),tC.custom(e=>{var t,r;return null!=(r=null==(t=globalThis.Buffer)?void 0:t.isBuffer(e))&&r},{message:"Must be a Buffer"})]),a8=tC.lazy(()=>tC.union([tC.null(),tC.string(),tC.number(),tC.boolean(),tC.record(tC.string(),a8.optional()),tC.array(a8)])),a7=tC.record(tC.string(),tC.record(tC.string(),a8.optional())),oe=tC.object({type:tC.literal("text"),text:tC.string(),providerOptions:a7.optional()}),ot=tC.object({type:tC.literal("image"),image:tC.union([a6,tC.instanceof(URL)]),mediaType:tC.string().optional(),providerOptions:a7.optional()}),or=tC.object({type:tC.literal("file"),data:tC.union([a6,tC.instanceof(URL)]),filename:tC.string().optional(),mediaType:tC.string(),providerOptions:a7.optional()}),oa=tC.object({type:tC.literal("reasoning"),text:tC.string(),providerOptions:a7.optional()}),oo=tC.object({type:tC.literal("tool-call"),toolCallId:tC.string(),toolName:tC.string(),input:tC.unknown(),providerOptions:a7.optional(),providerExecuted:tC.boolean().optional()}),os=tC.discriminatedUnion("type",[tC.object({type:tC.literal("text"),value:tC.string(),providerOptions:a7.optional()}),tC.object({type:tC.literal("json"),value:a8,providerOptions:a7.optional()}),tC.object({type:tC.literal("execution-denied"),reason:tC.string().optional(),providerOptions:a7.optional()}),tC.object({type:tC.literal("error-text"),value:tC.string(),providerOptions:a7.optional()}),tC.object({type:tC.literal("error-json"),value:a8,providerOptions:a7.optional()}),tC.object({type:tC.literal("content"),value:tC.array(tC.union([tC.object({type:tC.literal("text"),text:tC.string(),providerOptions:a7.optional()}),tC.object({type:tC.literal("media"),data:tC.string(),mediaType:tC.string()}),tC.object({type:tC.literal("file-data"),data:tC.string(),mediaType:tC.string(),filename:tC.string().optional(),providerOptions:a7.optional()}),tC.object({type:tC.literal("file-url"),url:tC.string(),providerOptions:a7.optional()}),tC.object({type:tC.literal("file-id"),fileId:tC.union([tC.string(),tC.record(tC.string(),tC.string())]),providerOptions:a7.optional()}),tC.object({type:tC.literal("image-data"),data:tC.string(),mediaType:tC.string(),providerOptions:a7.optional()}),tC.object({type:tC.literal("image-url"),url:tC.string(),providerOptions:a7.optional()}),tC.object({type:tC.literal("image-file-id"),fileId:tC.union([tC.string(),tC.record(tC.string(),tC.string())]),providerOptions:a7.optional()}),tC.object({type:tC.literal("custom"),providerOptions:a7.optional()})]))})]),on=tC.object({type:tC.literal("tool-result"),toolCallId:tC.string(),toolName:tC.string(),output:os,providerOptions:a7.optional()}),oi=tC.object({type:tC.literal("tool-approval-request"),approvalId:tC.string(),toolCallId:tC.string()}),ol=tC.object({type:tC.literal("tool-approval-response"),approvalId:tC.string(),approved:tC.boolean(),reason:tC.string().optional()}),oc=tC.object({role:tC.literal("system"),content:tC.string(),providerOptions:a7.optional()}),ou=tC.object({role:tC.literal("user"),content:tC.union([tC.string(),tC.array(tC.union([oe,ot,or]))]),providerOptions:a7.optional()}),od=tC.object({role:tC.literal("assistant"),content:tC.union([tC.string(),tC.array(tC.union([oe,or,oa,oo,on,oi]))]),providerOptions:a7.optional()}),op=tC.object({role:tC.literal("tool"),content:tC.array(tC.union([on,ol])),providerOptions:a7.optional()});tC.union([oc,ou,od,op]);var oh={},om={array:()=>ob,choice:()=>ow,json:()=>oI,object:()=>ov,text:()=>of};for(var og in om)a0(oh,og,{get:om[og],enumerable:!0});async function oy(e){if(void 0===e)return{value:void 0,state:"undefined-input"};let t=await (0,at.safeParseJSON)({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=await (0,at.safeParseJSON)({text:function(e){let t=["ROOT"],r=-1,a=null;function o(e,o,s){switch(e){case'"':r=o,t.pop(),t.push(s),t.push("INSIDE_STRING");break;case"f":case"t":case"n":r=o,a=o,t.pop(),t.push(s),t.push("INSIDE_LITERAL");break;case"-":t.pop(),t.push(s),t.push("INSIDE_NUMBER");break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":r=o,t.pop(),t.push(s),t.push("INSIDE_NUMBER");break;case"{":r=o,t.pop(),t.push(s),t.push("INSIDE_OBJECT_START");break;case"[":r=o,t.pop(),t.push(s),t.push("INSIDE_ARRAY_START")}}function s(e,a){switch(e){case",":t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break;case"}":r=a,t.pop()}}function n(e,a){switch(e){case",":t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":r=a,t.pop()}}for(let i=0;i<e.length;i++){let l=e[i];switch(t[t.length-1]){case"ROOT":o(l,i,"FINISH");break;case"INSIDE_OBJECT_START":switch(l){case'"':t.pop(),t.push("INSIDE_OBJECT_KEY");break;case"}":r=i,t.pop()}break;case"INSIDE_OBJECT_AFTER_COMMA":'"'===l&&(t.pop(),t.push("INSIDE_OBJECT_KEY"));break;case"INSIDE_OBJECT_KEY":'"'===l&&(t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY"));break;case"INSIDE_OBJECT_AFTER_KEY":":"===l&&(t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE"));break;case"INSIDE_OBJECT_BEFORE_VALUE":o(l,i,"INSIDE_OBJECT_AFTER_VALUE");break;case"INSIDE_OBJECT_AFTER_VALUE":s(l,i);break;case"INSIDE_STRING":switch(l){case'"':t.pop(),r=i;break;case"\\":t.push("INSIDE_STRING_ESCAPE");break;default:r=i}break;case"INSIDE_ARRAY_START":"]"===l?(r=i,t.pop()):(r=i,o(l,i,"INSIDE_ARRAY_AFTER_VALUE"));break;case"INSIDE_ARRAY_AFTER_VALUE":switch(l){case",":t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":r=i,t.pop();break;default:r=i}break;case"INSIDE_ARRAY_AFTER_COMMA":o(l,i,"INSIDE_ARRAY_AFTER_VALUE");break;case"INSIDE_STRING_ESCAPE":t.pop(),r=i;break;case"INSIDE_NUMBER":switch(l){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":r=i;break;case"e":case"E":case"-":case".":break;case",":t.pop(),"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&n(l,i),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]&&s(l,i);break;case"}":t.pop(),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]&&s(l,i);break;case"]":t.pop(),"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&n(l,i);break;default:t.pop()}break;case"INSIDE_LITERAL":{let o=e.substring(a,i+1);"false".startsWith(o)||"true".startsWith(o)||"null".startsWith(o)?r=i:(t.pop(),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]?s(l,i):"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&n(l,i))}}}let i=e.slice(0,r+1);for(let r=t.length-1;r>=0;r--)switch(t[r]){case"INSIDE_STRING":i+='"';break;case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":i+="}";break;case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":i+="]";break;case"INSIDE_LITERAL":{let t=e.substring(a,e.length);"true".startsWith(t)?i+="true".slice(t.length):"false".startsWith(t)?i+="false".slice(t.length):"null".startsWith(t)&&(i+="null".slice(t.length))}}return i}(e)})).success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"}}var of=()=>({name:"text",responseFormat:Promise.resolve({type:"text"}),async parseCompleteOutput(e){let{text:t}=e;return t},async parsePartialOutput(e){let{text:t}=e;return{partial:t}},createElementStreamTransform(){}}),ov=e=>{let{schema:t,name:r,description:a}=e,o=(0,at.asSchema)(t);return{name:"object",responseFormat:(0,at.resolve)(o.jsonSchema).then(e=>({type:"json",schema:e,...null!=r&&{name:r},...null!=a&&{description:a}})),async parseCompleteOutput(e,t){let{text:r}=e,a=await (0,at.safeParseJSON)({text:r});if(!a.success)throw new a5({message:"No object generated: could not parse the response.",cause:a.error,text:r,response:t.response,usage:t.usage,finishReason:t.finishReason});let s=await (0,at.safeValidateTypes)({value:a.value,schema:o});if(!s.success)throw new a5({message:"No object generated: response did not match schema.",cause:s.error,text:r,response:t.response,usage:t.usage,finishReason:t.finishReason});return s.value},async parsePartialOutput(e){let{text:t}=e,r=await oy(t);switch(r.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return{partial:r.value}}},createElementStreamTransform(){}}},ob=e=>{let{element:t,name:r,description:a}=e,o=(0,at.asSchema)(t);return{name:"array",responseFormat:(0,at.resolve)(o.jsonSchema).then(e=>{let{$schema:t,...o}=e;return{type:"json",schema:{$schema:"http://json-schema.org/draft-07/schema#",type:"object",properties:{elements:{type:"array",items:o}},required:["elements"],additionalProperties:!1},...null!=r&&{name:r},...null!=a&&{description:a}}}),async parseCompleteOutput(e,t){let{text:r}=e,a=await (0,at.safeParseJSON)({text:r});if(!a.success)throw new a5({message:"No object generated: could not parse the response.",cause:a.error,text:r,response:t.response,usage:t.usage,finishReason:t.finishReason});let s=a.value;if(null==s||"object"!=typeof s||!("elements"in s)||!Array.isArray(s.elements))throw new a5({message:"No object generated: response did not match schema.",cause:new aQ.TypeValidationError({value:s,cause:"response must be an object with an elements array"}),text:r,response:t.response,usage:t.usage,finishReason:t.finishReason});for(let e of s.elements){let a=await (0,at.safeValidateTypes)({value:e,schema:o});if(!a.success)throw new a5({message:"No object generated: response did not match schema.",cause:a.error,text:r,response:t.response,usage:t.usage,finishReason:t.finishReason})}return s.elements},async parsePartialOutput(e){let{text:t}=e,r=await oy(t);switch(r.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":{let e=r.value;if(null==e||"object"!=typeof e||!("elements"in e)||!Array.isArray(e.elements))return;let t="repaired-parse"===r.state&&e.elements.length>0?e.elements.slice(0,-1):e.elements,a=[];for(let e of t){let t=await (0,at.safeValidateTypes)({value:e,schema:o});t.success&&a.push(t.value)}return{partial:a}}}},createElementStreamTransform(){let e=0;return new TransformStream({transform(t,r){let{partialOutput:a}=t;if(null!=a)for(;e<a.length;e++)r.enqueue(a[e])}})}}},ow=e=>{let{options:t,name:r,description:a}=e;return{name:"choice",responseFormat:Promise.resolve({type:"json",schema:{$schema:"http://json-schema.org/draft-07/schema#",type:"object",properties:{result:{type:"string",enum:t}},required:["result"],additionalProperties:!1},...null!=r&&{name:r},...null!=a&&{description:a}}),async parseCompleteOutput(e,r){let{text:a}=e,o=await (0,at.safeParseJSON)({text:a});if(!o.success)throw new a5({message:"No object generated: could not parse the response.",cause:o.error,text:a,response:r.response,usage:r.usage,finishReason:r.finishReason});let s=o.value;if(null==s||"object"!=typeof s||!("result"in s)||"string"!=typeof s.result||!t.includes(s.result))throw new a5({message:"No object generated: response did not match schema.",cause:new aQ.TypeValidationError({value:s,cause:"response must be an object that contains a choice value."}),text:a,response:r.response,usage:r.usage,finishReason:r.finishReason});return s.result},async parsePartialOutput(e){let{text:r}=e,a=await oy(r);switch(a.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":{let e=a.value;if(null==e||"object"!=typeof e||!("result"in e)||"string"!=typeof e.result)return;let r=t.filter(t=>t.startsWith(e.result));if("successful-parse"===a.state)return r.includes(e.result)?{partial:e.result}:void 0;return 1===r.length?{partial:r[0]}:void 0}}},createElementStreamTransform(){}}},oI=function(){let{name:e,description:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{name:"json",responseFormat:Promise.resolve({type:"json",...null!=e&&{name:e},...null!=t&&{description:t}}),async parseCompleteOutput(e,t){let{text:r}=e,a=await (0,at.safeParseJSON)({text:r});if(!a.success)throw new a5({message:"No object generated: could not parse the response.",cause:a.error,text:r,response:t.response,usage:t.usage,finishReason:t.finishReason});return a.value},async parsePartialOutput(e){let{text:t}=e,r=await oy(t);switch(r.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return void 0===r.value?void 0:{partial:r.value}}},createElementStreamTransform(){}}};(0,at.createIdGenerator)({prefix:"aitxt",size:24}),TransformStream;var oE=(0,at.lazySchema)(()=>(0,at.zodSchema)(tC.union([tC.strictObject({type:tC.literal("text-start"),id:tC.string(),providerMetadata:a7.optional()}),tC.strictObject({type:tC.literal("text-delta"),id:tC.string(),delta:tC.string(),providerMetadata:a7.optional()}),tC.strictObject({type:tC.literal("text-end"),id:tC.string(),providerMetadata:a7.optional()}),tC.strictObject({type:tC.literal("error"),errorText:tC.string()}),tC.strictObject({type:tC.literal("tool-input-start"),toolCallId:tC.string(),toolName:tC.string(),providerExecuted:tC.boolean().optional(),providerMetadata:a7.optional(),dynamic:tC.boolean().optional(),title:tC.string().optional()}),tC.strictObject({type:tC.literal("tool-input-delta"),toolCallId:tC.string(),inputTextDelta:tC.string()}),tC.strictObject({type:tC.literal("tool-input-available"),toolCallId:tC.string(),toolName:tC.string(),input:tC.unknown(),providerExecuted:tC.boolean().optional(),providerMetadata:a7.optional(),dynamic:tC.boolean().optional(),title:tC.string().optional()}),tC.strictObject({type:tC.literal("tool-input-error"),toolCallId:tC.string(),toolName:tC.string(),input:tC.unknown(),providerExecuted:tC.boolean().optional(),providerMetadata:a7.optional(),dynamic:tC.boolean().optional(),errorText:tC.string(),title:tC.string().optional()}),tC.strictObject({type:tC.literal("tool-approval-request"),approvalId:tC.string(),toolCallId:tC.string()}),tC.strictObject({type:tC.literal("tool-output-available"),toolCallId:tC.string(),output:tC.unknown(),providerExecuted:tC.boolean().optional(),dynamic:tC.boolean().optional(),preliminary:tC.boolean().optional()}),tC.strictObject({type:tC.literal("tool-output-error"),toolCallId:tC.string(),errorText:tC.string(),providerExecuted:tC.boolean().optional(),dynamic:tC.boolean().optional()}),tC.strictObject({type:tC.literal("tool-output-denied"),toolCallId:tC.string()}),tC.strictObject({type:tC.literal("reasoning-start"),id:tC.string(),providerMetadata:a7.optional()}),tC.strictObject({type:tC.literal("reasoning-delta"),id:tC.string(),delta:tC.string(),providerMetadata:a7.optional()}),tC.strictObject({type:tC.literal("reasoning-end"),id:tC.string(),providerMetadata:a7.optional()}),tC.strictObject({type:tC.literal("source-url"),sourceId:tC.string(),url:tC.string(),title:tC.string().optional(),providerMetadata:a7.optional()}),tC.strictObject({type:tC.literal("source-document"),sourceId:tC.string(),mediaType:tC.string(),title:tC.string(),filename:tC.string().optional(),providerMetadata:a7.optional()}),tC.strictObject({type:tC.literal("file"),url:tC.string(),mediaType:tC.string(),providerMetadata:a7.optional()}),tC.strictObject({type:tC.custom(e=>"string"==typeof e&&e.startsWith("data-"),{message:'Type must start with "data-"'}),id:tC.string().optional(),data:tC.unknown(),transient:tC.boolean().optional()}),tC.strictObject({type:tC.literal("start-step")}),tC.strictObject({type:tC.literal("finish-step")}),tC.strictObject({type:tC.literal("start"),messageId:tC.string().optional(),messageMetadata:tC.unknown().optional()}),tC.strictObject({type:tC.literal("finish"),finishReason:tC.enum(["stop","length","content-filter","tool-calls","error","other"]).optional(),messageMetadata:tC.unknown().optional()}),tC.strictObject({type:tC.literal("abort"),reason:tC.string().optional()}),tC.strictObject({type:tC.literal("message-metadata"),messageMetadata:tC.unknown()})])));function o_(e){return"dynamic-tool"===e.type}function oT(e){return e.type.startsWith("tool-")||o_(e)}(0,at.createIdGenerator)({prefix:"aitxt",size:24}),(0,at.lazySchema)(()=>(0,at.zodSchema)(tC.array(tC.object({id:tC.string(),role:tC.enum(["system","user","assistant"]),metadata:tC.unknown().optional(),parts:tC.array(tC.union([tC.object({type:tC.literal("text"),text:tC.string(),state:tC.enum(["streaming","done"]).optional(),providerMetadata:a7.optional()}),tC.object({type:tC.literal("reasoning"),text:tC.string(),state:tC.enum(["streaming","done"]).optional(),providerMetadata:a7.optional()}),tC.object({type:tC.literal("source-url"),sourceId:tC.string(),url:tC.string(),title:tC.string().optional(),providerMetadata:a7.optional()}),tC.object({type:tC.literal("source-document"),sourceId:tC.string(),mediaType:tC.string(),title:tC.string(),filename:tC.string().optional(),providerMetadata:a7.optional()}),tC.object({type:tC.literal("file"),mediaType:tC.string(),filename:tC.string().optional(),url:tC.string(),providerMetadata:a7.optional()}),tC.object({type:tC.literal("step-start")}),tC.object({type:tC.string().startsWith("data-"),id:tC.string().optional(),data:tC.unknown()}),tC.object({type:tC.literal("dynamic-tool"),toolName:tC.string(),toolCallId:tC.string(),state:tC.literal("input-streaming"),input:tC.unknown().optional(),providerExecuted:tC.boolean().optional(),callProviderMetadata:a7.optional(),output:tC.never().optional(),errorText:tC.never().optional(),approval:tC.never().optional()}),tC.object({type:tC.literal("dynamic-tool"),toolName:tC.string(),toolCallId:tC.string(),state:tC.literal("input-available"),input:tC.unknown(),providerExecuted:tC.boolean().optional(),output:tC.never().optional(),errorText:tC.never().optional(),callProviderMetadata:a7.optional(),approval:tC.never().optional()}),tC.object({type:tC.literal("dynamic-tool"),toolName:tC.string(),toolCallId:tC.string(),state:tC.literal("approval-requested"),input:tC.unknown(),providerExecuted:tC.boolean().optional(),output:tC.never().optional(),errorText:tC.never().optional(),callProviderMetadata:a7.optional(),approval:tC.object({id:tC.string(),approved:tC.never().optional(),reason:tC.never().optional()})}),tC.object({type:tC.literal("dynamic-tool"),toolName:tC.string(),toolCallId:tC.string(),state:tC.literal("approval-responded"),input:tC.unknown(),providerExecuted:tC.boolean().optional(),output:tC.never().optional(),errorText:tC.never().optional(),callProviderMetadata:a7.optional(),approval:tC.object({id:tC.string(),approved:tC.boolean(),reason:tC.string().optional()})}),tC.object({type:tC.literal("dynamic-tool"),toolName:tC.string(),toolCallId:tC.string(),state:tC.literal("output-available"),input:tC.unknown(),providerExecuted:tC.boolean().optional(),output:tC.unknown(),errorText:tC.never().optional(),callProviderMetadata:a7.optional(),preliminary:tC.boolean().optional(),approval:tC.object({id:tC.string(),approved:tC.literal(!0),reason:tC.string().optional()}).optional()}),tC.object({type:tC.literal("dynamic-tool"),toolName:tC.string(),toolCallId:tC.string(),state:tC.literal("output-error"),input:tC.unknown(),rawInput:tC.unknown().optional(),providerExecuted:tC.boolean().optional(),output:tC.never().optional(),errorText:tC.string(),callProviderMetadata:a7.optional(),approval:tC.object({id:tC.string(),approved:tC.literal(!0),reason:tC.string().optional()}).optional()}),tC.object({type:tC.literal("dynamic-tool"),toolName:tC.string(),toolCallId:tC.string(),state:tC.literal("output-denied"),input:tC.unknown(),providerExecuted:tC.boolean().optional(),output:tC.never().optional(),errorText:tC.never().optional(),callProviderMetadata:a7.optional(),approval:tC.object({id:tC.string(),approved:tC.literal(!1),reason:tC.string().optional()})}),tC.object({type:tC.string().startsWith("tool-"),toolCallId:tC.string(),state:tC.literal("input-streaming"),providerExecuted:tC.boolean().optional(),callProviderMetadata:a7.optional(),input:tC.unknown().optional(),output:tC.never().optional(),errorText:tC.never().optional(),approval:tC.never().optional()}),tC.object({type:tC.string().startsWith("tool-"),toolCallId:tC.string(),state:tC.literal("input-available"),providerExecuted:tC.boolean().optional(),input:tC.unknown(),output:tC.never().optional(),errorText:tC.never().optional(),callProviderMetadata:a7.optional(),approval:tC.never().optional()}),tC.object({type:tC.string().startsWith("tool-"),toolCallId:tC.string(),state:tC.literal("approval-requested"),input:tC.unknown(),providerExecuted:tC.boolean().optional(),output:tC.never().optional(),errorText:tC.never().optional(),callProviderMetadata:a7.optional(),approval:tC.object({id:tC.string(),approved:tC.never().optional(),reason:tC.never().optional()})}),tC.object({type:tC.string().startsWith("tool-"),toolCallId:tC.string(),state:tC.literal("approval-responded"),input:tC.unknown(),providerExecuted:tC.boolean().optional(),output:tC.never().optional(),errorText:tC.never().optional(),callProviderMetadata:a7.optional(),approval:tC.object({id:tC.string(),approved:tC.boolean(),reason:tC.string().optional()})}),tC.object({type:tC.string().startsWith("tool-"),toolCallId:tC.string(),state:tC.literal("output-available"),providerExecuted:tC.boolean().optional(),input:tC.unknown(),output:tC.unknown(),errorText:tC.never().optional(),callProviderMetadata:a7.optional(),preliminary:tC.boolean().optional(),approval:tC.object({id:tC.string(),approved:tC.literal(!0),reason:tC.string().optional()}).optional()}),tC.object({type:tC.string().startsWith("tool-"),toolCallId:tC.string(),state:tC.literal("output-error"),providerExecuted:tC.boolean().optional(),input:tC.unknown(),rawInput:tC.unknown().optional(),output:tC.never().optional(),errorText:tC.string(),callProviderMetadata:a7.optional(),approval:tC.object({id:tC.string(),approved:tC.literal(!0),reason:tC.string().optional()}).optional()}),tC.object({type:tC.string().startsWith("tool-"),toolCallId:tC.string(),state:tC.literal("output-denied"),providerExecuted:tC.boolean().optional(),input:tC.unknown(),output:tC.never().optional(),errorText:tC.never().optional(),callProviderMetadata:a7.optional(),approval:tC.object({id:tC.string(),approved:tC.literal(!1),reason:tC.string().optional()})})])).nonempty("Message must contain at least one part")})).nonempty("Messages array must not be empty"))),(0,at.createIdGenerator)({prefix:"aiobj",size:24}),(0,at.createIdGenerator)({prefix:"aiobj",size:24});Symbol.for("vercel.ai.error.AI_NoSuchProviderError");aQ.NoSuchModelError;var oS=class{constructor({api:e="/api/chat",credentials:t,headers:r,body:a,fetch:o,prepareSendMessagesRequest:s,prepareReconnectToStreamRequest:n}){this.api=e,this.credentials=t,this.headers=r,this.body=a,this.fetch=o,this.prepareSendMessagesRequest=s,this.prepareReconnectToStreamRequest=n}async sendMessages(e){var t,r,a,o,s;let{abortSignal:n,...i}=e,l=await (0,at.resolve)(this.body),c=await (0,at.resolve)(this.headers),u=await (0,at.resolve)(this.credentials),d={...(0,at.normalizeHeaders)(c),...(0,at.normalizeHeaders)(i.headers)},p=await (null==(t=this.prepareSendMessagesRequest)?void 0:t.call(this,{api:this.api,id:i.chatId,messages:i.messages,body:{...l,...i.body},headers:d,credentials:u,requestMetadata:i.metadata,trigger:i.trigger,messageId:i.messageId})),h=null!=(r=null==p?void 0:p.api)?r:this.api,m=(null==p?void 0:p.headers)!==void 0?(0,at.normalizeHeaders)(p.headers):d,g=(null==p?void 0:p.body)!==void 0?p.body:{...l,...i.body,id:i.chatId,messages:i.messages,trigger:i.trigger,messageId:i.messageId},y=null!=(a=null==p?void 0:p.credentials)?a:u,f=null!=(o=this.fetch)?o:globalThis.fetch,v=await f(h,{method:"POST",headers:(0,at.withUserAgentSuffix)({"Content-Type":"application/json",...m},`ai-sdk/${a3}`,(0,at.getRuntimeEnvironmentUserAgent)()),body:JSON.stringify(g),credentials:y,signal:n});if(!v.ok)throw Error(null!=(s=await v.text())?s:"Failed to fetch the chat response.");if(!v.body)throw Error("The response body is empty.");return this.processResponseStream(v.body)}async reconnectToStream(e){var t,r,a,o,s;let n=await (0,at.resolve)(this.body),i=await (0,at.resolve)(this.headers),l=await (0,at.resolve)(this.credentials),c={...(0,at.normalizeHeaders)(i),...(0,at.normalizeHeaders)(e.headers)},u=await (null==(t=this.prepareReconnectToStreamRequest)?void 0:t.call(this,{api:this.api,id:e.chatId,body:{...n,...e.body},headers:c,credentials:l,requestMetadata:e.metadata})),d=null!=(r=null==u?void 0:u.api)?r:`${this.api}/${e.chatId}/stream`,p=(null==u?void 0:u.headers)!==void 0?(0,at.normalizeHeaders)(u.headers):c,h=null!=(a=null==u?void 0:u.credentials)?a:l,m=null!=(o=this.fetch)?o:globalThis.fetch,g=await m(d,{method:"GET",headers:(0,at.withUserAgentSuffix)(p,`ai-sdk/${a3}`,(0,at.getRuntimeEnvironmentUserAgent)()),credentials:h});if(204===g.status)return null;if(!g.ok)throw Error(null!=(s=await g.text())?s:"Failed to fetch the chat response.");if(!g.body)throw Error("The response body is empty.");return this.processResponseStream(g.body)}},oA=class extends oS{constructor(e={}){super(e)}processResponseStream(e){return(0,at.parseJsonEventStream)({stream:e,schema:oE}).pipeThrough(new TransformStream({async transform(e,t){if(!e.success)throw e.error;t.enqueue(e.value)}}))}};e.s(["DefaultChatTransport",0,oA,"getToolOrDynamicToolName",0,function(e){return o_(e)?e.toolName:e.type.split("-").slice(1).join("-")},"isToolOrDynamicToolUIPart",0,oT,"isToolUIPart",0,oT],6191041)}]);

//# debugId=ff971da1-d4c5-ec9b-4b09-5dcf49f42ac9
//# sourceMappingURL=f9fb1fe8b17b43c9.js.map