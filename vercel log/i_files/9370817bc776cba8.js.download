;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="8e3791fb-d450-2fd2-0329-3a23da98b65c")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,2547843,e=>{"use strict";var t=e.i(9171423),i=e.i(8042625);async function r(e){if(!e)return{rollingRelease:null};try{let i=await (0,t.fetchApi)(e,{throwOnHTTPError:!0});if(!i||"object"!=typeof i)return{rollingRelease:null};return i}catch(e){return{rollingRelease:null}}}async function a(e){if(e)try{let i=await (0,t.fetchApi)(e,{throwOnHTTPError:!0});if(!i||"object"!=typeof i)return;return i}catch(e){return}}e.s(["getRollingReleaseBillingEndpoint",0,(e,t)=>e&&t?`/api/v1/projects/${t}/rolling-release/billing${(0,i.encode)({teamId:e})}`:null,"getRollingReleaseEndpoint",0,(e,t)=>e&&t?`/api/v1/projects/${t}/rolling-release${(0,i.encode)({teamId:e})}`:null,"rollingReleaseBillingFetcher",0,a,"rollingReleaseFetcher",0,r],2547843)},3981247,e=>{"use strict";var t=e.i(850302),i=e.i(2547843);function r(e,r){let{teamIdOrSlug:a,projectSlug:n}=e,l=!a||!n,o=(0,t.default)(()=>l?null:(0,i.getRollingReleaseEndpoint)(a,n),i.rollingReleaseFetcher,r);return{...o,skipped:l,isLoading:!l&&o.isLoading}}e.s(["useRollingRelease",0,r,"useSuspenseRollingRelease",0,function(e){let{teamIdOrSlug:t,projectSlug:i}=e;return r({teamIdOrSlug:t,projectSlug:i},{suspense:!0,revalidateOnMount:!1})}])},4670733,e=>{"use strict";var t=e.i(1053524),i=e.i(3277689),r=e.i(2323372),a=e.i(6539082),n=e.i(5140444),l=e.i(5338940),o=e.i(588428);let s="vercel:ldFlags",c=(0,i.memoize)(()=>{let e=a.localStorageWrapper.getItem(s);if(e)return JSON.parse(e)}),u=(0,r.throttle)(e=>{a.localStorageWrapper.setItem(s,JSON.stringify(e))},1e3),d=()=>{let{flags:e,isLoading:i,isLoggedOut:r}=(0,n.useUser)(),l=(0,t.useMemo)(()=>e??c(),[e]);return(0,t.useEffect)(()=>{e&&(u(e),c.cache.set(void 0,e))},[e]),(0,t.useEffect)(()=>{r&&(a.localStorageWrapper.removeItem(s),c.cache.clear?.(),u.cancel())},[r]),{flags:l,isReady:!i&&void 0!==l}},m=e=>{let{flags:t,isReady:i}=d();return{isReady:i,value:t?.[e]??null}};e.s(["useEnableAnsiLogs",0,()=>{let e=(0,l.useTeam)(),t=(0,o.useLaunchDarklyTeamFeatureFlag)("ansi-logs"),i=m("ansi-logs");return{isReady:e.isTeam?t.isReady:i.isReady,value:!!(e.isTeam?t.value:i.value)}},"useFeedbackVariantsDeployStep",0,()=>{let{isReady:e,value:t}=(0,o.useLaunchDarklyTeamFeatureFlag)("feedback-variants-deploy-step"),{isReady:i,value:r}=m("feedback-variants-deploy-step");return(e&&t||i&&r)??!1},"useLaunchDarklyFeatureFlag",0,m,"useLaunchDarklyFlags",0,d,"useNetCpuFunctionsFlag",0,e=>{let t=(0,o.useLaunchDarklyTeamFeatureFlag)("net-cpu-functions"),i=(0,o.useLaunchDarklyTeamFeatureFlag)("net-cpu-billing-for-functions-projects"),r="string"==typeof i.value?i.value.split(",").map(e=>e.trim()):[];return{isReady:t.isReady&&i.isReady,value:!!t.value||r?.includes(e)}},"useStorageEnterpriseFlag",0,e=>{let t=(0,o.useLaunchDarklyTeamFeatureFlag)("storage-enterprise",e),i=t.value?.split(",").map(e=>e.trim()).filter(Boolean)||[];return{isReady:t.isReady,isStorageEnterpriseEnabled:e=>{let{storeType:r,isUnbundled:a,isTrialing:n}=e;return"edge-config"===r||"integration"===r||!!a||!!n||t.isReady&&i.includes(r)}}}])},3930829,e=>{"use strict";var t=e.i(1053524),i=e.i(7222834),r=e.i(2919890),a=e.i(7316497),n=e.i(5260505),l=e.i(8765922),o=e.i(1194788);e.s(["useIsomorphicSWRInfinite",0,function(e,s,c){let{isServer:u,config:d,fetcher:m,fallbackSource:p}=(0,r.useIsomorphicSwrContext)(!0),g=(0,t.useMemo)(()=>"function"==typeof s?(e,t)=>s(e,t):(e,t)=>t(e),[s]),h=(0,t.useMemo)(()=>e=>{if(u)throw Error("useSWR: swrFetcher is not available on server");return g(e,m)},[u,g,m]),y="object"==typeof s?s:c,{ssr:f,...x}=y??{},b=(0,a.mergeConfig)(d,y),v=e(0,null),j=p(v??null,g,b,!1),{data:k,isLoading:N,error:R}=(0,n.useAsyncValue)(u,j),S=(0,i.default)((t,i)=>{let r=e(t,i);return N&&!u?null:r},h,{...x,suspense:!1,fallback:{[(0,i.unstable_serialize)(e)]:k?[k]:void 0},revalidateOnMount:!u&&(x.revalidateOnMount??(!k&&!N))}),{mutate:A,data:P,isLoading:C}=S,w=(0,t.useMemo)(()=>(0,l.withThrottle)(v,()=>{(0,o.debug)(`Client fallback data fetch for ${v}`),A()},2e3),[v,A]);return(0,t.useEffect)(()=>{!R||C||P||w()},[R,w,P,C]),{...S,isLoading:S.isLoading&&void 0===S.data||N||u}}])},5771992,e=>{"use strict";var t=e.i(1053524),i=e.i(850302),r=e.i(8042625),a=e.i(277234),n=e.i(4244280),l=e.i(5338940),o=e.i(2323372),s=e.i(5140444),c=e.i(4655443),u=e.i(3930829),d=e.i(588428),m=e.i(4670733),p=e.i(2259673),g=e.i(7783521);e.s(["default",0,function(e){let{limit:t,projectId:o,project:s,from:c,target:u,users:d=[],...m}=e,p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},g=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"v6",{isReady:h,team:y}=(0,l.useTeam)(),f=d.length>0?d.map(e=>e.uid).join(","):null,x=!!o||!!s?.id;return(0,i.default)(h&&x&&t>0?`${(0,n.API_DEPLOYMENTS)(g)}${(0,r.encode)({projectId:o||s?.id,limit:t,from:c||null,teamId:y?.id,target:u,users:f,...m})}`:null,e=>(0,a.fetchAPI)(e,{throwOnHTTPError:!0}),p)},"useDeploymentsInfinite",0,function(e){var i;let a,{limit:h,project:y,projectId:f,requireProject:x,users:b,target:v,readyStateFilter:j,meta:k,rollbackCandidate:N,since:R,until:S,subscribeToUpdates:A,branch:P,sha:C,ignoreProjectSlug:w,projectIds:D}=e,{refreshInterval:I,...T}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},L=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"v6",{isReady:M,team:$}=(0,l.useTeam)(),{user:F}=(0,s.useUser)(),[E,O]=(0,t.useState)(()=>I),B=b&&b.length>0?b.map(e=>e.uid).join(","):null,z=y?.id||f,{value:_}=(0,m.useLaunchDarklyFeatureFlag)("instant-rollback-hobby-restriction"),{value:W}=(0,d.useLaunchDarklyTeamFeatureFlag)("instant-rollback-hobby-restriction"),{teamSlug:U,project:H}=(0,c.useParams)()??{},Y={projectId:z,limit:h,teamId:$?.id,target:v||null,users:B,state:j,meta:k,rollbackCandidate:N,since:R,until:S,branch:P,sha:C,projectIds:D},G=x||(_||W)&&void 0!==N&&(!$||$.billing?.plan==="hobby"),V=(0,u.useIsomorphicSWRInfinite)((e,t)=>{if(U&&H&&!w){if(!e)return`${(0,n.API_DEPLOYMENTS)(L)}${(0,r.encode)({...Y,teamId:U,projectId:H})}`;let i=t&&t.deployments.length>=h?t.deployments[t.deployments.length-1].created-1:null;return i?`${(0,n.API_DEPLOYMENTS)(L)}${(0,r.encode)({...Y,teamId:U,projectId:H,from:i})}`:null}if(G&&!z)return null;if(!e)return M?`${(0,n.API_DEPLOYMENTS)(L)}${(0,r.encode)(Y)}`:null;let i=t&&t.deployments.length>=h?t.deployments[t.deployments.length-1].created-1:null;return i&&M?`${(0,n.API_DEPLOYMENTS)(L)}${(0,r.encode)({...Y,from:i})}`:null},{...T,refreshInterval:E,ssr:{timeout:1e3}}),{mutate:q}=V,K=(0,t.useMemo)(()=>(0,o.throttle)(()=>{q()},100),[q]),{isListening:J}=(a=(i=A?y:void 0)?`${i.accountId}-${i.id}`:void 0,(0,p.usePusherEvent)("deployments",a,"deployment-created",K));J||I===E?J&&3e4!==E&&O(3e4):O(I);let X=(0,t.useMemo)(()=>V.data?V.data.flatMap(e=>e.deployments):[],[V.data]),Q=$?$.id:F?.uid,Z=(0,t.useMemo)(()=>A&&Q?X.map(e=>({id:e.uid,readyState:e.readyState,aliasAssigned:!!e.aliasAssigned,ownerId:Q})):[],[X,A,Q]);(0,g.useDeploymentsStatusPing)(Z,K);let ee=!!V.data,et=ee&&0===X.length,ei=ee&&V.data&&V.size>V.data.length,er=ee&&V.data&&V.data[V.data.length-1]?.deployments.length<h;return[V,{deployments:X,initialDataLoaded:ee,isEmpty:et,loadMore:()=>V.setSize(e=>e+1),isLoadingMore:ei,isReachingEnd:er,mutate:V.mutate}]}],5771992)},415061,e=>{"use strict";var t=e.i(1381818);e.s(["default",0,function(e){let{width:i=24,height:r=24,style:a}=e;return(0,t.jsxs)("svg",{fill:"none",height:r,style:{border:"1px solid var(--accents-2)",borderRadius:"100%",boxSizing:"border-box",...a},viewBox:"0 0 24 24",width:i,children:[(0,t.jsx)("path",{clipRule:"evenodd",d:"M12 24c6.627 0 12-5.373 12-12S18.627 0 12 0 0 5.373 0 12s5.373 12 12 12z",fill:"#000",fillRule:"evenodd"}),(0,t.jsx)("path",{clipRule:"evenodd",d:"M12.24 6.24L18 16.378H6.48L12.24 6.24z",fill:"#fff",fillRule:"evenodd"})]})}])},8651268,e=>{"use strict";var t=e.i(1381818),i=e.i(415061),r=e.i(4585051),a=e.i(76079),n=e.i(3025777),l=e.i(3896588),o=e.i(6683690);let s={12:-6},c={12:-5};function u(e){let t,{principalId:i,principal:r,viaIds:a,via:n,viewerId:l,includeVia:o}=e;if(r)switch(r.type){case"app":case"integration":t=r.name;break;case"system":t="System";break;default:if(r.uid===l){t="You";break}t=r.username}if(i&&i===l&&(t="You"),t&&o){let e=d({viaIds:a,via:n,viewerId:l});e&&(t+=`via ${e}`)}return t}function d(e){let{viaIds:t,via:i,viewerId:r}=e;if(t&&t.length>0)return u({principalId:t[0],principal:i?.[0],viewerId:r})}e.s(["PrincipalAvatar",0,function e(u){var d,m,p,g,h,y,f;let x,b,v,j,k,{title:N,principalId:R,principal:S,viaIds:A,via:P,size:C=32,style:w,entities:D,deploymentMeta:I,viewerId:T,iconBackground:L,...M}=u,$=!1,F=M.iconSize??(0==(x=(d=C/2.2)%2)?d:d+2-x);D?.forEach(e=>{"system"===e.type?$=!0:"github_login"===e.type?b=e:"gitlab_login"===e.type?v=e:"bitbucket_login"===e.type&&(j=e)}),I&&(I.githubCommitAuthorLogin?b={login:I.githubCommitAuthorLogin}:I.gitlabCommitAuthorLogin?v={login:I.gitlabCommitAuthorLogin,avatar:I.gitlabCommitAuthorAvatar}:I.bitbucketCommitAuthorName&&(j={login:I.bitbucketCommitAuthorName,avatar:I.bitbucketCommitAuthorAvatar}));let E="object"==typeof M.showProviderIcon?M.showProviderIcon:{github:M.showProviderIcon,gitlab:M.showProviderIcon,bitbucket:M.showProviderIcon};if(m=R,p=S,p?.type==="app"||m.startsWith("cl_")||(g=R,h=S,h?.type==="integration"||g.startsWith("oac_"))){let e=S&&"name"in S?S.name:void 0;return(0,t.jsx)(r.Avatar,{hash:S?.avatar,size:C,style:w,title:N??(e?`${e} Avatar`:void 0),uid:R})}if($||(y=R,f=S,f?.type==="system"||"system"===y))return(0,t.jsx)(i.default,{height:C,style:{marginTop:"2px",...w??{}},width:C});let O=N;R===T?(k="You",O??="Your Avatar"):S&&"username"in S&&(k=S.username,O??=`${k} Avatar`);let B=function(e,t){let i=e?.[0],r=t?.[0];if(!i){if(!r)return;switch(r.type){case"app":i=r.clientId;break;case"integration":i=r.id;break;case"system":i="system";break;default:i=r.uid}}return[i,r]}(A,P);return B?(0,t.jsx)(a.AvatarWithIcon,{hash:S?.avatar,size:C,style:w,title:O,uid:R,iconBackground:L,left:c[F],icon:(0,t.jsx)(e,{principalId:B[0],principal:B[1],size:F+4})}):b?.login?(0,t.jsx)(n.GitHubAvatar,{iconBackground:L,size:C,iconSize:F,left:s[F],bottom:s[F],style:w,title:N??`github/${b.login}`,username:b.login,showIcon:E.github}):v?.login?(0,t.jsx)(l.GitLabAvatar,{hash:v.avatar?void 0:S?.avatar,iconBackground:L,size:C,iconSize:F,style:w,title:N,url:v.avatar,showIcon:E.gitlab}):j?.login?(0,t.jsx)(o.BitbucketAvatar,{hash:j.avatar?void 0:S?.avatar,iconBackground:L,size:C,iconSize:F,style:w,title:N,url:j.avatar,showIcon:E.bitbucket}):(0,t.jsx)(r.Avatar,{hash:S?.avatar,size:C,style:w,title:O,uid:R})},"getPrincipalName",0,u,"getViaName",0,d])},2982888,e=>{"use strict";var t=e.i(1381818),i=e.i(4585051),r=e.i(415061),a=e.i(8651268);function n(e){let{deployment:r,showIcon:n,iconBackground:l,size:o}=e;return r?(0,t.jsx)(a.PrincipalAvatar,{size:o,principalId:r.creator.uid,principal:{type:"user",uid:r.creator.uid,username:r.creator.username},deploymentMeta:r.meta?.originalDeploymentId?void 0:r.meta,showProviderIcon:n,iconBackground:l}):(0,t.jsx)(i.Avatar,{placeholder:!0,size:o})}e.s(["DeployHookAvatar",0,function(e){let{height:i,width:a}=e;return(0,t.jsx)("div",{className:"flex items-center justify-center",children:(0,t.jsx)(r.default,{height:i,width:a})})},"DeploymentCreatorAvatar",0,function(e){let{deployment:i,size:r=24,showIcon:a=!0,iconBackground:l=!0}=e;return(0,t.jsx)("span",{style:{display:"inline-block"},children:(0,t.jsx)(n,{deployment:i,iconBackground:l,showIcon:a,size:r})})},"getDeploymentCreatorUsername",0,function(e){let{deployment:t}=e;if(!t)return null;if(!t.meta?.originalDeploymentId){if(t.meta?.githubDeployment&&"string"==typeof t.meta.githubCommitAuthorLogin)return t.meta.githubCommitAuthorLogin;if(t.meta?.gitlabDeployment&&"string"==typeof t.meta.gitlabCommitAuthorLogin)return t.meta.gitlabCommitAuthorLogin;if(t.meta?.bitbucketDeployment){if("string"==typeof t.meta.bitbucketCommitAuthorLogin)return t.meta.bitbucketCommitAuthorLogin;if("string"==typeof t.meta.bitbucketCommitAuthorName)return t.meta.bitbucketCommitAuthorName}}return t.creator?.username||null}])},4443312,e=>{"use strict";var t=e.i(4603164),i=e.i(5338940);e.s(["CHECK_RUNS_REFRESH_INTERVAL",0,3e3,"useProjectCheckRuns",0,function(e){let{deploymentId:r,swrOptions:a,enableCiChecksAndPolicies:n}=e,{team:l}=(0,i.useTeam)();return(0,t.useTypedSWR)("/v2/deployments/{deploymentId}/check-runs",n&&r&&l?.id?{deploymentId:r,teamId:l.id}:null,{refreshInterval:3e3,...a})}])},8227242,e=>{"use strict";var t=e.i(1381818);e.i(9623499);var i=e.i(5576066);e.s(["LinkParser",0,function(e){let r,{text:a}=e;return(0,t.jsx)("span",{children:(r=/(?<temp1>https?:\/\/[^\s]+)/g,a.split(r).map(e=>r.test(e)?(0,t.jsx)(i.Link,{className:"break-all font-normal",href:e,rel:"noopener noreferrer",target:"_blank",type:"blend",children:e},e):(0,t.jsx)("span",{children:e},e)))})}])},8529990,e=>{"use strict";let t=encodeURIComponent;function i(e){return"string"==typeof e?e:void 0}e.s(["getGitInfoFromDeployment",0,function(e,r){if(!e)return null;let{meta:a}=e;if(a?.githubDeployment){let e=r?.type==="github"||r?.type==="github-limited"?r:null,n=e?.org??a.githubCommitOrg??"",l=e?.repo??a.githubCommitRepo??"",o=`https://github.com/${t(n)}/${t(l)}/commit/${a.githubCommitSha}`,s=`https://github.com/${t(n)}/${t(l)}/tree/${t(a.githubCommitRef??"")}`,c=a.githubPrId?`https://github.com/${t(e?.org??a.githubOrg??"")}/${t(e?.repo??a.githubRepo??"")}/pull/${a.githubPrId}`:void 0;return{type:"github",commitRef:String(a.githubCommitRef),commitSha:String(a.githubCommitSha),commitAuthorName:String(a.githubCommitAuthorName),commitAuthorLogin:i(a.githubCommitAuthorLogin),commitMessage:String(a.githubCommitMessage),repoName:String(a.githubCommitRepo),repoNamespace:String(a.githubCommitOrg),orgNamespace:String(a.githubOrg),commitUrl:o,refUrl:s,viaFork:a.githubOrg!==a.githubCommitOrg,prId:a.githubPrId?Number(a.githubPrId):void 0,prUrl:c,gitDirty:String(a.gitDirty),isPublic:"public"===a.githubRepoVisibility}}if(a?.gitlabDeployment){let e=r?.type==="gitlab"?r:null,n=e?.projectNamespace&&e?.projectName?`${e.projectNamespace}/${e.projectName}`:a.gitlabProjectPath,l=`https://gitlab.com/${n}/tree/${t(a.gitlabCommitRef??"")}`,o=`https://gitlab.com/${n}/commit/${a.gitlabCommitSha}`;return{type:"gitlab",commitRef:String(a.gitlabCommitRef),commitSha:String(a.gitlabCommitSha),commitAuthorName:String(a.gitlabCommitAuthorName),commitAuthorLogin:i(a.gitlabCommitAuthorLogin),commitMessage:String(a.gitlabCommitMessage||a.gitCommitMessage),repoName:String(a.gitlabProjectName),repoNamespace:String(a.gitlabProjectNamespace),orgNamespace:String(a.gitlabProjectNamespace),commitUrl:o,refUrl:l,isPublic:"public"===a.gitlabProjectVisibility}}if(a?.bitbucketDeployment){let e=r?.type==="bitbucket"?r:null,n=e?.owner??a.bitbucketRepoOwner,l=e?.slug??a.bitbucketRepoSlug,o=`https://bitbucket.org/${n}/${l}/branch/${t(a.bitbucketCommitRef??"")}`,s=`https://bitbucket.org/${n}/${l}/commits/${a.bitbucketCommitSha}`;return{type:"bitbucket",commitRef:String(a.bitbucketCommitRef),commitSha:String(a.bitbucketCommitSha),commitAuthorName:i(a.bitbucketCommitAuthorName),commitAuthorLogin:i(a.bitbucketCommitAuthorLogin),commitMessage:String(a.bitbucketCommitMessage),repoName:String(a.bitbucketRepoSlug),repoNamespace:String(a.bitbucketRepoOwner),orgNamespace:String(a.bitbucketRepoOwner),commitUrl:s,refUrl:o,isPublic:"public"===a.bitbucketRepoVisibility}}return null}])},3907048,e=>{"use strict";var t=e.i(1381818),i=e.i(4585051),r=e.i(1053524),a=e.i(2982888),n=e.i(8651268);let l=(0,r.memo)(e=>{let{deployment:r,size:l=24,showProviderIcon:o=!1}=e;return r.meta?.deployHookId?(0,t.jsx)(a.DeployHookAvatar,{height:l,width:l}):r.creator?.uid?(0,t.jsx)(n.PrincipalAvatar,{size:l,principalId:r.creator.uid,principal:{type:"user",uid:r.creator.uid,username:r.creator.username},deploymentMeta:r.meta?.originalDeploymentId?void 0:r.meta,showProviderIcon:{github:!1,gitlab:o,bitbucket:o}}):(0,t.jsx)(i.Avatar,{size:l})});l.displayName="CreatorAvatar",e.s(["CreatorAvatar",0,l])},930810,9745887,e=>{"use strict";var t=e.i(1381818),i=e.i(2504781),r=e.i(9334091),a=e.i(3306538),n=e.i(57106),l=e.i(3753138),o=e.i(6226725),s=e.i(4345845),c=e.i(8893913),u=e.i(7218483),d=e.i(9722978),m=e.i(9375869),p=e.i(8529990),g=e.i(3907048);function h(e){let{isForm:i,children:r,className:a}=e;return i?(0,t.jsx)("label",{className:a,children:r}):(0,t.jsx)("div",{className:a,children:r})}function y(e){let{deployment:i,isForm:r,isPromote:y,isPreviousDeployment:f,isProductionDeployment:x,isRolledBackDeployment:b,selectedDeployment:v,setSelectedDeployment:j,ariaLabel:k="Rollback Deployment"}=e,N=(0,u.useAgo)(i.createdAt||0),R="number"==typeof i.aliasAssigned?i.aliasAssigned:0,S=R>0,A=(0,u.useAgo)(R),P=(0,m.useDeploymentLink)(i),C=(0,p.getGitInfoFromDeployment)(i),w=x||f||b;f&&b&&(f=!1);let D="Preview";if("target"in i)switch(i.target){case"staging":D="Staging";break;case"production":D="Production";break;default:D="Preview"}else D="Production";let I="uid"in i?i.uid:i.id,T=null;y?C?.commitRef&&(T=(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-0.5 flex-initial",children:[(0,t.jsx)(s.GitBranch,{color:"gray-900"}),(0,t.jsx)("span",{className:"text-copy-14-mono text-gray-900 truncate whitespace-nowrap",style:{marginRight:"4px",maxWidth:120,textOverflow:"ellipsis",overflowX:"hidden",minWidth:0},title:C.commitRef,children:C.commitRef}),(0,t.jsxs)("span",{className:"text-copy-14 text-gray-900 truncate whitespace-nowrap flex items-center gap-1",style:{flexBasis:"50%",flexShrink:0,flexGrow:1,textOverflow:"ellipsis",overflowX:"hidden",minWidth:0,maxWidth:260},children:["Staged"," ",N," by"," ",(0,t.jsx)("span",{children:(0,t.jsx)(g.CreatorAvatar,{deployment:i,showProviderIcon:!0,size:24})}),(0,t.jsx)("span",{children:!i.meta?.originalDeploymentId&&i.creator?.username?i.creator.username:C.commitAuthorLogin})]})]})):T=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"inline-flex flex-row items-center",children:[(0,t.jsx)("span",{className:"text-copy-14 text-gray-900",style:{marginRight:"4px"},children:D}),C?.commitRef?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.GitBranch,{color:"gray-900",size:14}),(0,t.jsx)("span",{className:"text-copy-14-mono max-w-[100px] truncate whitespace-nowrap px-1 text-center text-sm leading-5 text-gray-900",title:C.commitRef,children:C.commitRef}),(0,t.jsx)("span",{className:"text-copy-14 text-gray-900",children:"by"}),(0,t.jsxs)("div",{className:"ml-1 inline-flex flex-row items-center gap-1",children:[(0,t.jsx)(g.CreatorAvatar,{deployment:i,size:20}),(0,t.jsx)("span",{className:"text-copy-14 text-gray-900 truncate max-w-[140px]",children:!i.meta?.originalDeploymentId&&i.creator?.username?`${i.creator.username}`:C.commitAuthorLogin})]})]}):null]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-copy-14 text-gray-900",children:"Deployed "}),(0,t.jsx)("span",{className:"text-copy-14 text-gray-900",children:N}),(0,t.jsx)("span",{className:"text-copy-14 text-gray-900",children:", "}),S?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"text-copy-14 text-gray-900",children:"promoted "}),(0,t.jsx)("span",{className:"text-copy-14 text-gray-900",children:A})]}):(0,t.jsx)("span",{className:"text-copy-14 text-gray-900",children:"never promoted"})]})]});let L=null;return r||(L=y?(0,t.jsx)(l.ArrowCircleUp,{className:"mr-4 hidden self-center @sm-page:block",style:{flexShrink:0}}):x?(0,t.jsx)(o.CrossCircle,{className:"mr-4 hidden self-center @sm-page:block",style:{flexShrink:0}}):(0,t.jsx)(c.RotateCounterClockwise,{className:"mr-4 hidden self-center @sm-page:block",color:"gray-1000",style:{flexShrink:0}})),(0,t.jsxs)(h,{className:(0,d.clsx)("flex w-full items-end justify-start px-4 py-3","rounded border border-solid border-[var(--accents-2)]","rounded-b-none","last:rounded-b","[&+&]:rounded-t-none [&+&]:border-t-0",{"bg-[var(--accents-1)] shadow-none":x,"bg-[var(--geist-background)]":!x}),isForm:r,children:[r?(0,t.jsx)("input",{"aria-label":k,checked:v?.uid===I,className:`
            relative m-0 mr-4 size-4 shrink-0 appearance-none
            self-center rounded-[1000px] border
            border-solid border-[var(--geist-foreground)] after:absolute after:inset-[3px]
            after:rounded-[1000px] after:bg-[var(--geist-foreground)]
            after:content-none checked:after:content-['']
          `,name:"rollbackDeployment",onChange:()=>{"uid"in i&&"type"in i&&j&&j(i)},type:"radio",value:I}):L,(0,t.jsxs)("div",{style:{width:w?"initial":"100%",minWidth:0},children:[(0,t.jsx)(n.Link,{className:"flex w-[calc(100%-1ch)] items-center gap-0.5 break-all text-sm font-bold leading-5",href:P,target:"_blank",children:(0,t.jsx)("span",{className:"text-[14px] leading-[20px] font-medium line-clamp-1",title:i.url,children:i.url})}),C?.commitMessage?(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900 line-clamp-1 break-words",title:C.commitMessage,children:[C.commitSha.substring(0,7)," ",C.commitMessage]}):null,T]}),x?(0,t.jsx)(a.Badge,{className:"ml-auto hidden self-start text-xs font-medium @sm-page:inline-flex",variant:"inverted",children:"Current"}):null,f?(0,t.jsx)(a.Badge,{className:"ml-auto hidden self-start text-xs font-medium @sm-page:inline-flex",variant:"gray-subtle",children:"Previous"}):null,b?(0,t.jsx)(a.Badge,{className:"ml-auto hidden self-start text-xs font-medium @sm-page:inline-flex",variant:"red-subtle",children:"Rolled back"}):null]})}e.s(["DeploymentCardSmall",0,y],9745887);var f=e.i(8227242),x=e.i(8651268);e.s(["ChooseDeploymentList",0,function(e){let{deployments:r,previousDeployment:a,rolledBackDeploymentId:n,productionDeployment:l,selectedDeployment:o,setSelectedDeployment:s,swr:c,ariaLabel:u}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{children:r.map(e=>l.id!==e.uid&&(0,t.jsx)(y,{deployment:e,isForm:!0,isPreviousDeployment:a?.uid===e.uid,isRolledBackDeployment:n===e.uid,selectedDeployment:o,setSelectedDeployment:s,ariaLabel:u},e.uid))}),!c.isReachingEnd&&(0,t.jsx)(i.Button,{loading:c.isLoadingMore,onClick:()=>{c.loadMore()},style:{marginTop:24},type:"secondary",width:"100%",children:"Show More"})]})},"REASON_MAX_CHARACTER_LENGTH",0,250,"RollbackDescriptionCard",0,function(e){let{rollbackDescription:i,project:r,preview:a}=e,n=(0,u.useAgo)(i.createdAt);return(0,t.jsxs)("div",{className:"px-4 py-3 rounded bg-background-200 shadow-border",children:[(0,t.jsx)("p",{className:"text-copy-14 text-gray-900 break-words",children:i.description.length>0?(0,t.jsxs)(t.Fragment,{children:["“",(0,t.jsx)(f.LinkParser,{text:i.description}),"”"]}):(0,t.jsx)("span",{className:"text-copy-14",children:"No reason provided."})}),(0,t.jsxs)("div",{className:"flex gap-1 pt-1",children:[a?null:(0,t.jsx)("p",{className:"text-copy-14",children:"Rolled back by"}),i.username?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.PrincipalAvatar,{size:20,principalId:i.userId,principal:{type:"user",uid:i.userId,username:i.username}}),(0,t.jsx)("p",{className:"text-copy-14",children:i.username}),r?.lastAliasRequest!==void 0&&!a&&(0,t.jsx)("p",{className:"text-copy-14",children:n})]}):null]})]})},"RollbackDescriptionTextarea",0,function(e){let{value:i,onChange:a,id:n}=e;return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(r.Textarea,{autoFocus:!0,className:"text-base min-h-24",error:i.length>=250?"Reason cannot be longer than 250 characters.":void 0,id:n,onChange:e=>a(e.target.value),placeholder:"Production is not behaving as expected…",required:!0,value:i,style:{fontSize:14}})})},"getDeploymentId",0,function(e){return"id"in e?e.id:"uid"in e?e.uid:void 0},"getMostRecentlyPromotedDeployment",0,function(e){if(0===e.length)return;let t=e.reduce((e,t)=>e.aliasAssigned&&t.aliasAssigned?e.aliasAssigned>t.aliasAssigned?e:t:t.aliasAssigned?t:e);if(t.aliasAssigned)return t},"isDeleted",0,function(e){return void 0!==e.deleted}],930810)},6619197,5645345,e=>{"use strict";var t=e.i(1381818),i=e.i(1053524),r=e.i(8248823),a=e.i(4655443),n=e.i(57106),l=e.i(3869281),o=e.i(4030453),s=e.i(2455417),c=e.i(6891161),u=e.i(8522580),d=e.i(5255926),m=e.i(9318197),p=e.i(455575),g=e.i(8761240),h=e.i(472117),y=e.i(4004502),f=e.i(8042625),x=e.i(277234),b=e.i(4244280),v=e.i(4443312),j=e.i(5140444),k=e.i(5338940),N=e.i(6565161),R=e.i(4450569),S=e.i(4396019),A=e.i(9375869),P=e.i(8518548);function C(e){if(!e)return;if("id"in e==!1)return e;let{aliasAssigned:t,aliasError:i=null,aliasAssignedAt:r,buildingAt:a,created:n=e.createdAt,createdAt:l,creator:o,name:s,ready:c,readyState:u,readySubstate:d,target:m=null,uid:p=e.id,url:g,isRollbackCandidate:h="production"===e.target,prebuilt:y}=e;return{aliasAssigned:t,aliasError:i,aliasAssignedAt:r,buildingAt:a,created:n,createdAt:l,creator:{email:"",githubLogin:"",...o},name:s,ready:c,readyState:u,readySubstate:d,target:m,prebuilt:y,type:"LAMBDAS",uid:p,url:g,isRollbackCandidate:h}}e.s(["asListDeployment",0,C],5645345);var w=e.i(1840726),D=e.i(930810),I=e.i(7952834),T=e.i(1173672),L=e.i(9745887),M=e.i(3008300),$=e.i(3981247),F=e.i(6060673);function E(e){let{title:i}=e;return(0,t.jsx)(c.Modal.Header,{children:(0,t.jsx)(c.Modal.Title,{center:!0,children:i})})}function O(e){let{deploymentId:i}=e,r=(0,h.useChecksPrivateBetaFlag)(),a=(0,h.useCiChecksAndPoliciesFlagV2)(),l=r||a,{data:o,isLoading:s}=(0,v.useProjectCheckRuns)({deploymentId:i,enableCiChecksAndPolicies:l});if(!l)return null;if(s)return(0,t.jsx)(d.Skeleton,{});if(o?.runs.every(e=>"succeeded"===e.conclusion))return null;let c=o?.runs.filter(e=>"succeeded"!==e.conclusion)||[];return(0,t.jsxs)(u.Note,{type:"error",fill:!0,className:"mt-6",children:["By clicking Promote, you acknowledge that you are bypassing promotion requirements:",c.length>0&&(0,t.jsx)("ul",{className:"flex flex-col gap-1 ml-4 list-disc",children:c.slice(0,5).map(e=>(0,t.jsx)("li",{children:e.externalUrl?(0,t.jsx)(n.Link,{href:e.externalUrl,external:!0,children:e.name}):(0,t.jsx)("span",{children:e.name})},e.id||e.name||`${e.conclusion}-${e.status}`))})]})}let B=e=>{let{deployment:t,project:n,useIgnoreBuildStep:l,onCurrentDeploymentPromoted:o}=e,s=(0,p.useToasts)(),c=(0,a.useRouter)(),{team:u}=(0,k.useTeam)(),{user:d}=(0,j.useUser)(),{mutate:m}=(0,N.useSWRConfig)(),[g,h]=(0,i.useState)(!1),[y,v]=(0,i.useState)(void 0),R=(0,w.useShowIgnoreBuildStep)({project:n,deployment:t});return{promote:(0,i.useCallback)(async()=>{if(t&&n){h(!0),v(void 0);try{let e,i=u?.id,r="Promoted Deployment successfully.";if("production"===t.target)await (0,x.fetchAPI)(`${(0,b.API_DEPLOYMENT_PROMOTE)(n.id,t.uid||t.id)}${(0,f.encode)({teamId:i})}`,{method:"POST",body:{},throwOnHTTPError:!0}),e=(0,A.pathFromDeployment)(t,{user:d,team:u});else{let a=await (0,x.fetchAPI)(`${(0,b.API_DEPLOYMENTS)("v13")}${(0,f.encode)({teamId:i,skipIgnoreBuildStep:R&&!l?"1":null})}`,{method:"POST",body:JSON.stringify({deploymentId:t.uid||t.id,meta:{action:"promote"},name:n.name,target:"production"}),throwOnHTTPError:!0});e=(0,A.pathFromDeployment)(a,{user:d,team:u});let o=t.uid||t.id;r="production"===t.target?o===a.id?"Deployment is already the current Production Deployment.":"Promoted Deployment to Production successfully.":"Created Production Deployment successfully."}u&&((0,I.revalidateProject)(m,n),await m((0,T.getProjectProductionDeploymentKey)({projectIdOrName:n.id,teamId:u.slug}))),s.success({text:r,key:"production-deployment"}),e&&(o?.(),e!==location.pathname&&c.push(e))}catch(e){v((0,r.normalizeError)(e))}finally{h(!1)}}},[t,n,c,R,u,s,l,d,m,o]),loading:g,setLoading:h,error:y,setError:v}};e.s(["default",0,function(e,r){let{onDeploymentPromoted:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},[d,p]=(0,i.useState)(!1),[h,f]=(0,i.useState)(null),{team:x}=(0,k.useTeam)(),b=e??h?.name,{data:v}=(0,F.useProject)(b),N=r??v,A=(0,w.useShowIgnoreBuildStep)({project:N,deployment:h}),[C,I]=(0,i.useState)(M.DEFAULT_USE_IGNORE_BUILD_STEP_PROMOTE),T=(0,i.useCallback)(()=>{p(!1)},[]),{error:z,loading:_,promote:W,setError:U,setLoading:H}=B({deployment:h,useIgnoreBuildStep:C,project:N,onCurrentDeploymentPromoted:(0,i.useCallback)(()=>{T(),a?.()},[T,a])}),{user:Y}=(0,j.useUser)(),{data:G}=(0,$.useRollingRelease)({teamIdOrSlug:x?.slug,projectSlug:b}),V=N?.rollingRelease?.stages!==void 0&&N.rollingRelease.stages.length>0,q=G?.rollingRelease?.state==="ACTIVE",K=G?.rollingRelease?.canaryDeployment?.id,J=q&&K===h?.uid,X=V&&!q&&h?.target==="production",Q=V&&q&&h?.target==="production",Z=X&&N.rollingRelease?.stages!==void 0?N.rollingRelease.stages[0]?.targetPercentage:null,{data:ee}=(0,P.useProjectDomains)(b,{limit:11,production:"true",redirects:"false",verified:"true",order:"ASC"}),et=(0,i.useCallback)(e=>{f(e),p(!0)},[]),ei=(0,i.useCallback)(()=>{H(!1),f(null),U(void 0)},[U,H]),{rollbackDescription:er,deploymentIsStale:ea}=(0,S.useProjectProductionDeployment)(N?.name),{andMoreDomains:en,remainingDomains:el}=(0,i.useMemo)(()=>{if(!ee)return{andMoreDomains:!1,remainingDomains:[]};let e=ee.length>2,t=e?ee.slice(2).map(e=>e.name):[];return{andMoreDomains:e,remainingDomains:t}},[ee]),eo=(0,i.useMemo)(()=>{if(!N||!h)return(0,t.jsx)(R.default,{center:!0,style:{marginTop:10},children:(0,t.jsx)(s.LoadingDots,{size:4})});let e=!!(ee&&ee.length>0);return(0,t.jsxs)(t.Fragment,{children:["production"===h.target?(0,t.jsx)("p",{className:"text-copy-14",style:{marginBottom:"16px"},children:"Deployment to promote:"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"text-copy-14",style:{marginBottom:"16px"},children:"A new deployment will be built using your production environment."}),(0,t.jsx)("p",{className:"text-copy-14",style:{marginBottom:"16px"},children:"Deployment to promote to production:"})]}),(0,t.jsx)("div",{children:(0,t.jsx)(L.DeploymentCardSmall,{deployment:h,isPromote:!0,selectedDeployment:null})}),X?(0,t.jsxs)("p",{className:"text-copy-14",style:{marginBottom:16,marginTop:24},children:["This will start a new rolling release with initial traffic of"," ",Z,"%."]}):null,Q?(0,t.jsx)("p",{className:"text-copy-14",style:{marginBottom:16,marginTop:24},children:"This will queue the deployment for promotion after the current rolling release completes."}):null,X||Q||!e?null:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"text-copy-14",style:{marginBottom:16,marginTop:24},children:"It will be aliased to the following domains:"}),(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial pl-12",children:ee?.slice(0,2).map(e=>{let{name:i}=e;return(0,t.jsx)("p",{className:"text-copy-14",children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-3 flex-initial",children:[(0,t.jsx)(g.CheckCircleFill,{color:"blue-700",size:20}),(0,t.jsx)("span",{children:i.startsWith("*")?i:(0,t.jsx)(n.Link,{"data-testid":(0,y.tid)("deployments","promote-to-production-overlay","preview-link"),external:!0,href:`https://${i}`,variant:"highlight",children:i})})]})},i)})}),en?(0,t.jsxs)("p",{className:"text-copy-14 mt-6 mb-4",children:["...and ",el.length," more"]}):null]}),!X&&!e&&(0,t.jsxs)("p",{className:"text-copy-14",style:{marginBottom:"24px",marginTop:"24px"},children:["Warning: Your Project does not have a Production Domain. We recommend you"," ",(0,t.jsx)(n.Link,{href:`/${x?x.slug:Y?.username}/${encodeURIComponent(N.name)}/settings/domains`,variant:"highlight",children:"add"})," ","one."]}),N.link&&h.gitSource?(0,t.jsx)(O,{deploymentId:h.id}):null,A?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.Spacer,{y:1}),(0,t.jsx)(l.Checkbox,{checked:C,fullWidth:!0,onChange:()=>{I(!C)},children:"Use project's Ignore Build Step"})]}):null,J?(0,t.jsx)(u.Note,{className:" border border-[#fde68a] bg-[#fffbeb] text-[#bd5200] dark:border-[#411d06] dark:bg-[#241005] dark:text-[#fde68a] ",fill:!0,size:"small",style:{marginTop:24},type:"warning",variant:"contrast",children:(0,t.jsx)("div",{className:"flex flex-row items-center justify-start gap-4 flex-initial",style:{padding:1},children:(0,t.jsx)("div",{className:"flex flex-col items-start justify-start flex-initial",children:(0,t.jsx)("p",{className:"text-copy-14 text-inherit",children:"This will complete the rolling release for this deployment."})})})}):null,ea?(0,t.jsx)(u.Note,{className:" border border-[#fde68a] bg-[#fffbeb] text-[#bd5200] dark:border-[#411d06] dark:bg-[#241005] dark:text-[#fde68a] ",fill:!0,size:"small",style:{marginTop:24},type:"warning",variant:"contrast",children:(0,t.jsx)("div",{className:"flex flex-row items-center justify-start gap-4 flex-initial",style:{padding:1},children:(0,t.jsx)("div",{className:"flex flex-col items-start justify-start flex-initial",children:(0,t.jsx)("p",{className:"text-copy-14 text-inherit",children:X?"Completing the Rolling Release will undo the current Instant Rollback":"This action will undo the current Instant Rollback"})})})}):null,er?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"text-copy-14",style:{marginBottom:16,marginTop:24},children:"Rollback Details:"}),(0,t.jsx)(D.RollbackDescriptionCard,{rollbackDescription:er,project:N})]}):null]})},[en,el,ee,N,x,Y,h,C,A,ea,er,Z,X,Q,J]),es=(0,i.useMemo)(()=>(0,t.jsx)(c.Modal.Action,{"data-testid":(0,y.tid)("deployments","promote-to-production-overlay","confirm-button"),loading:_,onClick:W,children:h&&"target"in h&&"production"===h.target?"Promote":"Promote to Production"}),[W,_,h]);return{modal:(0,i.useMemo)(()=>(0,t.jsxs)(c.Modal.Modal,{active:d,"data-testid":(0,y.tid)("deployments","promote-to-production-overlay"),onAnimationDone:ei,onClickOutside:T,sticky:!0,width:"500px",children:[(0,t.jsxs)(c.Modal.Body,{children:[(0,t.jsx)(E,{title:Q?"Queue for Promotion":h&&"target"in h&&"production"!==h.target?"Promote to Production":"Promote"}),eo,z?(0,t.jsx)(o.Error,{error:z}):null]}),(0,t.jsxs)(c.Modal.Actions,{children:[(0,t.jsx)(c.Modal.Action,{"data-testid":(0,y.tid)("deployments","promote-to-production-overlay","cancel-button"),loading:!1,onClick:T,type:"secondary",children:"Cancel"}),es]})]}),[d,ei,T,eo,z,es,Q,h]),close:T,open:et}},"usePromoteDeployment",0,B,"usePromoteTooltip",0,function(e){let t=e?.name,{deployment:r,isLoading:a}=(0,S.useProjectProductionDeployment)(t);return(0,i.useMemo)(()=>{let t=C(e);return t?a?"Loading…":t.uid===r?.id?"This Deployment is already in Production.":"readyState"in t&&"READY"!==t.readyState?"Only Deployments that are Ready can be promoted.":"prebuilt"in t&&!0===t.prebuilt&&"production"!==t.target?"Prebuilt deployments from non-production environments cannot be promoted.":"":""},[e,a,r?.id])}],6619197)}]);

//# debugId=8e3791fb-d450-2fd2-0329-3a23da98b65c
//# sourceMappingURL=b3b51f4922c1cadd.js.map